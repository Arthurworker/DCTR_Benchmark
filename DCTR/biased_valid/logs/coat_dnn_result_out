nohup: ignoring input
2024-07-04 09:21:17.622510: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2024-07-04 09:21:20.639865: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-07-04 09:21:20.639989: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-07-04 09:21:20.640642: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:20:00.0 name: Tesla V100-SXM2-32GB computeCapability: 7.0
coreClock: 1.53GHz coreCount: 80 deviceMemorySize: 31.74GiB deviceMemoryBandwidth: 836.37GiB/s
2024-07-04 09:21:20.640677: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2024-07-04 09:21:20.640729: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2024-07-04 09:21:20.640754: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2024-07-04 09:21:20.674183: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-07-04 09:21:20.674615: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-07-04 09:21:20.674756: W tensorflow/stream_executor/platform/default/dso_loader.cc:60] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /lib/x86_64-linux-gnu:/usr/lib/x86_64-linux-gnu::/usr/local/cuda-11.7/lib64
2024-07-04 09:21:20.675650: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2024-07-04 09:21:20.675714: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2024-07-04 09:21:20.675724: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1757] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2024-07-04 09:21:20.676068: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX512F
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-07-04 09:21:20.682565: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-07-04 09:21:20.682665: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-07-04 09:21:20.682705: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      
2024-07-04 09:21:20.770769: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-07-04 09:21:20.791785: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2500000000 Hz
{'model_opt': {'latent_dim': 16, 'feat_num': 647, 'field_num': 10, 'mlp_dropout': 0.0, 'use_bn': False, 'mlp_dims': [1024, 512, 256], 'cross': 3}, 'dataset': 'coat', 'model': 'TJR-CTR', 'data_dir': 'data/coat/tfrecord2', 'cuda': 3, 'source': None}
==================================================
|          TJR-CTR: Set the random seed          |
==================================================

==================================================
|               TJR-CTR: Training                |
==================================================

######### trainer ###########
alpha1 0.007163326157431137 alpha2 1.0 lr: 1e-05 l2: 3e-05 bs: 32
  0%|          | 0/5000 [00:00<?, ?it/s]  0%|          | 1/5000 [00:02<4:09:09,  2.99s/it]  0%|          | 2/5000 [00:05<3:33:42,  2.57s/it]  0%|          | 3/5000 [00:07<3:21:51,  2.42s/it]  0%|          | 4/5000 [00:09<3:16:44,  2.36s/it]  0%|          | 5/5000 [00:12<3:13:37,  2.33s/it]  0%|          | 6/5000 [00:14<3:11:58,  2.31s/it]  0%|          | 7/5000 [00:16<3:10:33,  2.29s/it]  0%|          | 8/5000 [00:18<3:10:14,  2.29s/it]  0%|          | 9/5000 [00:21<3:11:02,  2.30s/it]  0%|          | 10/5000 [00:23<3:09:55,  2.28s/it]  0%|          | 11/5000 [00:25<3:09:50,  2.28s/it]  0%|          | 12/5000 [00:27<3:07:12,  2.25s/it]  0%|          | 13/5000 [00:30<3:07:06,  2.25s/it]  0%|          | 14/5000 [00:32<3:06:13,  2.24s/it]  0%|          | 15/5000 [00:34<3:06:21,  2.24s/it]  0%|          | 16/5000 [00:36<3:06:31,  2.25s/it]  0%|          | 17/5000 [00:39<3:06:47,  2.25s/it]  0%|          | 18/5000 [00:41<3:07:33,  2.26s/it]  0%|          | 19/5000 [00:43<3:09:00,  2.28s/it]  0%|          | 20/5000 [00:45<3:08:04,  2.27s/it]  0%|          | 21/5000 [00:48<3:07:51,  2.26s/it]  0%|          | 22/5000 [00:50<3:07:48,  2.26s/it]  0%|          | 23/5000 [00:52<3:06:18,  2.25s/it]  0%|          | 24/5000 [00:54<3:04:13,  2.22s/it]  0%|          | 25/5000 [00:57<3:05:11,  2.23s/it]  1%|          | 26/5000 [00:59<3:05:52,  2.24s/it]  1%|          | 27/5000 [01:01<3:06:00,  2.24s/it]  1%|          | 28/5000 [01:03<3:06:19,  2.25s/it]  1%|          | 29/5000 [01:06<3:06:40,  2.25s/it]  1%|          | 30/5000 [01:08<3:06:46,  2.25s/it]  1%|          | 31/5000 [01:10<3:06:56,  2.26s/it]  1%|          | 32/5000 [01:12<3:06:17,  2.25s/it]  1%|          | 33/5000 [01:15<3:16:18,  2.37s/it]  1%|          | 34/5000 [01:18<3:23:34,  2.46s/it]  1%|          | 35/5000 [01:20<3:20:10,  2.42s/it]  1%|          | 36/5000 [01:22<3:15:46,  2.37s/it]  1%|          | 37/5000 [01:25<3:13:13,  2.34s/it]  1%|          | 38/5000 [01:27<3:11:09,  2.31s/it]  1%|          | 39/5000 [01:29<3:09:46,  2.30s/it]  1%|          | 40/5000 [01:31<3:09:07,  2.29s/it]  1%|          | 41/5000 [01:34<3:08:23,  2.28s/it]  1%|          | 42/5000 [01:36<3:08:01,  2.28s/it]  1%|          | 43/5000 [01:38<3:08:09,  2.28s/it]  1%|          | 44/5000 [01:40<3:09:35,  2.30s/it]  1%|          | 45/5000 [01:43<3:07:15,  2.27s/it]  1%|          | 46/5000 [01:45<2:59:21,  2.17s/it]  1%|          | 47/5000 [01:46<2:46:06,  2.01s/it]  1%|          | 48/5000 [01:48<2:44:10,  1.99s/it]  1%|          | 49/5000 [01:50<2:44:15,  1.99s/it]  1%|          | 50/5000 [01:52<2:43:54,  1.99s/it]  1%|          | 51/5000 [01:54<2:47:38,  2.03s/it]  1%|          | 52/5000 [01:57<2:53:09,  2.10s/it]  1%|          | 53/5000 [01:59<2:56:41,  2.14s/it]  1%|          | 54/5000 [02:01<2:59:31,  2.18s/it]  1%|          | 55/5000 [02:03<3:00:56,  2.20s/it]  1%|          | 56/5000 [02:05<3:00:14,  2.19s/it]  1%|          | 57/5000 [02:08<3:01:40,  2.21s/it]  1%|          | 58/5000 [02:10<3:02:09,  2.21s/it]  1%|          | 59/5000 [02:12<3:02:32,  2.22s/it]  1%|          | 60/5000 [02:14<3:02:25,  2.22s/it]  1%|          | 61/5000 [02:17<3:02:00,  2.21s/it]  1%|          | 62/5000 [02:19<3:03:22,  2.23s/it]  1%|▏         | 63/5000 [02:21<3:04:00,  2.24s/it]  1%|▏         | 64/5000 [02:23<3:04:35,  2.24s/it]  1%|▏         | 65/5000 [02:26<3:06:17,  2.27s/it]  1%|▏         | 66/5000 [02:28<3:04:37,  2.25s/it]  1%|▏         | 67/5000 [02:30<3:06:33,  2.27s/it]  1%|▏         | 68/5000 [02:32<3:03:35,  2.23s/it]  1%|▏         | 69/5000 [02:35<3:02:57,  2.23s/it]  1%|▏         | 70/5000 [02:37<3:03:48,  2.24s/it]  1%|▏         | 71/5000 [02:39<3:04:47,  2.25s/it]  1%|▏         | 72/5000 [02:41<3:05:11,  2.25s/it]  1%|▏         | 73/5000 [02:44<3:05:38,  2.26s/it]  1%|▏         | 74/5000 [02:46<3:05:19,  2.26s/it]  2%|▏         | 75/5000 [02:48<3:05:37,  2.26s/it]  2%|▏         | 76/5000 [02:50<3:05:36,  2.26s/it]  2%|▏         | 77/5000 [02:53<3:05:34,  2.26s/it]  2%|▏         | 78/5000 [02:55<3:06:40,  2.28s/it]  2%|▏         | 79/5000 [02:57<3:07:43,  2.29s/it]  2%|▏         | 80/5000 [03:00<3:06:56,  2.28s/it]  2%|▏         | 81/5000 [03:02<3:05:22,  2.26s/it]  2%|▏         | 82/5000 [03:04<3:09:14,  2.31s/it]  2%|▏         | 83/5000 [03:06<3:06:46,  2.28s/it]  2%|▏         | 84/5000 [03:09<3:04:33,  2.25s/it]  2%|▏         | 85/5000 [03:11<3:04:39,  2.25s/it]  2%|▏         | 86/5000 [03:13<3:05:30,  2.27s/it]  2%|▏         | 87/5000 [03:15<3:02:49,  2.23s/it]  2%|▏         | 88/5000 [03:18<3:03:17,  2.24s/it]  2%|▏         | 89/5000 [03:20<3:03:11,  2.24s/it]  2%|▏         | 90/5000 [03:22<3:04:03,  2.25s/it]  2%|▏         | 91/5000 [03:24<2:55:52,  2.15s/it]  2%|▏         | 92/5000 [03:25<2:39:27,  1.95s/it]  2%|▏         | 93/5000 [03:28<2:44:54,  2.02s/it]  2%|▏         | 94/5000 [03:29<2:38:54,  1.94s/it]  2%|▏         | 95/5000 [03:31<2:27:55,  1.81s/it]  2%|▏         | 96/5000 [03:32<2:20:20,  1.72s/it]  2%|▏         | 97/5000 [03:34<2:22:00,  1.74s/it]  2%|▏         | 98/5000 [03:36<2:25:57,  1.79s/it]  2%|▏         | 99/5000 [03:38<2:18:22,  1.69s/it]  2%|▏         | 100/5000 [03:39<2:12:46,  1.63s/it]  2%|▏         | 101/5000 [03:41<2:10:02,  1.59s/it]  2%|▏         | 102/5000 [03:42<2:07:40,  1.56s/it]  2%|▏         | 102/5000 [03:44<2:59:20,  2.20s/it]
AUC:  0.7590004592515943 LOGlOSS:  0.5223841972053619 test_AUC:  0.7531119834073261 test_LOGlOSS:  0.445704829054533
Time:  226.64376911899308
{'model_opt': {'latent_dim': 16, 'feat_num': 647, 'field_num': 10, 'mlp_dropout': 0.0, 'use_bn': False, 'mlp_dims': [1024, 512, 256], 'cross': 3}, 'dataset': 'coat', 'model': 'Bridge-CTR', 'data_dir': 'data/coat/tfrecord2', 'cuda': 3, 'source': None}
==================================================
|        Bridge-CTR: Set the random seed         |
==================================================

==================================================
|              Bridge-CTR: Training              |
==================================================

######### trainer ###########
alpha1 1 lr: 0.0001 l2: 0.001 bs: 64
  0%|          | 0/5000 [00:00<?, ?it/s]  0%|          | 1/5000 [00:00<1:22:35,  1.01it/s]  0%|          | 2/5000 [00:01<1:22:38,  1.01it/s]  0%|          | 3/5000 [00:02<1:22:10,  1.01it/s]  0%|          | 4/5000 [00:03<1:21:35,  1.02it/s]  0%|          | 5/5000 [00:04<1:21:36,  1.02it/s]  0%|          | 5/5000 [00:05<1:37:56,  1.18s/it]
AUC:  0.7549689278509932 LOGlOSS:  0.5002823881778785 test_AUC:  0.7567417260418512 test_LOGlOSS:  0.42013628774377076
Time:  6.357749386981595
{'model_opt': {'latent_dim': 16, 'feat_num': 647, 'field_num': 10, 'mlp_dropout': 0.0, 'use_bn': True, 'mlp_dims': [1024, 512, 256], 'cross': 3}, 'dataset': 'coat', 'model': 'CausE-CTR', 'data_dir': 'data/coat/tfrecord2', 'cuda': 3, 'source': None}
==================================================
|         CausE-CTR: Set the random seed         |
==================================================

==================================================
|              CausE-CTR: Training               |
==================================================

######### trainer ###########
alpha1 0.01 lr: 0.0001 l2: 0.0001 bs: 64
  0%|          | 0/5000 [00:00<?, ?it/s]  0%|          | 1/5000 [00:00<39:42,  2.10it/s]  0%|          | 2/5000 [00:00<40:39,  2.05it/s]  0%|          | 3/5000 [00:01<40:38,  2.05it/s]  0%|          | 4/5000 [00:01<40:09,  2.07it/s]  0%|          | 5/5000 [00:02<39:36,  2.10it/s]  0%|          | 6/5000 [00:02<40:07,  2.07it/s]  0%|          | 7/5000 [00:03<40:09,  2.07it/s]  0%|          | 8/5000 [00:03<40:08,  2.07it/s]  0%|          | 9/5000 [00:04<40:13,  2.07it/s]  0%|          | 10/5000 [00:04<40:23,  2.06it/s]  0%|          | 11/5000 [00:05<40:38,  2.05it/s]  0%|          | 12/5000 [00:05<40:37,  2.05it/s]  0%|          | 13/5000 [00:06<40:44,  2.04it/s]  0%|          | 14/5000 [00:06<40:10,  2.07it/s]  0%|          | 15/5000 [00:07<39:51,  2.08it/s]  0%|          | 16/5000 [00:07<39:37,  2.10it/s]  0%|          | 17/5000 [00:08<40:27,  2.05it/s]  0%|          | 18/5000 [00:08<40:50,  2.03it/s]  0%|          | 19/5000 [00:09<40:08,  2.07it/s]  0%|          | 20/5000 [00:09<39:38,  2.09it/s]  0%|          | 21/5000 [00:10<39:01,  2.13it/s]  0%|          | 22/5000 [00:10<39:53,  2.08it/s]  0%|          | 23/5000 [00:11<41:42,  1.99it/s]  0%|          | 24/5000 [00:11<43:30,  1.91it/s]  0%|          | 25/5000 [00:12<44:17,  1.87it/s]  1%|          | 26/5000 [00:12<45:02,  1.84it/s]  1%|          | 27/5000 [00:13<45:33,  1.82it/s]  1%|          | 28/5000 [00:13<45:47,  1.81it/s]  1%|          | 28/5000 [00:14<43:05,  1.92it/s]
AUC:  0.7661246722745744 LOGlOSS:  0.5405372265982831 test_AUC:  0.7562202528897193 test_LOGlOSS:  0.45967863630988126
Time:  15.05334847199265
{'model_opt': {'latent_dim': 16, 'feat_num': 647, 'field_num': 10, 'mlp_dropout': 0.0, 'use_bn': True, 'mlp_dims': [1024, 512, 256], 'cross': 3}, 'dataset': 'coat', 'model': 'DR-CTR', 'data_dir': 'data/coat/tfrecord2', 'cuda': 3, 'source': None}
==================================================
|          DR-CTR: Set the random seed           |
==================================================

==================================================
|            DR-CTR: Estimate pscore             |
==================================================

==================================================
|                DR-CTR: Training                |
==================================================

######### trainer ###########
beta1 0.10623867890558175 lr: 0.001 l2: 0.001 bs: 64
  0%|          | 0/5000 [00:00<?, ?it/s]  0%|          | 1/5000 [00:01<1:51:59,  1.34s/it]  0%|          | 2/5000 [00:02<1:52:43,  1.35s/it]  0%|          | 3/5000 [00:04<1:52:21,  1.35s/it]  0%|          | 4/5000 [00:05<1:49:37,  1.32s/it]  0%|          | 5/5000 [00:06<1:48:07,  1.30s/it]  0%|          | 6/5000 [00:07<1:48:50,  1.31s/it]  0%|          | 7/5000 [00:09<1:48:14,  1.30s/it]  0%|          | 8/5000 [00:10<1:47:54,  1.30s/it]  0%|          | 9/5000 [00:11<1:47:51,  1.30s/it]  0%|          | 10/5000 [00:13<1:47:48,  1.30s/it]  0%|          | 11/5000 [00:14<1:47:36,  1.29s/it]  0%|          | 12/5000 [00:15<1:47:28,  1.29s/it]  0%|          | 13/5000 [00:16<1:48:05,  1.30s/it]  0%|          | 14/5000 [00:18<1:47:29,  1.29s/it]  0%|          | 15/5000 [00:19<1:47:13,  1.29s/it]  0%|          | 16/5000 [00:20<1:47:20,  1.29s/it]  0%|          | 17/5000 [00:22<1:47:15,  1.29s/it]  0%|          | 17/5000 [00:23<1:54:21,  1.38s/it]
AUC:  0.7588987263034898 LOGlOSS:  0.6095675804334576 test_AUC:  0.7449984858613734 test_LOGlOSS:  0.5230550610707709
Time:  23.871588281006552
{'model_opt': {'latent_dim': 16, 'feat_num': 647, 'field_num': 10, 'mlp_dropout': 0.0, 'use_bn': False, 'mlp_dims': [1024, 512, 256], 'cross': 3}, 'dataset': 'coat', 'model': 'DRJL-CTR', 'data_dir': 'data/coat/tfrecord2', 'cuda': 3, 'source': None}
==================================================
|         DRJL-CTR: Set the random seed          |
==================================================

==================================================
|           DRJL-CTR: Estimate pscore            |
==================================================

==================================================
|               DRJL-CTR: Training               |
==================================================

######### trainer ###########
beta1 0.8601729832112232 lr: 0.001 l2: 1e-05 bs: 16
  0%|          | 0/5000 [00:00<?, ?it/s]  0%|          | 1/5000 [00:06<9:04:11,  6.53s/it]  0%|          | 2/5000 [00:13<9:02:46,  6.52s/it]  0%|          | 3/5000 [00:19<8:59:49,  6.48s/it]  0%|          | 4/5000 [00:25<9:00:30,  6.49s/it]  0%|          | 5/5000 [00:32<9:00:06,  6.49s/it]  0%|          | 6/5000 [00:38<8:59:14,  6.48s/it]  0%|          | 6/5000 [00:45<10:27:58,  7.54s/it]
AUC:  0.7351920427394648 LOGlOSS:  0.531346016346069 test_AUC:  0.733138685575306 test_LOGlOSS:  0.4435417152631217
Time:  45.73914698604494
{'model_opt': {'latent_dim': 16, 'feat_num': 647, 'field_num': 10, 'mlp_dropout': 0.0, 'use_bn': False, 'mlp_dims': [1024, 512, 256], 'cross': 3}, 'dataset': 'coat', 'model': 'IDIPS-CTR', 'data_dir': 'data/coat/tfrecord2', 'cuda': 3, 'source': None}
==================================================
|         IDIPS-CTR: Set the random seed         |
==================================================

==================================================
|           IDIPS-CTR: Estimate pscore           |
==================================================

==================================================
|              IDIPS-CTR: Training               |
==================================================

######### trainer ###########
beta1 0.1061495597519092 lr: 0.001 l2: 1e-05 bs: 32
  0%|          | 0/5000 [00:00<?, ?it/s]  0%|          | 1/5000 [00:00<1:11:12,  1.17it/s]  0%|          | 2/5000 [00:01<1:11:21,  1.17it/s]  0%|          | 3/5000 [00:02<1:11:40,  1.16it/s]  0%|          | 4/5000 [00:03<1:11:52,  1.16it/s]  0%|          | 5/5000 [00:04<1:11:32,  1.16it/s]  0%|          | 6/5000 [00:05<1:10:35,  1.18it/s]  0%|          | 7/5000 [00:05<1:10:28,  1.18it/s]  0%|          | 8/5000 [00:06<1:10:23,  1.18it/s]  0%|          | 9/5000 [00:07<1:10:15,  1.18it/s]  0%|          | 9/5000 [00:08<1:18:35,  1.06it/s]
AUC:  0.7487196181817124 LOGlOSS:  0.5439645772624538 test_AUC:  0.7463625438290757 test_LOGlOSS:  0.45871509042502007
Time:  8.962403687997721
{'model_opt': {'latent_dim': 16, 'feat_num': 647, 'field_num': 10, 'mlp_dropout': 0.0, 'use_bn': False, 'mlp_dims': [1024, 512, 256], 'cross': 3}, 'dataset': 'coat', 'model': 'IPS-CTR', 'data_dir': 'data/coat/tfrecord2', 'cuda': 3, 'source': None}
==================================================
|          IPS-CTR: Set the random seed          |
==================================================

==================================================
|            IPS-CTR: Estimate pscore            |
==================================================

==================================================
|               IPS-CTR: Training                |
==================================================

######### trainer ###########
lr: 0.0001 l2: 0.001 bs: 64
  0%|          | 0/5000 [00:00<?, ?it/s]  0%|          | 1/5000 [00:00<37:01,  2.25it/s]  0%|          | 2/5000 [00:00<36:35,  2.28it/s]  0%|          | 3/5000 [00:01<36:34,  2.28it/s]  0%|          | 4/5000 [00:01<36:25,  2.29it/s]  0%|          | 5/5000 [00:02<36:13,  2.30it/s]  0%|          | 6/5000 [00:02<36:32,  2.28it/s]  0%|          | 7/5000 [00:03<36:35,  2.27it/s]  0%|          | 8/5000 [00:03<36:20,  2.29it/s]  0%|          | 9/5000 [00:03<36:21,  2.29it/s]  0%|          | 10/5000 [00:04<36:08,  2.30it/s]  0%|          | 11/5000 [00:04<36:18,  2.29it/s]  0%|          | 12/5000 [00:05<36:25,  2.28it/s]  0%|          | 13/5000 [00:05<36:29,  2.28it/s]  0%|          | 14/5000 [00:06<36:29,  2.28it/s]  0%|          | 15/5000 [00:06<36:01,  2.31it/s]  0%|          | 16/5000 [00:06<36:03,  2.30it/s]  0%|          | 17/5000 [00:07<35:50,  2.32it/s]  0%|          | 18/5000 [00:07<35:46,  2.32it/s]  0%|          | 19/5000 [00:08<36:06,  2.30it/s]  0%|          | 20/5000 [00:08<35:09,  2.36it/s]  0%|          | 21/5000 [00:09<35:11,  2.36it/s]  0%|          | 22/5000 [00:09<35:13,  2.35it/s]  0%|          | 23/5000 [00:09<35:15,  2.35it/s]  0%|          | 23/5000 [00:10<37:27,  2.21it/s]
AUC:  0.7476819421110459 LOGlOSS:  0.5438111446249636 test_AUC:  0.755927328964234 test_LOGlOSS:  0.43911392713206254
Time:  10.860071198025253
{'model_opt': {'latent_dim': 16, 'feat_num': 647, 'field_num': 10, 'mlp_dropout': 0.0, 'use_bn': False, 'mlp_dims': [1024, 512, 256], 'cross': 3}, 'dataset': 'coat', 'model': 'Refine-CTR', 'data_dir': 'data/coat/tfrecord2', 'cuda': 3, 'source': None}
==================================================
|        Refine-CTR: Set the random seed         |
==================================================

==================================================
|              Refine-CTR: Training              |
==================================================

######### trainer ###########
beta1 0.23072656343911285 lr: 0.001 l2: 0.0003 bs: 64
  0%|          | 0/5000 [00:00<?, ?it/s]  0%|          | 1/5000 [00:00<1:10:29,  1.18it/s]  0%|          | 2/5000 [00:01<1:14:09,  1.12it/s]  0%|          | 3/5000 [00:02<1:14:30,  1.12it/s]  0%|          | 4/5000 [00:03<1:14:46,  1.11it/s]  0%|          | 5/5000 [00:04<1:15:09,  1.11it/s]  0%|          | 5/5000 [00:05<1:29:37,  1.08s/it]
AUC:  0.7572884390677774 LOGlOSS:  0.7643216535944743 test_AUC:  0.7563333847569094 test_LOGlOSS:  0.7841905569998235
Time:  5.881964799948037
{'model_opt': {'latent_dim': 16, 'feat_num': 647, 'field_num': 10, 'mlp_dropout': 0.0, 'use_bn': True, 'mlp_dims': [1024, 512, 256], 'cross': 3}, 'dataset': 'coat', 'model': 'UDIPS-CTR', 'data_dir': 'data/coat/tfrecord2', 'cuda': 3, 'source': None}
==================================================
|         UDIPS-CTR: Set the random seed         |
==================================================

==================================================
|           UDIPS-CTR: Estimate pscore           |
==================================================

==================================================
|              UDIPS-CTR: Training               |
==================================================

######### trainer ###########
beta1 0.26899451582186346 lr: 3e-05 l2: 0.0003 bs: 32
  0%|          | 0/5000 [00:00<?, ?it/s]  0%|          | 1/5000 [00:00<1:12:21,  1.15it/s]  0%|          | 2/5000 [00:01<1:12:10,  1.15it/s]  0%|          | 3/5000 [00:02<1:12:07,  1.15it/s]  0%|          | 4/5000 [00:03<1:12:09,  1.15it/s]  0%|          | 5/5000 [00:04<1:11:43,  1.16it/s]  0%|          | 6/5000 [00:05<1:11:24,  1.17it/s]  0%|          | 7/5000 [00:06<1:11:25,  1.17it/s]  0%|          | 8/5000 [00:06<1:11:32,  1.16it/s]  0%|          | 9/5000 [00:07<1:11:20,  1.17it/s]  0%|          | 10/5000 [00:08<1:11:37,  1.16it/s]  0%|          | 11/5000 [00:09<1:11:43,  1.16it/s]  0%|          | 12/5000 [00:10<1:10:52,  1.17it/s]  0%|          | 13/5000 [00:11<1:08:29,  1.21it/s]  0%|          | 14/5000 [00:11<1:07:14,  1.24it/s]  0%|          | 15/5000 [00:12<1:06:11,  1.26it/s]  0%|          | 16/5000 [00:13<1:05:22,  1.27it/s]  0%|          | 17/5000 [00:14<1:05:18,  1.27it/s]  0%|          | 18/5000 [00:14<1:05:26,  1.27it/s]  0%|          | 19/5000 [00:15<1:09:42,  1.19it/s]  0%|          | 20/5000 [00:16<1:10:02,  1.18it/s]  0%|          | 21/5000 [00:17<1:10:13,  1.18it/s]  0%|          | 22/5000 [00:18<1:10:28,  1.18it/s]  0%|          | 23/5000 [00:19<1:10:12,  1.18it/s]  0%|          | 24/5000 [00:20<1:10:08,  1.18it/s]  0%|          | 25/5000 [00:21<1:10:21,  1.18it/s]  1%|          | 26/5000 [00:21<1:10:34,  1.17it/s]  1%|          | 27/5000 [00:22<1:10:45,  1.17it/s]  1%|          | 28/5000 [00:23<1:10:29,  1.18it/s]  1%|          | 29/5000 [00:24<1:10:35,  1.17it/s]  1%|          | 30/5000 [00:25<1:10:24,  1.18it/s]  1%|          | 31/5000 [00:26<1:10:39,  1.17it/s]  1%|          | 32/5000 [00:26<1:10:35,  1.17it/s]  1%|          | 33/5000 [00:27<1:10:57,  1.17it/s]  1%|          | 34/5000 [00:28<1:10:25,  1.18it/s]  1%|          | 35/5000 [00:29<1:10:19,  1.18it/s]  1%|          | 36/5000 [00:30<1:10:11,  1.18it/s]  1%|          | 37/5000 [00:31<1:10:33,  1.17it/s]  1%|          | 38/5000 [00:32<1:10:28,  1.17it/s]  1%|          | 39/5000 [00:32<1:10:35,  1.17it/s]  1%|          | 40/5000 [00:33<1:10:20,  1.18it/s]  1%|          | 41/5000 [00:34<1:10:28,  1.17it/s]  1%|          | 42/5000 [00:35<1:10:19,  1.18it/s]  1%|          | 43/5000 [00:36<1:10:50,  1.17it/s]  1%|          | 44/5000 [00:37<1:10:55,  1.16it/s]  1%|          | 45/5000 [00:38<1:10:57,  1.16it/s]  1%|          | 46/5000 [00:38<1:10:45,  1.17it/s]  1%|          | 47/5000 [00:39<1:10:16,  1.17it/s]  1%|          | 48/5000 [00:40<1:10:03,  1.18it/s]  1%|          | 49/5000 [00:41<1:09:40,  1.18it/s]  1%|          | 50/5000 [00:42<1:09:43,  1.18it/s]  1%|          | 50/5000 [00:43<1:11:11,  1.16it/s]
AUC:  0.7526552299455294  LOGlOSS:  0.5430353150938181 test_AUC:  0.7549746596044955 test_LOGlOSS:  0.4584736711999157
Time:  43.62333384301746
{'model_opt': {'latent_dim': 16, 'feat_num': 647, 'field_num': 10, 'mlp_dropout': 0.0, 'use_bn': False, 'mlp_dims': [1024, 512, 256], 'cross': 3}, 'dataset': 'coat', 'model': 'bias_BASE-CTR', 'data_dir': 'data/coat/tfrecord2', 'cuda': 3, 'source': 'bias'}
==================================================
|         BASE-CTR: Set the random seed          |
==================================================

==================================================
|               BASE-CTR: Training               |
==================================================

######### trainer ###########
lr: 3e-05 l2: 0.0003 bs: 64
  0%|          | 0/5000 [00:00<?, ?it/s]  0%|          | 1/5000 [00:00<33:52,  2.46it/s]  0%|          | 2/5000 [00:00<34:13,  2.43it/s]  0%|          | 3/5000 [00:01<34:34,  2.41it/s]  0%|          | 4/5000 [00:01<34:38,  2.40it/s]  0%|          | 5/5000 [00:02<34:31,  2.41it/s]  0%|          | 6/5000 [00:02<34:32,  2.41it/s]  0%|          | 7/5000 [00:02<34:39,  2.40it/s]  0%|          | 8/5000 [00:03<34:27,  2.41it/s]  0%|          | 9/5000 [00:03<34:15,  2.43it/s]  0%|          | 10/5000 [00:04<34:08,  2.44it/s]  0%|          | 11/5000 [00:04<33:56,  2.45it/s]  0%|          | 12/5000 [00:04<33:49,  2.46it/s]  0%|          | 13/5000 [00:05<33:48,  2.46it/s]  0%|          | 14/5000 [00:05<33:36,  2.47it/s]  0%|          | 15/5000 [00:06<33:22,  2.49it/s]  0%|          | 16/5000 [00:06<33:30,  2.48it/s]  0%|          | 17/5000 [00:06<33:23,  2.49it/s]  0%|          | 18/5000 [00:07<33:39,  2.47it/s]  0%|          | 19/5000 [00:07<33:45,  2.46it/s]  0%|          | 20/5000 [00:08<33:43,  2.46it/s]  0%|          | 21/5000 [00:08<33:55,  2.45it/s]  0%|          | 22/5000 [00:08<33:59,  2.44it/s]  0%|          | 23/5000 [00:09<33:54,  2.45it/s]  0%|          | 24/5000 [00:09<34:03,  2.44it/s]  0%|          | 25/5000 [00:10<34:01,  2.44it/s]  1%|          | 26/5000 [00:10<34:13,  2.42it/s]  1%|          | 27/5000 [00:11<34:18,  2.42it/s]  1%|          | 28/5000 [00:11<34:18,  2.42it/s]  1%|          | 29/5000 [00:11<34:11,  2.42it/s]  1%|          | 30/5000 [00:12<34:08,  2.43it/s]  1%|          | 31/5000 [00:12<33:59,  2.44it/s]  1%|          | 32/5000 [00:13<33:59,  2.44it/s]  1%|          | 33/5000 [00:13<33:47,  2.45it/s]  1%|          | 34/5000 [00:13<33:39,  2.46it/s]  1%|          | 35/5000 [00:14<33:49,  2.45it/s]  1%|          | 36/5000 [00:14<33:59,  2.43it/s]  1%|          | 37/5000 [00:15<34:01,  2.43it/s]  1%|          | 38/5000 [00:15<33:51,  2.44it/s]  1%|          | 39/5000 [00:15<33:32,  2.47it/s]  1%|          | 40/5000 [00:16<33:23,  2.48it/s]  1%|          | 41/5000 [00:16<33:31,  2.47it/s]  1%|          | 42/5000 [00:17<33:44,  2.45it/s]  1%|          | 43/5000 [00:17<33:48,  2.44it/s]  1%|          | 44/5000 [00:18<34:01,  2.43it/s]  1%|          | 45/5000 [00:18<33:42,  2.45it/s]  1%|          | 46/5000 [00:18<33:35,  2.46it/s]  1%|          | 47/5000 [00:19<33:48,  2.44it/s]  1%|          | 48/5000 [00:19<33:39,  2.45it/s]  1%|          | 49/5000 [00:20<33:36,  2.46it/s]  1%|          | 50/5000 [00:20<33:36,  2.46it/s]  1%|          | 51/5000 [00:20<33:38,  2.45it/s]  1%|          | 52/5000 [00:21<33:07,  2.49it/s]  1%|          | 53/5000 [00:21<33:23,  2.47it/s]  1%|          | 54/5000 [00:22<33:11,  2.48it/s]  1%|          | 55/5000 [00:22<33:11,  2.48it/s]  1%|          | 56/5000 [00:22<33:21,  2.47it/s]  1%|          | 57/5000 [00:23<33:09,  2.48it/s]  1%|          | 58/5000 [00:23<33:03,  2.49it/s]  1%|          | 59/5000 [00:24<33:11,  2.48it/s]  1%|          | 60/5000 [00:24<32:54,  2.50it/s]  1%|          | 61/5000 [00:24<33:00,  2.49it/s]  1%|          | 62/5000 [00:25<33:12,  2.48it/s]  1%|▏         | 63/5000 [00:25<33:11,  2.48it/s]  1%|▏         | 64/5000 [00:26<33:32,  2.45it/s]  1%|▏         | 65/5000 [00:26<33:42,  2.44it/s]  1%|▏         | 66/5000 [00:26<33:39,  2.44it/s]  1%|▏         | 67/5000 [00:27<33:41,  2.44it/s]  1%|▏         | 68/5000 [00:27<33:04,  2.48it/s]  1%|▏         | 69/5000 [00:28<32:42,  2.51it/s]  1%|▏         | 70/5000 [00:28<32:57,  2.49it/s]  1%|▏         | 71/5000 [00:28<32:55,  2.50it/s]  1%|▏         | 71/5000 [00:29<33:55,  2.42it/s]
AUC:  0.747083171045059 LOGlOSS:  0.5420717977680932 test_AUC:  0.7558404802581082 test_LOGlOSS:  0.44712183845672065
Time:  29.783170757000335
{'model_opt': {'latent_dim': 16, 'feat_num': 647, 'field_num': 10, 'mlp_dropout': 0.0, 'use_bn': False, 'mlp_dims': [1024, 512, 256], 'cross': 3}, 'dataset': 'coat', 'model': 'combine_BASE-CTR', 'data_dir': 'data/coat/tfrecord2', 'cuda': 3, 'source': 'combine'}
==================================================
|         BASE-CTR: Set the random seed          |
==================================================

==================================================
|               BASE-CTR: Training               |
==================================================

######### trainer ###########
lr: 3e-05 l2: 3e-05 bs: 64
  0%|          | 0/5000 [00:00<?, ?it/s]  0%|          | 1/5000 [00:00<35:56,  2.32it/s]  0%|          | 2/5000 [00:00<36:09,  2.30it/s]  0%|          | 3/5000 [00:01<36:06,  2.31it/s]  0%|          | 4/5000 [00:01<36:06,  2.31it/s]  0%|          | 5/5000 [00:02<36:18,  2.29it/s]  0%|          | 6/5000 [00:02<36:08,  2.30it/s]  0%|          | 7/5000 [00:03<35:49,  2.32it/s]  0%|          | 8/5000 [00:03<35:57,  2.31it/s]  0%|          | 9/5000 [00:03<36:01,  2.31it/s]  0%|          | 10/5000 [00:04<35:58,  2.31it/s]  0%|          | 11/5000 [00:04<35:52,  2.32it/s]  0%|          | 12/5000 [00:05<35:42,  2.33it/s]  0%|          | 13/5000 [00:05<35:37,  2.33it/s]  0%|          | 14/5000 [00:06<36:06,  2.30it/s]  0%|          | 15/5000 [00:06<36:56,  2.25it/s]  0%|          | 16/5000 [00:06<37:19,  2.23it/s]  0%|          | 17/5000 [00:07<37:31,  2.21it/s]  0%|          | 18/5000 [00:07<37:24,  2.22it/s]  0%|          | 19/5000 [00:08<38:20,  2.17it/s]  0%|          | 20/5000 [00:08<39:03,  2.12it/s]  0%|          | 21/5000 [00:09<38:40,  2.15it/s]  0%|          | 22/5000 [00:09<39:12,  2.12it/s]  0%|          | 23/5000 [00:10<39:08,  2.12it/s]  0%|          | 24/5000 [00:10<38:06,  2.18it/s]  0%|          | 25/5000 [00:11<37:38,  2.20it/s]  1%|          | 26/5000 [00:11<37:28,  2.21it/s]  1%|          | 27/5000 [00:12<37:17,  2.22it/s]  1%|          | 28/5000 [00:12<36:57,  2.24it/s]  1%|          | 29/5000 [00:12<36:42,  2.26it/s]  1%|          | 30/5000 [00:13<36:26,  2.27it/s]  1%|          | 31/5000 [00:13<36:24,  2.27it/s]  1%|          | 32/5000 [00:14<36:22,  2.28it/s]  1%|          | 33/5000 [00:14<36:11,  2.29it/s]  1%|          | 34/5000 [00:15<35:53,  2.31it/s]  1%|          | 35/5000 [00:15<35:48,  2.31it/s]  1%|          | 36/5000 [00:15<35:36,  2.32it/s]  1%|          | 37/5000 [00:16<35:42,  2.32it/s]  1%|          | 38/5000 [00:16<35:49,  2.31it/s]  1%|          | 39/5000 [00:17<35:45,  2.31it/s]  1%|          | 40/5000 [00:17<35:48,  2.31it/s]  1%|          | 41/5000 [00:18<36:12,  2.28it/s]  1%|          | 42/5000 [00:18<36:18,  2.28it/s]  1%|          | 43/5000 [00:19<35:58,  2.30it/s]  1%|          | 44/5000 [00:19<36:14,  2.28it/s]  1%|          | 45/5000 [00:19<36:19,  2.27it/s]  1%|          | 46/5000 [00:20<36:30,  2.26it/s]  1%|          | 47/5000 [00:20<35:49,  2.30it/s]  1%|          | 48/5000 [00:21<35:40,  2.31it/s]  1%|          | 49/5000 [00:21<35:35,  2.32it/s]  1%|          | 50/5000 [00:22<35:11,  2.34it/s]  1%|          | 50/5000 [00:22<37:01,  2.23it/s]
AUC:  0.7557798847801697 LOGlOSS:  0.5297254777900355 test_AUC:  0.7583156683826904 test_LOGlOSS:  0.4434681654757333
Time:  22.984495804994367
{'model_opt': {'latent_dim': 16, 'feat_num': 647, 'field_num': 10, 'mlp_dropout': 0.0, 'use_bn': False, 'mlp_dims': [1024, 512, 256], 'cross': 3}, 'dataset': 'coat', 'model': 'unif_BASE-CTR', 'data_dir': 'data/coat/tfrecord2', 'cuda': 3, 'source': 'unif'}
==================================================
|         BASE-CTR: Set the random seed          |
==================================================

==================================================
|               BASE-CTR: Training               |
==================================================

######### trainer ###########
lr: 0.001 l2: 0.001 bs: 64
  0%|          | 0/5000 [00:00<?, ?it/s]  0%|          | 2/5000 [00:00<05:49, 14.31it/s]  0%|          | 4/5000 [00:00<05:22, 15.50it/s]  0%|          | 6/5000 [00:00<05:23, 15.46it/s]  0%|          | 8/5000 [00:00<04:58, 16.74it/s]  0%|          | 10/5000 [00:00<04:49, 17.22it/s]  0%|          | 10/5000 [00:00<05:27, 15.22it/s]
AUC:  0.6301309739040455 LOGlOSS:  0.6663822547775122 test_AUC:  0.6028709592020585 test_LOGlOSS:  0.6380071442539028
Time:  0.9804443070315756
