nohup: ignoring input
2024-07-04 11:11:33.639983: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2024-07-04 11:11:41.076192: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-07-04 11:11:41.076380: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-07-04 11:11:41.077097: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:23:00.0 name: Tesla V100-SXM2-32GB computeCapability: 7.0
coreClock: 1.53GHz coreCount: 80 deviceMemorySize: 31.74GiB deviceMemoryBandwidth: 836.37GiB/s
2024-07-04 11:11:41.077140: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2024-07-04 11:11:41.077197: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2024-07-04 11:11:41.077226: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2024-07-04 11:11:41.163795: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-07-04 11:11:41.164353: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-07-04 11:11:41.164519: W tensorflow/stream_executor/platform/default/dso_loader.cc:60] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /lib/x86_64-linux-gnu:/usr/lib/x86_64-linux-gnu::/usr/local/cuda-11.7/lib64
2024-07-04 11:11:41.165510: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2024-07-04 11:11:41.165588: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2024-07-04 11:11:41.165601: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1757] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2024-07-04 11:11:41.166060: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX512F
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-07-04 11:11:41.169578: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-07-04 11:11:41.169617: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-07-04 11:11:41.169626: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      
2024-07-04 11:11:41.439831: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-07-04 11:11:41.463541: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2500000000 Hz
{'model_opt': {'latent_dim': 16, 'feat_num': 647, 'field_num': 10, 'mlp_dropout': 0.0, 'use_bn': False, 'mlp_dims': [1024, 512, 256], 'cross': 3}, 'dataset': 'coat', 'model': 'TJR-CTR', 'data_dir': 'data/coat/tfrecord2', 'cuda': 6, 'source': None}
==================================================
|          TJR-CTR: Set the random seed          |
==================================================

==================================================
|               TJR-CTR: Training                |
==================================================

######### trainer ###########
alpha1 0.09264765643904409 alpha2 0.5 lr: 3e-05 l2: 0.0001 bs: 32
  0%|          | 0/5000 [00:00<?, ?it/s]  0%|          | 1/5000 [00:05<6:58:48,  5.03s/it]  0%|          | 2/5000 [00:08<5:37:47,  4.06s/it]  0%|          | 3/5000 [00:11<4:42:55,  3.40s/it]  0%|          | 4/5000 [00:13<4:12:24,  3.03s/it]  0%|          | 5/5000 [00:16<4:16:02,  3.08s/it]  0%|          | 6/5000 [00:18<3:46:47,  2.72s/it]  0%|          | 7/5000 [00:21<3:42:24,  2.67s/it]  0%|          | 8/5000 [00:24<4:04:58,  2.94s/it]  0%|          | 9/5000 [00:28<4:20:14,  3.13s/it]  0%|          | 10/5000 [00:31<4:25:28,  3.19s/it]  0%|          | 11/5000 [00:34<4:21:15,  3.14s/it]  0%|          | 12/5000 [00:37<4:19:19,  3.12s/it]  0%|          | 13/5000 [00:40<4:21:13,  3.14s/it]  0%|          | 14/5000 [00:43<4:13:31,  3.05s/it]  0%|          | 15/5000 [00:46<4:02:26,  2.92s/it]  0%|          | 16/5000 [00:49<4:02:42,  2.92s/it]  0%|          | 17/5000 [00:51<3:56:02,  2.84s/it]  0%|          | 18/5000 [00:54<3:45:36,  2.72s/it]  0%|          | 19/5000 [00:57<3:45:26,  2.72s/it]  0%|          | 20/5000 [00:59<3:39:31,  2.64s/it]  0%|          | 21/5000 [01:02<3:34:08,  2.58s/it]  0%|          | 22/5000 [01:06<4:14:35,  3.07s/it]  0%|          | 23/5000 [01:09<4:20:03,  3.14s/it]  0%|          | 24/5000 [01:12<4:21:25,  3.15s/it]  0%|          | 25/5000 [01:16<4:29:52,  3.25s/it]  1%|          | 26/5000 [01:19<4:41:47,  3.40s/it]  1%|          | 27/5000 [01:23<4:37:18,  3.35s/it]  1%|          | 28/5000 [01:25<4:17:04,  3.10s/it]  1%|          | 29/5000 [01:27<3:54:52,  2.83s/it]  1%|          | 30/5000 [01:31<4:05:48,  2.97s/it]  1%|          | 31/5000 [01:33<3:54:28,  2.83s/it]  1%|          | 32/5000 [01:36<3:52:23,  2.81s/it]  1%|          | 33/5000 [01:39<3:52:03,  2.80s/it]  1%|          | 34/5000 [01:41<3:32:42,  2.57s/it]  1%|          | 35/5000 [01:43<3:33:57,  2.59s/it]  1%|          | 36/5000 [01:46<3:36:31,  2.62s/it]  1%|          | 37/5000 [01:49<3:34:42,  2.60s/it]  1%|          | 38/5000 [01:51<3:34:08,  2.59s/it]  1%|          | 39/5000 [01:54<3:31:27,  2.56s/it]  1%|          | 40/5000 [01:56<3:27:06,  2.51s/it]  1%|          | 41/5000 [01:59<3:33:35,  2.58s/it]  1%|          | 42/5000 [02:01<3:32:08,  2.57s/it]  1%|          | 43/5000 [02:04<3:38:11,  2.64s/it]  1%|          | 44/5000 [02:07<3:36:28,  2.62s/it]  1%|          | 45/5000 [02:09<3:29:00,  2.53s/it]  1%|          | 46/5000 [02:12<3:32:42,  2.58s/it]  1%|          | 47/5000 [02:14<3:33:59,  2.59s/it]  1%|          | 48/5000 [02:17<3:32:45,  2.58s/it]  1%|          | 49/5000 [02:19<3:26:10,  2.50s/it]  1%|          | 50/5000 [02:21<3:17:38,  2.40s/it]  1%|          | 51/5000 [02:24<3:10:30,  2.31s/it]  1%|          | 52/5000 [02:26<3:05:06,  2.24s/it]  1%|          | 53/5000 [02:28<3:00:06,  2.18s/it]  1%|          | 53/5000 [02:30<3:53:38,  2.83s/it]
AUC:  0.7480975938704446 LOGlOSS:  0.5307607111731839 test_AUC:  0.7505927995566144 test_LOGlOSS:  0.4425867300703739
Time:  156.2580749920453
{'model_opt': {'latent_dim': 16, 'feat_num': 647, 'field_num': 10, 'mlp_dropout': 0.0, 'use_bn': False, 'mlp_dims': [1024, 512, 256], 'cross': 3}, 'dataset': 'coat', 'model': 'Bridge-CTR', 'data_dir': 'data/coat/tfrecord2', 'cuda': 6, 'source': None}
==================================================
|        Bridge-CTR: Set the random seed         |
==================================================

==================================================
|              Bridge-CTR: Training              |
==================================================

######### trainer ###########
alpha1 0.1 lr: 0.0003 l2: 0.001 bs: 16
  0%|          | 0/5000 [00:00<?, ?it/s]  0%|          | 1/5000 [00:03<5:19:15,  3.83s/it]  0%|          | 2/5000 [00:09<6:28:57,  4.67s/it]  0%|          | 3/5000 [00:12<5:45:14,  4.15s/it]  0%|          | 4/5000 [00:16<5:25:42,  3.91s/it]  0%|          | 5/5000 [00:20<5:43:40,  4.13s/it]  0%|          | 6/5000 [00:25<6:15:01,  4.51s/it]  0%|          | 7/5000 [00:30<6:05:27,  4.39s/it]  0%|          | 8/5000 [00:34<6:09:18,  4.44s/it]  0%|          | 9/5000 [00:37<5:37:28,  4.06s/it]  0%|          | 10/5000 [00:41<5:19:49,  3.85s/it]  0%|          | 10/5000 [00:45<6:16:24,  4.53s/it]
AUC:  0.7598521093600126 LOGlOSS:  0.52482912432174 test_AUC:  0.7617446686131444 test_LOGlOSS:  0.42916208469376177
Time:  46.67831652297173
{'model_opt': {'latent_dim': 16, 'feat_num': 647, 'field_num': 10, 'mlp_dropout': 0.0, 'use_bn': True, 'mlp_dims': [1024, 512, 256], 'cross': 3}, 'dataset': 'coat', 'model': 'CausE-CTR', 'data_dir': 'data/coat/tfrecord2', 'cuda': 6, 'source': None}
==================================================
|         CausE-CTR: Set the random seed         |
==================================================

==================================================
|              CausE-CTR: Training               |
==================================================

######### trainer ###########
alpha1 0.01 lr: 0.0001 l2: 1e-05 bs: 64
  0%|          | 0/5000 [00:00<?, ?it/s]  0%|          | 1/5000 [00:00<57:43,  1.44it/s]  0%|          | 2/5000 [00:01<48:17,  1.72it/s]  0%|          | 3/5000 [00:01<42:22,  1.97it/s]  0%|          | 4/5000 [00:02<39:12,  2.12it/s]  0%|          | 5/5000 [00:02<41:43,  2.00it/s]  0%|          | 6/5000 [00:03<44:38,  1.86it/s]  0%|          | 7/5000 [00:03<49:55,  1.67it/s]  0%|          | 8/5000 [00:04<50:47,  1.64it/s]  0%|          | 9/5000 [00:05<50:30,  1.65it/s]  0%|          | 10/5000 [00:05<47:41,  1.74it/s]  0%|          | 11/5000 [00:06<44:23,  1.87it/s]  0%|          | 12/5000 [00:06<44:29,  1.87it/s]  0%|          | 13/5000 [00:07<1:03:14,  1.31it/s]  0%|          | 14/5000 [00:08<1:07:47,  1.23it/s]  0%|          | 15/5000 [00:09<1:12:37,  1.14it/s]  0%|          | 16/5000 [00:11<1:22:39,  1.00it/s]  0%|          | 17/5000 [00:12<1:24:13,  1.01s/it]  0%|          | 18/5000 [00:13<1:27:07,  1.05s/it]  0%|          | 19/5000 [00:14<1:26:20,  1.04s/it]  0%|          | 20/5000 [00:15<1:19:12,  1.05it/s]  0%|          | 21/5000 [00:15<1:14:11,  1.12it/s]  0%|          | 21/5000 [00:16<1:05:41,  1.26it/s]
AUC:  0.7710311070288747 LOGlOSS:  0.5221368742867406 test_AUC:  0.7574559423751217 test_LOGlOSS:  0.45685427564129744
Time:  17.920889944012742
{'model_opt': {'latent_dim': 16, 'feat_num': 647, 'field_num': 10, 'mlp_dropout': 0.0, 'use_bn': True, 'mlp_dims': [1024, 512, 256], 'cross': 3}, 'dataset': 'coat', 'model': 'DR-CTR', 'data_dir': 'data/coat/tfrecord2', 'cuda': 6, 'source': None}
==================================================
|          DR-CTR: Set the random seed           |
==================================================

==================================================
|            DR-CTR: Estimate pscore             |
==================================================

==================================================
|                DR-CTR: Training                |
==================================================

######### trainer ###########
beta1 0.4079360630377604 lr: 0.0003 l2: 0.001 bs: 64
  0%|          | 0/5000 [00:00<?, ?it/s]  0%|          | 1/5000 [00:02<3:21:22,  2.42s/it]  0%|          | 2/5000 [00:04<3:20:36,  2.41s/it]  0%|          | 3/5000 [00:07<3:20:39,  2.41s/it]  0%|          | 4/5000 [00:08<2:56:43,  2.12s/it]  0%|          | 5/5000 [00:10<2:39:58,  1.92s/it]  0%|          | 6/5000 [00:12<2:33:58,  1.85s/it]  0%|          | 7/5000 [00:14<2:39:34,  1.92s/it]  0%|          | 8/5000 [00:16<2:42:35,  1.95s/it]  0%|          | 9/5000 [00:18<2:43:58,  1.97s/it]  0%|          | 10/5000 [00:19<2:29:05,  1.79s/it]  0%|          | 11/5000 [00:20<2:15:08,  1.63s/it]  0%|          | 12/5000 [00:22<2:17:54,  1.66s/it]  0%|          | 13/5000 [00:24<2:16:47,  1.65s/it]  0%|          | 14/5000 [00:26<2:19:44,  1.68s/it]  0%|          | 15/5000 [00:27<2:25:01,  1.75s/it]  0%|          | 16/5000 [00:29<2:21:22,  1.70s/it]  0%|          | 17/5000 [00:31<2:28:08,  1.78s/it]  0%|          | 18/5000 [00:33<2:27:11,  1.77s/it]  0%|          | 19/5000 [00:34<2:23:53,  1.73s/it]  0%|          | 20/5000 [00:36<2:14:41,  1.62s/it]  0%|          | 21/5000 [00:38<2:20:16,  1.69s/it]  0%|          | 22/5000 [00:39<2:24:33,  1.74s/it]  0%|          | 23/5000 [00:41<2:26:08,  1.76s/it]  0%|          | 24/5000 [00:44<2:40:01,  1.93s/it]  0%|          | 25/5000 [00:46<2:46:26,  2.01s/it]  0%|          | 25/5000 [00:48<2:39:34,  1.92s/it]
AUC:  0.755093914044379 LOGlOSS:  0.604912719508265 test_AUC:  0.7502147410442034 test_LOGlOSS:  0.5174886946411336
Time:  49.820164690958336
{'model_opt': {'latent_dim': 16, 'feat_num': 647, 'field_num': 10, 'mlp_dropout': 0.0, 'use_bn': False, 'mlp_dims': [1024, 512, 256], 'cross': 3}, 'dataset': 'coat', 'model': 'DRJL-CTR', 'data_dir': 'data/coat/tfrecord2', 'cuda': 6, 'source': None}
==================================================
|         DRJL-CTR: Set the random seed          |
==================================================

==================================================
|           DRJL-CTR: Estimate pscore            |
==================================================

==================================================
|               DRJL-CTR: Training               |
==================================================

######### trainer ###########
beta1 0.7722716233929617 lr: 0.001 l2: 1e-06 bs: 16
  0%|          | 0/5000 [00:00<?, ?it/s]  0%|          | 1/5000 [00:07<10:31:37,  7.58s/it]  0%|          | 2/5000 [00:15<10:30:30,  7.57s/it]  0%|          | 3/5000 [00:23<10:43:04,  7.72s/it]  0%|          | 4/5000 [00:30<10:36:08,  7.64s/it]  0%|          | 5/5000 [00:37<10:26:03,  7.52s/it]  0%|          | 6/5000 [00:45<10:23:33,  7.49s/it]  0%|          | 7/5000 [00:52<10:28:52,  7.56s/it]  0%|          | 8/5000 [00:59<9:53:00,  7.13s/it]   0%|          | 8/5000 [01:06<11:36:05,  8.37s/it]
AUC:  0.7358896400978963 LOGlOSS:  0.6394151977781632 test_AUC:  0.7365195000104751 test_LOGlOSS:  0.4903148810386605
Time:  68.3437367209699
{'model_opt': {'latent_dim': 16, 'feat_num': 647, 'field_num': 10, 'mlp_dropout': 0.0, 'use_bn': False, 'mlp_dims': [1024, 512, 256], 'cross': 3}, 'dataset': 'coat', 'model': 'IDIPS-CTR', 'data_dir': 'data/coat/tfrecord2', 'cuda': 6, 'source': None}
==================================================
|         IDIPS-CTR: Set the random seed         |
==================================================

==================================================
|           IDIPS-CTR: Estimate pscore           |
==================================================

==================================================
|              IDIPS-CTR: Training               |
==================================================

######### trainer ###########
beta1 0.06220025560394642 lr: 0.001 l2: 0.001 bs: 32
  0%|          | 0/5000 [00:00<?, ?it/s]  0%|          | 1/5000 [00:01<1:39:42,  1.20s/it]  0%|          | 2/5000 [00:02<2:02:03,  1.47s/it]  0%|          | 3/5000 [00:04<2:17:57,  1.66s/it]  0%|          | 4/5000 [00:06<2:20:09,  1.68s/it]  0%|          | 5/5000 [00:08<2:33:52,  1.85s/it]  0%|          | 6/5000 [00:10<2:36:50,  1.88s/it]  0%|          | 7/5000 [00:12<2:46:11,  2.00s/it]  0%|          | 8/5000 [00:14<2:34:37,  1.86s/it]  0%|          | 9/5000 [00:15<2:12:12,  1.59s/it]  0%|          | 10/5000 [00:16<2:10:04,  1.56s/it]  0%|          | 11/5000 [00:18<2:15:53,  1.63s/it]  0%|          | 12/5000 [00:19<2:08:23,  1.54s/it]  0%|          | 13/5000 [00:21<2:08:34,  1.55s/it]  0%|          | 14/5000 [00:23<2:17:44,  1.66s/it]  0%|          | 15/5000 [00:25<2:19:18,  1.68s/it]  0%|          | 16/5000 [00:26<2:04:15,  1.50s/it]  0%|          | 17/5000 [00:27<2:02:41,  1.48s/it]  0%|          | 18/5000 [00:28<1:57:43,  1.42s/it]  0%|          | 19/5000 [00:30<1:57:42,  1.42s/it]  0%|          | 20/5000 [00:31<1:46:49,  1.29s/it]  0%|          | 21/5000 [00:33<2:00:15,  1.45s/it]  0%|          | 22/5000 [00:34<1:55:51,  1.40s/it]  0%|          | 23/5000 [00:35<1:51:11,  1.34s/it]  0%|          | 24/5000 [00:37<1:57:50,  1.42s/it]  0%|          | 24/5000 [00:38<2:12:48,  1.60s/it]
AUC:  0.7597009632656856 LOGlOSS:  0.6589022003190917 test_AUC:  0.7472068427638457 test_LOGlOSS:  0.5906488702767185
Time:  39.69084799196571
{'model_opt': {'latent_dim': 16, 'feat_num': 647, 'field_num': 10, 'mlp_dropout': 0.0, 'use_bn': False, 'mlp_dims': [1024, 512, 256], 'cross': 3}, 'dataset': 'coat', 'model': 'IPS-CTR', 'data_dir': 'data/coat/tfrecord2', 'cuda': 6, 'source': None}
==================================================
|          IPS-CTR: Set the random seed          |
==================================================

==================================================
|            IPS-CTR: Estimate pscore            |
==================================================

==================================================
|               IPS-CTR: Training                |
==================================================

######### trainer ###########
lr: 0.0001 l2: 0.001 bs: 64
  0%|          | 0/5000 [00:00<?, ?it/s]  0%|          | 1/5000 [00:00<1:10:26,  1.18it/s]  0%|          | 2/5000 [00:01<1:11:53,  1.16it/s]  0%|          | 3/5000 [00:02<1:14:26,  1.12it/s]  0%|          | 4/5000 [00:03<1:13:45,  1.13it/s]  0%|          | 5/5000 [00:04<1:09:02,  1.21it/s]  0%|          | 6/5000 [00:05<1:10:10,  1.19it/s]  0%|          | 7/5000 [00:06<1:16:23,  1.09it/s]  0%|          | 8/5000 [00:07<1:14:06,  1.12it/s]  0%|          | 9/5000 [00:07<1:14:44,  1.11it/s]  0%|          | 10/5000 [00:08<1:12:58,  1.14it/s]  0%|          | 11/5000 [00:09<1:15:02,  1.11it/s]  0%|          | 12/5000 [00:10<1:13:18,  1.13it/s]  0%|          | 13/5000 [00:11<1:18:00,  1.07it/s]  0%|          | 14/5000 [00:12<1:21:31,  1.02it/s]  0%|          | 15/5000 [00:13<1:11:58,  1.15it/s]  0%|          | 16/5000 [00:13<1:06:05,  1.26it/s]  0%|          | 17/5000 [00:14<1:07:16,  1.23it/s]  0%|          | 18/5000 [00:15<1:05:39,  1.26it/s]  0%|          | 19/5000 [00:16<1:05:17,  1.27it/s]  0%|          | 19/5000 [00:17<1:14:34,  1.11it/s]
AUC:  0.7474697562478564 LOGlOSS:  0.5329150398995347 test_AUC:  0.7505922281835478 test_LOGlOSS:  0.4360851484794588
Time:  18.219318706018385
{'model_opt': {'latent_dim': 16, 'feat_num': 647, 'field_num': 10, 'mlp_dropout': 0.0, 'use_bn': False, 'mlp_dims': [1024, 512, 256], 'cross': 3}, 'dataset': 'coat', 'model': 'Refine-CTR', 'data_dir': 'data/coat/tfrecord2', 'cuda': 6, 'source': None}
==================================================
|        Refine-CTR: Set the random seed         |
==================================================

==================================================
|              Refine-CTR: Training              |
==================================================

######### trainer ###########
beta1 0.5309575783598717 lr: 0.0001 l2: 0.0003 bs: 32
  0%|          | 0/5000 [00:00<?, ?it/s]  0%|          | 1/5000 [00:02<4:03:29,  2.92s/it]  0%|          | 2/5000 [00:05<3:24:50,  2.46s/it]  0%|          | 3/5000 [00:07<3:08:07,  2.26s/it]  0%|          | 4/5000 [00:09<3:07:54,  2.26s/it]  0%|          | 5/5000 [00:11<3:03:43,  2.21s/it]  0%|          | 6/5000 [00:13<3:05:09,  2.22s/it]  0%|          | 7/5000 [00:15<2:59:00,  2.15s/it]  0%|          | 8/5000 [00:18<3:02:49,  2.20s/it]  0%|          | 9/5000 [00:19<2:47:39,  2.02s/it]  0%|          | 10/5000 [00:21<2:44:45,  1.98s/it]  0%|          | 11/5000 [00:23<2:54:03,  2.09s/it]  0%|          | 12/5000 [00:26<3:05:32,  2.23s/it]  0%|          | 13/5000 [00:28<2:54:22,  2.10s/it]  0%|          | 14/5000 [00:30<2:56:35,  2.13s/it]  0%|          | 15/5000 [00:32<2:56:15,  2.12s/it]  0%|          | 16/5000 [00:34<2:56:09,  2.12s/it]  0%|          | 17/5000 [00:36<2:59:05,  2.16s/it]  0%|          | 18/5000 [00:38<2:54:42,  2.10s/it]  0%|          | 19/5000 [00:41<2:58:50,  2.15s/it]  0%|          | 20/5000 [00:43<3:03:16,  2.21s/it]  0%|          | 21/5000 [00:45<2:56:23,  2.13s/it]  0%|          | 22/5000 [00:47<2:58:44,  2.15s/it]  0%|          | 23/5000 [00:49<2:54:33,  2.10s/it]  0%|          | 24/5000 [00:51<2:53:11,  2.09s/it]  0%|          | 25/5000 [00:53<2:55:01,  2.11s/it]  1%|          | 26/5000 [00:55<2:55:22,  2.12s/it]  1%|          | 27/5000 [00:58<2:57:01,  2.14s/it]  1%|          | 28/5000 [01:00<3:10:53,  2.30s/it]  1%|          | 29/5000 [01:03<3:10:20,  2.30s/it]  1%|          | 30/5000 [01:05<3:11:28,  2.31s/it]  1%|          | 31/5000 [01:07<3:08:19,  2.27s/it]  1%|          | 32/5000 [01:10<3:13:13,  2.33s/it]  1%|          | 33/5000 [01:12<3:03:47,  2.22s/it]  1%|          | 34/5000 [01:14<3:01:45,  2.20s/it]  1%|          | 35/5000 [01:16<3:13:06,  2.33s/it]  1%|          | 36/5000 [01:19<3:16:45,  2.38s/it]  1%|          | 37/5000 [01:21<3:17:50,  2.39s/it]  1%|          | 38/5000 [01:23<3:10:22,  2.30s/it]  1%|          | 39/5000 [01:26<3:10:51,  2.31s/it]  1%|          | 40/5000 [01:28<3:20:52,  2.43s/it]  1%|          | 41/5000 [01:31<3:16:55,  2.38s/it]  1%|          | 42/5000 [01:33<3:13:20,  2.34s/it]  1%|          | 43/5000 [01:35<3:14:40,  2.36s/it]  1%|          | 44/5000 [01:37<3:06:15,  2.25s/it]  1%|          | 45/5000 [01:39<3:02:17,  2.21s/it]  1%|          | 46/5000 [01:41<2:57:51,  2.15s/it]  1%|          | 47/5000 [01:43<2:51:32,  2.08s/it]  1%|          | 48/5000 [01:45<2:49:47,  2.06s/it]  1%|          | 49/5000 [01:48<2:54:35,  2.12s/it]  1%|          | 50/5000 [01:51<3:20:56,  2.44s/it]  1%|          | 51/5000 [01:53<3:08:00,  2.28s/it]  1%|          | 52/5000 [01:55<2:58:01,  2.16s/it]  1%|          | 53/5000 [01:57<2:57:38,  2.15s/it]  1%|          | 54/5000 [01:59<2:55:27,  2.13s/it]  1%|          | 55/5000 [02:01<2:58:35,  2.17s/it]  1%|          | 56/5000 [02:03<3:04:46,  2.24s/it]  1%|          | 57/5000 [02:06<3:02:09,  2.21s/it]  1%|          | 58/5000 [02:08<3:05:48,  2.26s/it]  1%|          | 59/5000 [02:10<2:59:48,  2.18s/it]  1%|          | 60/5000 [02:13<3:14:52,  2.37s/it]  1%|          | 61/5000 [02:15<3:19:01,  2.42s/it]  1%|          | 62/5000 [02:18<3:31:21,  2.57s/it]  1%|▏         | 63/5000 [02:21<3:31:25,  2.57s/it]  1%|▏         | 64/5000 [02:23<3:19:55,  2.43s/it]  1%|▏         | 65/5000 [02:25<3:16:12,  2.39s/it]  1%|▏         | 66/5000 [02:27<3:00:57,  2.20s/it]  1%|▏         | 67/5000 [02:28<2:34:22,  1.88s/it]  1%|▏         | 68/5000 [02:30<2:24:58,  1.76s/it]  1%|▏         | 69/5000 [02:31<2:12:48,  1.62s/it]  1%|▏         | 69/5000 [02:32<3:02:04,  2.22s/it]
AUC:  0.7656305408123522 LOGlOSS:  0.8032813458426434 test_AUC:  0.7563905220635709 test_LOGlOSS:  0.8291222764008658
Time:  154.2131060580141
{'model_opt': {'latent_dim': 16, 'feat_num': 647, 'field_num': 10, 'mlp_dropout': 0.0, 'use_bn': True, 'mlp_dims': [1024, 512, 256], 'cross': 3}, 'dataset': 'coat', 'model': 'UDIPS-CTR', 'data_dir': 'data/coat/tfrecord2', 'cuda': 6, 'source': None}
==================================================
|         UDIPS-CTR: Set the random seed         |
==================================================

==================================================
|           UDIPS-CTR: Estimate pscore           |
==================================================

==================================================
|              UDIPS-CTR: Training               |
==================================================

######### trainer ###########
beta1 0.26887902815945114 lr: 0.0003 l2: 1e-05 bs: 64
  0%|          | 0/5000 [00:00<?, ?it/s]  0%|          | 1/5000 [00:00<1:06:16,  1.26it/s]  0%|          | 2/5000 [00:01<53:42,  1.55it/s]    0%|          | 3/5000 [00:01<48:40,  1.71it/s]  0%|          | 4/5000 [00:02<46:35,  1.79it/s]  0%|          | 5/5000 [00:02<48:14,  1.73it/s]  0%|          | 6/5000 [00:03<48:15,  1.72it/s]  0%|          | 7/5000 [00:04<48:29,  1.72it/s]  0%|          | 8/5000 [00:04<44:20,  1.88it/s]  0%|          | 9/5000 [00:04<39:46,  2.09it/s]  0%|          | 10/5000 [00:05<41:20,  2.01it/s]  0%|          | 10/5000 [00:06<50:24,  1.65it/s]
AUC:  0.7503473453513856  LOGlOSS:  0.5307061841035067 test_AUC:  0.7526842154381194 test_LOGlOSS:  0.45189009857651613
Time:  7.228544073004741
{'model_opt': {'latent_dim': 16, 'feat_num': 647, 'field_num': 10, 'mlp_dropout': 0.0, 'use_bn': False, 'mlp_dims': [1024, 512, 256], 'cross': 3}, 'dataset': 'coat', 'model': 'bias_BASE-CTR', 'data_dir': 'data/coat/tfrecord2', 'cuda': 6, 'source': 'bias'}
==================================================
|         BASE-CTR: Set the random seed          |
==================================================

==================================================
|               BASE-CTR: Training               |
==================================================

######### trainer ###########
lr: 0.001 l2: 3e-05 bs: 64
  0%|          | 0/5000 [00:00<?, ?it/s]  0%|          | 1/5000 [00:00<45:52,  1.82it/s]  0%|          | 2/5000 [00:01<49:55,  1.67it/s]  0%|          | 3/5000 [00:01<46:45,  1.78it/s]  0%|          | 4/5000 [00:02<39:23,  2.11it/s]  0%|          | 5/5000 [00:02<36:08,  2.30it/s]  0%|          | 6/5000 [00:02<38:16,  2.17it/s]  0%|          | 7/5000 [00:03<39:40,  2.10it/s]  0%|          | 8/5000 [00:03<40:38,  2.05it/s]  0%|          | 8/5000 [00:04<44:21,  1.88it/s]
AUC:  0.7490945767618693 LOGlOSS:  0.5286885590486592 test_AUC:  0.7526952619840739 test_LOGlOSS:  0.44749666547541794
Time:  5.509601991972886
{'model_opt': {'latent_dim': 16, 'feat_num': 647, 'field_num': 10, 'mlp_dropout': 0.0, 'use_bn': False, 'mlp_dims': [1024, 512, 256], 'cross': 3}, 'dataset': 'coat', 'model': 'combine_BASE-CTR', 'data_dir': 'data/coat/tfrecord2', 'cuda': 6, 'source': 'combine'}
==================================================
|         BASE-CTR: Set the random seed          |
==================================================

==================================================
|               BASE-CTR: Training               |
==================================================

######### trainer ###########
lr: 0.0001 l2: 0.0001 bs: 64
  0%|          | 0/5000 [00:00<?, ?it/s]  0%|          | 1/5000 [00:00<38:37,  2.16it/s]  0%|          | 2/5000 [00:00<38:50,  2.14it/s]  0%|          | 3/5000 [00:01<45:35,  1.83it/s]  0%|          | 4/5000 [00:02<47:51,  1.74it/s]  0%|          | 5/5000 [00:02<49:04,  1.70it/s]  0%|          | 6/5000 [00:03<47:03,  1.77it/s]  0%|          | 7/5000 [00:03<46:22,  1.79it/s]  0%|          | 8/5000 [00:04<45:36,  1.82it/s]  0%|          | 9/5000 [00:04<45:08,  1.84it/s]  0%|          | 10/5000 [00:05<45:05,  1.84it/s]  0%|          | 11/5000 [00:05<44:06,  1.89it/s]  0%|          | 12/5000 [00:06<42:39,  1.95it/s]  0%|          | 13/5000 [00:06<42:31,  1.95it/s]  0%|          | 14/5000 [00:07<44:23,  1.87it/s]  0%|          | 15/5000 [00:08<46:38,  1.78it/s]  0%|          | 16/5000 [00:08<47:31,  1.75it/s]  0%|          | 17/5000 [00:09<45:37,  1.82it/s]  0%|          | 18/5000 [00:09<46:20,  1.79it/s]  0%|          | 19/5000 [00:10<44:32,  1.86it/s]  0%|          | 19/5000 [00:10<47:46,  1.74it/s]
AUC:  0.754916608049111 LOGlOSS:  0.5231353172934241 test_AUC:  0.7540894122666179 test_LOGlOSS:  0.44159626861768664
Time:  12.206704217009246
{'model_opt': {'latent_dim': 16, 'feat_num': 647, 'field_num': 10, 'mlp_dropout': 0.0, 'use_bn': False, 'mlp_dims': [1024, 512, 256], 'cross': 3}, 'dataset': 'coat', 'model': 'unif_BASE-CTR', 'data_dir': 'data/coat/tfrecord2', 'cuda': 6, 'source': 'unif'}
==================================================
|         BASE-CTR: Set the random seed          |
==================================================

==================================================
|               BASE-CTR: Training               |
==================================================

######### trainer ###########
lr: 0.001 l2: 1e-06 bs: 64
  0%|          | 0/5000 [00:00<?, ?it/s]  0%|          | 1/5000 [00:00<10:26,  7.97it/s]  0%|          | 2/5000 [00:00<10:58,  7.59it/s]  0%|          | 3/5000 [00:00<12:44,  6.54it/s]  0%|          | 4/5000 [00:00<11:17,  7.37it/s]  0%|          | 5/5000 [00:00<11:05,  7.51it/s]  0%|          | 6/5000 [00:00<11:10,  7.45it/s]  0%|          | 7/5000 [00:00<10:25,  7.98it/s]  0%|          | 8/5000 [00:01<09:58,  8.34it/s]  0%|          | 9/5000 [00:01<09:36,  8.66it/s]  0%|          | 10/5000 [00:01<11:03,  7.52it/s]
AUC:  0.6280643417296926 LOGlOSS:  0.667850554300557 test_AUC:  0.6022481625594466 test_LOGlOSS:  0.6355605916123027
Time:  2.0876286539714783
