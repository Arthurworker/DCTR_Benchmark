nohup: ignoring input
2024-07-26 19:55:51.705887: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2024-07-26 19:55:54.800970: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-07-26 19:55:54.801112: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-07-26 19:55:54.801785: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:20:00.0 name: Tesla V100-SXM2-32GB computeCapability: 7.0
coreClock: 1.53GHz coreCount: 80 deviceMemorySize: 31.74GiB deviceMemoryBandwidth: 836.37GiB/s
2024-07-26 19:55:54.801822: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2024-07-26 19:55:54.801877: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2024-07-26 19:55:54.801902: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2024-07-26 19:55:54.835518: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-07-26 19:55:54.835936: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-07-26 19:55:54.836078: W tensorflow/stream_executor/platform/default/dso_loader.cc:60] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /lib/x86_64-linux-gnu:/usr/lib/x86_64-linux-gnu::/usr/local/cuda-11.7/lib64
2024-07-26 19:55:54.844935: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2024-07-26 19:55:54.845001: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2024-07-26 19:55:54.845013: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1757] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2024-07-26 19:55:54.845358: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX512F
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-07-26 19:55:54.851406: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-07-26 19:55:54.851448: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-07-26 19:55:54.851459: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      
2024-07-26 19:55:54.923005: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-07-26 19:55:54.940657: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2500000000 Hz
{'model_opt': {'latent_dim': 16, 'feat_num': 41388, 'field_num': 88, 'mlp_dropout': 0.0, 'use_bn': False, 'mlp_dims': [1024, 512, 256], 'cross': 3}, 'dataset': 'kuairand', 'model': 'TJR-CTR', 'data_dir': 'data/kuairand/threshold_2', 'cuda': 3, 'source': None}
==================================================
|          TJR-CTR: Set the random seed          |
==================================================

==================================================
|               TJR-CTR: Training                |
==================================================

######### trainer ###########
alpha1 0.094426315862199 alpha2 0.3 lr: 3e-05 l2: 0.0003 bs: 1024
  0%|          | 0/5000 [00:00<?, ?it/s]  0%|          | 1/5000 [00:10<13:59:15, 10.07s/it]  0%|          | 2/5000 [00:19<13:48:15,  9.94s/it]  0%|          | 3/5000 [00:29<13:46:14,  9.92s/it]  0%|          | 4/5000 [00:39<13:45:45,  9.92s/it]  0%|          | 5/5000 [00:49<13:39:07,  9.84s/it]  0%|          | 6/5000 [00:59<13:38:37,  9.84s/it]  0%|          | 7/5000 [01:07<12:53:23,  9.29s/it]  0%|          | 8/5000 [01:17<13:10:34,  9.50s/it]  0%|          | 9/5000 [01:27<13:22:17,  9.64s/it]  0%|          | 10/5000 [01:37<13:25:18,  9.68s/it]  0%|          | 11/5000 [01:46<13:26:44,  9.70s/it]  0%|          | 12/5000 [01:56<13:31:42,  9.76s/it]  0%|          | 13/5000 [02:04<12:52:04,  9.29s/it]  0%|          | 14/5000 [02:13<12:24:46,  8.96s/it]  0%|          | 15/5000 [02:21<12:06:13,  8.74s/it]  0%|          | 16/5000 [02:29<11:51:53,  8.57s/it]  0%|          | 16/5000 [02:37<13:39:10,  9.86s/it]
AUC:  0.709454417575741 LOGlOSS:  0.49790770494578906 test_AUC:  0.7077755941462811 test_LOGlOSS:  0.5016515504366239
Time:  191.99273637798615
{'model_opt': {'latent_dim': 16, 'feat_num': 41388, 'field_num': 88, 'mlp_dropout': 0.0, 'use_bn': False, 'mlp_dims': [1024, 512, 256], 'cross': 3}, 'dataset': 'kuairand', 'model': 'Bridge-CTR', 'data_dir': 'data/kuairand/threshold_2', 'cuda': 3, 'source': None}
==================================================
|        Bridge-CTR: Set the random seed         |
==================================================

==================================================
|              Bridge-CTR: Training              |
==================================================

######### trainer ###########
alpha1 1 lr: 1e-05 l2: 0.001 bs: 256
  0%|          | 0/5000 [00:00<?, ?it/s]  0%|          | 1/5000 [00:19<26:31:23, 19.10s/it]  0%|          | 2/5000 [00:37<25:55:44, 18.68s/it]  0%|          | 3/5000 [00:55<25:46:00, 18.56s/it]  0%|          | 4/5000 [01:14<25:41:58, 18.52s/it]  0%|          | 5/5000 [01:32<25:37:16, 18.47s/it]  0%|          | 6/5000 [01:50<25:30:07, 18.38s/it]  0%|          | 7/5000 [02:09<25:30:40, 18.39s/it]  0%|          | 8/5000 [02:27<25:29:41, 18.39s/it]  0%|          | 9/5000 [02:47<26:03:10, 18.79s/it]  0%|          | 10/5000 [03:07<26:47:12, 19.33s/it]  0%|          | 11/5000 [03:27<26:45:53, 19.31s/it]  0%|          | 12/5000 [03:46<26:44:34, 19.30s/it]  0%|          | 13/5000 [04:04<26:18:16, 18.99s/it]  0%|          | 14/5000 [04:22<25:56:12, 18.73s/it]  0%|          | 15/5000 [04:41<25:43:12, 18.57s/it]  0%|          | 16/5000 [04:59<25:37:40, 18.51s/it]  0%|          | 17/5000 [05:17<25:26:50, 18.38s/it]  0%|          | 18/5000 [05:35<25:13:43, 18.23s/it]  0%|          | 19/5000 [05:53<25:08:37, 18.17s/it]  0%|          | 20/5000 [06:11<25:01:17, 18.09s/it]  0%|          | 21/5000 [06:29<24:55:42, 18.02s/it]  0%|          | 22/5000 [06:47<24:58:39, 18.06s/it]  0%|          | 23/5000 [07:05<24:56:07, 18.04s/it]  0%|          | 24/5000 [07:23<24:54:29, 18.02s/it]  0%|          | 25/5000 [07:41<24:57:02, 18.05s/it]  1%|          | 26/5000 [07:59<25:01:56, 18.12s/it]  1%|          | 27/5000 [08:16<24:32:46, 17.77s/it]  1%|          | 28/5000 [08:34<24:43:20, 17.90s/it]  1%|          | 29/5000 [08:53<24:50:01, 17.98s/it]  1%|          | 30/5000 [09:11<24:54:17, 18.04s/it]  1%|          | 31/5000 [09:28<24:26:22, 17.71s/it]  1%|          | 32/5000 [09:46<24:42:15, 17.90s/it]  1%|          | 33/5000 [10:03<24:17:58, 17.61s/it]  1%|          | 34/5000 [10:20<23:53:44, 17.32s/it]  1%|          | 35/5000 [10:36<23:37:09, 17.13s/it]  1%|          | 36/5000 [10:53<23:24:48, 16.98s/it]  1%|          | 37/5000 [11:11<23:46:13, 17.24s/it]  1%|          | 38/5000 [11:28<23:36:27, 17.13s/it]  1%|          | 39/5000 [11:46<23:58:17, 17.40s/it]  1%|          | 40/5000 [12:02<23:39:53, 17.18s/it]  1%|          | 41/5000 [12:19<23:26:11, 17.01s/it]  1%|          | 42/5000 [12:37<23:47:06, 17.27s/it]  1%|          | 43/5000 [12:55<24:01:45, 17.45s/it]  1%|          | 44/5000 [13:12<24:09:20, 17.55s/it]  1%|          | 45/5000 [13:30<24:04:28, 17.49s/it]  1%|          | 46/5000 [13:46<23:26:52, 17.04s/it]  1%|          | 47/5000 [14:03<23:30:58, 17.09s/it]  1%|          | 48/5000 [14:20<23:19:35, 16.96s/it]  1%|          | 49/5000 [14:36<23:11:22, 16.86s/it]  1%|          | 50/5000 [14:53<23:05:32, 16.79s/it]  1%|          | 51/5000 [15:10<23:06:17, 16.81s/it]  1%|          | 52/5000 [15:28<23:35:34, 17.17s/it]  1%|          | 53/5000 [15:45<23:25:14, 17.04s/it]  1%|          | 54/5000 [16:01<23:19:50, 16.98s/it]  1%|          | 55/5000 [16:19<23:42:23, 17.26s/it]  1%|          | 56/5000 [16:37<23:58:14, 17.45s/it]  1%|          | 57/5000 [16:55<24:14:26, 17.65s/it]  1%|          | 58/5000 [17:13<24:20:38, 17.73s/it]  1%|          | 59/5000 [17:31<24:23:30, 17.77s/it]  1%|          | 60/5000 [17:48<23:55:27, 17.43s/it]  1%|          | 61/5000 [18:04<23:35:43, 17.20s/it]  1%|          | 62/5000 [18:21<23:21:29, 17.03s/it]  1%|▏         | 63/5000 [18:39<23:43:00, 17.29s/it]  1%|▏         | 64/5000 [18:56<23:30:58, 17.15s/it]  1%|▏         | 65/5000 [19:12<23:17:17, 16.99s/it]  1%|▏         | 66/5000 [19:29<23:08:06, 16.88s/it]  1%|▏         | 67/5000 [19:46<23:02:19, 16.81s/it]  1%|▏         | 67/5000 [20:02<24:35:58, 17.95s/it]
AUC:  0.6955159019147115 LOGlOSS:  0.4483040796477415 test_AUC:  0.6934739459797714 test_LOGlOSS:  0.45052325842989455
Time:  1227.031312157982
{'model_opt': {'latent_dim': 16, 'feat_num': 41388, 'field_num': 88, 'mlp_dropout': 0.0, 'use_bn': False, 'mlp_dims': [1024, 512, 256], 'cross': 3}, 'dataset': 'kuairand', 'model': 'CausE-CTR', 'data_dir': 'data/kuairand/threshold_2', 'cuda': 3, 'source': None}
==================================================
|         CausE-CTR: Set the random seed         |
==================================================

==================================================
|              CausE-CTR: Training               |
==================================================

######### trainer ###########
alpha1 1 lr: 3e-05 l2: 0.001 bs: 1024
  0%|          | 0/5000 [00:00<?, ?it/s]  0%|          | 1/5000 [00:03<4:36:06,  3.31s/it]  0%|          | 2/5000 [00:06<4:31:05,  3.25s/it]  0%|          | 3/5000 [00:09<4:30:07,  3.24s/it]  0%|          | 4/5000 [00:12<4:25:43,  3.19s/it]  0%|          | 5/5000 [00:16<4:27:43,  3.22s/it]  0%|          | 6/5000 [00:19<4:24:15,  3.17s/it]  0%|          | 7/5000 [00:22<4:25:10,  3.19s/it]  0%|          | 8/5000 [00:25<4:23:49,  3.17s/it]  0%|          | 9/5000 [00:27<3:51:15,  2.78s/it]  0%|          | 10/5000 [00:29<3:30:36,  2.53s/it]  0%|          | 11/5000 [00:31<3:15:00,  2.35s/it]  0%|          | 12/5000 [00:33<3:04:05,  2.21s/it]  0%|          | 12/5000 [00:35<4:03:56,  2.93s/it]
AUC:  0.7076456228741493 LOGlOSS:  0.5959937600713192 test_AUC:  0.7044643474876526 test_LOGlOSS:  0.5977118762748389
Time:  59.110397113952786
{'model_opt': {'latent_dim': 16, 'feat_num': 41388, 'field_num': 88, 'mlp_dropout': 0.0, 'use_bn': False, 'mlp_dims': [1024, 512, 256], 'cross': 3}, 'dataset': 'kuairand', 'model': 'DR-CTR', 'data_dir': 'data/kuairand/threshold_2', 'cuda': 3, 'source': None}
==================================================
|          DR-CTR: Set the random seed           |
==================================================

==================================================
|            DR-CTR: Estimate pscore             |
==================================================

==================================================
|                DR-CTR: Training                |
==================================================

######### trainer ###########
beta1 0.11880703514573611 lr: 3e-05 l2: 0.0003 bs: 256
  0%|          | 0/5000 [00:00<?, ?it/s]  0%|          | 1/5000 [00:25<35:46:43, 25.77s/it]  0%|          | 2/5000 [00:51<35:45:44, 25.76s/it]  0%|          | 3/5000 [01:17<35:47:48, 25.79s/it]  0%|          | 4/5000 [01:41<35:05:07, 25.28s/it]  0%|          | 5/5000 [02:06<34:38:31, 24.97s/it]  0%|          | 6/5000 [02:30<34:23:00, 24.79s/it]  0%|          | 7/5000 [02:54<34:07:20, 24.60s/it]  0%|          | 7/5000 [03:18<39:25:20, 28.42s/it]
AUC:  0.6709397354687318 LOGlOSS:  0.5467577186589382 test_AUC:  0.6686368710484456 test_LOGlOSS:  0.5491594922511731
Time:  223.21488511003554
{'model_opt': {'latent_dim': 16, 'feat_num': 41388, 'field_num': 88, 'mlp_dropout': 0.0, 'use_bn': False, 'mlp_dims': [1024, 512, 256], 'cross': 3}, 'dataset': 'kuairand', 'model': 'DRJL-CTR', 'data_dir': 'data/kuairand/threshold_2', 'cuda': 3, 'source': None}
==================================================
|         DRJL-CTR: Set the random seed          |
==================================================

==================================================
|           DRJL-CTR: Estimate pscore            |
==================================================

==================================================
|               DRJL-CTR: Training               |
==================================================

######### trainer ###########
beta1 0.2220939504768643 lr: 3e-05 l2: 1e-05 bs: 256
  0%|          | 0/5000 [00:00<?, ?it/s]  0%|          | 1/5000 [00:35<48:43:27, 35.09s/it]  0%|          | 2/5000 [01:06<46:05:10, 33.20s/it]  0%|          | 3/5000 [01:37<44:15:00, 31.88s/it]  0%|          | 4/5000 [02:07<43:20:46, 31.23s/it]  0%|          | 5/5000 [02:37<42:36:29, 30.71s/it]  0%|          | 6/5000 [03:08<42:38:38, 30.74s/it]  0%|          | 7/5000 [03:41<43:53:00, 31.64s/it]  0%|          | 8/5000 [04:11<43:17:46, 31.22s/it]  0%|          | 9/5000 [04:42<43:06:31, 31.09s/it]  0%|          | 10/5000 [05:12<42:28:12, 30.64s/it]  0%|          | 11/5000 [05:41<41:54:43, 30.24s/it]  0%|          | 12/5000 [06:11<41:39:50, 30.07s/it]  0%|          | 13/5000 [06:40<41:18:14, 29.82s/it]  0%|          | 14/5000 [07:11<41:44:24, 30.14s/it]  0%|          | 15/5000 [07:42<42:04:19, 30.38s/it]  0%|          | 16/5000 [08:10<41:06:57, 29.70s/it]  0%|          | 17/5000 [08:38<40:34:55, 29.32s/it]  0%|          | 18/5000 [09:07<40:20:58, 29.16s/it]  0%|          | 19/5000 [09:35<39:44:57, 28.73s/it]  0%|          | 19/5000 [10:04<44:00:43, 31.81s/it]
AUC:  0.6507512445845528 LOGlOSS:  1.0077502018029694 test_AUC:  0.6491126170260528 test_LOGlOSS:  1.0109779074800513
Time:  627.8886426750105
{'model_opt': {'latent_dim': 16, 'feat_num': 41388, 'field_num': 88, 'mlp_dropout': 0.0, 'use_bn': False, 'mlp_dims': [1024, 512, 256], 'cross': 3}, 'dataset': 'kuairand', 'model': 'IDIPS-CTR', 'data_dir': 'data/kuairand/threshold_2', 'cuda': 3, 'source': None}
==================================================
|         IDIPS-CTR: Set the random seed         |
==================================================

==================================================
|           IDIPS-CTR: Estimate pscore           |
==================================================

==================================================
|              IDIPS-CTR: Training               |
==================================================

######### trainer ###########
beta1 0.010040511439369466 lr: 3e-05 l2: 0.0003 bs: 1024
  0%|          | 0/5000 [00:00<?, ?it/s]  0%|          | 1/5000 [00:03<4:28:48,  3.23s/it]  0%|          | 2/5000 [00:06<4:36:26,  3.32s/it]  0%|          | 3/5000 [00:10<4:47:53,  3.46s/it]  0%|          | 4/5000 [00:13<4:43:39,  3.41s/it]  0%|          | 5/5000 [00:17<4:50:36,  3.49s/it]  0%|          | 6/5000 [00:20<4:56:35,  3.56s/it]  0%|          | 7/5000 [00:24<4:58:41,  3.59s/it]  0%|          | 8/5000 [00:27<4:30:22,  3.25s/it]  0%|          | 9/5000 [00:29<3:59:18,  2.88s/it]  0%|          | 10/5000 [00:31<3:37:52,  2.62s/it]  0%|          | 11/5000 [00:33<3:23:12,  2.44s/it]  0%|          | 11/5000 [00:35<4:26:25,  3.20s/it]
AUC:  0.655120102531239 LOGlOSS:  0.6452336884408066 test_AUC:  0.6533137612715225 test_LOGlOSS:  0.6460555664584747
Time:  57.88501131196972
{'model_opt': {'latent_dim': 16, 'feat_num': 41388, 'field_num': 88, 'mlp_dropout': 0.0, 'use_bn': False, 'mlp_dims': [1024, 512, 256], 'cross': 3}, 'dataset': 'kuairand', 'model': 'IPS-CTR', 'data_dir': 'data/kuairand/threshold_2', 'cuda': 3, 'source': None}
==================================================
|          IPS-CTR: Set the random seed          |
==================================================

==================================================
|            IPS-CTR: Estimate pscore            |
==================================================

==================================================
|               IPS-CTR: Training                |
==================================================

######### trainer ###########
lr: 3e-05 l2: 3e-05 bs: 256
  0%|          | 0/5000 [00:00<?, ?it/s]  0%|          | 1/5000 [00:10<14:19:29, 10.32s/it]  0%|          | 2/5000 [00:19<13:07:53,  9.46s/it]  0%|          | 3/5000 [00:26<11:54:50,  8.58s/it]  0%|          | 4/5000 [00:34<11:17:51,  8.14s/it]  0%|          | 5/5000 [00:40<10:16:15,  7.40s/it]  0%|          | 6/5000 [00:46<9:38:18,  6.95s/it]   0%|          | 7/5000 [00:52<9:14:52,  6.67s/it]  0%|          | 8/5000 [00:58<8:59:14,  6.48s/it]  0%|          | 8/5000 [01:04<11:10:40,  8.06s/it]
AUC:  0.6556326100531071 LOGlOSS:  0.46406509453624634 test_AUC:  0.6537557806948954 test_LOGlOSS:  0.46598222245536147
Time:  88.3285658910172
{'model_opt': {'latent_dim': 16, 'feat_num': 41388, 'field_num': 88, 'mlp_dropout': 0.0, 'use_bn': False, 'mlp_dims': [1024, 512, 256], 'cross': 3}, 'dataset': 'kuairand', 'model': 'Refine-CTR', 'data_dir': 'data/kuairand/threshold_2', 'cuda': 3, 'source': None}
==================================================
|        Refine-CTR: Set the random seed         |
==================================================

==================================================
|              Refine-CTR: Training              |
==================================================

######### trainer ###########
beta1 0.9848454214166825 lr: 3e-05 l2: 0.0003 bs: 256
  0%|          | 0/5000 [00:00<?, ?it/s]  0%|          | 1/5000 [00:17<23:38:54, 17.03s/it]  0%|          | 2/5000 [00:33<23:27:19, 16.89s/it]  0%|          | 3/5000 [00:50<23:32:24, 16.96s/it]  0%|          | 4/5000 [01:07<23:31:31, 16.95s/it]  0%|          | 5/5000 [01:24<23:31:22, 16.95s/it]  0%|          | 6/5000 [01:41<23:32:04, 16.97s/it]  0%|          | 7/5000 [01:58<23:31:25, 16.96s/it]  0%|          | 8/5000 [02:15<23:30:21, 16.95s/it]  0%|          | 9/5000 [02:32<23:30:53, 16.96s/it]  0%|          | 10/5000 [02:49<23:28:08, 16.93s/it]  0%|          | 11/5000 [03:06<23:29:16, 16.95s/it]  0%|          | 12/5000 [03:23<23:27:46, 16.93s/it]  0%|          | 13/5000 [03:38<22:47:41, 16.46s/it]  0%|          | 14/5000 [03:54<22:22:51, 16.16s/it]  0%|          | 15/5000 [04:08<21:46:21, 15.72s/it]  0%|          | 16/5000 [04:23<21:16:50, 15.37s/it]  0%|          | 17/5000 [04:38<21:08:09, 15.27s/it]  0%|          | 18/5000 [04:53<21:02:57, 15.21s/it]  0%|          | 19/5000 [05:08<20:50:00, 15.06s/it]  0%|          | 20/5000 [05:23<20:45:58, 15.01s/it]  0%|          | 21/5000 [05:38<20:58:42, 15.17s/it]  0%|          | 22/5000 [05:53<20:37:32, 14.92s/it]  0%|          | 23/5000 [06:07<20:26:51, 14.79s/it]  0%|          | 24/5000 [06:21<20:18:02, 14.69s/it]  0%|          | 25/5000 [06:36<20:08:57, 14.58s/it]  1%|          | 26/5000 [06:51<20:25:11, 14.78s/it]  1%|          | 27/5000 [07:05<20:15:55, 14.67s/it]  1%|          | 28/5000 [07:20<20:21:35, 14.74s/it]  1%|          | 29/5000 [07:35<20:23:58, 14.77s/it]  1%|          | 30/5000 [07:50<20:35:37, 14.92s/it]  1%|          | 31/5000 [08:05<20:36:13, 14.93s/it]  1%|          | 32/5000 [08:20<20:32:07, 14.88s/it]  1%|          | 33/5000 [08:35<20:26:16, 14.81s/it]  1%|          | 34/5000 [08:50<20:39:18, 14.97s/it]  1%|          | 35/5000 [09:05<20:30:09, 14.87s/it]  1%|          | 36/5000 [09:19<20:18:26, 14.73s/it]  1%|          | 37/5000 [09:34<20:16:18, 14.70s/it]  1%|          | 38/5000 [09:48<20:11:29, 14.65s/it]  1%|          | 39/5000 [10:03<20:12:45, 14.67s/it]  1%|          | 40/5000 [10:17<20:05:39, 14.58s/it]  1%|          | 41/5000 [10:32<20:08:09, 14.62s/it]  1%|          | 42/5000 [10:47<20:01:46, 14.54s/it]  1%|          | 43/5000 [11:02<20:25:39, 14.84s/it]  1%|          | 44/5000 [11:17<20:39:35, 15.01s/it]  1%|          | 45/5000 [11:33<20:54:08, 15.19s/it]  1%|          | 46/5000 [11:50<21:42:14, 15.77s/it]  1%|          | 47/5000 [12:08<22:21:39, 16.25s/it]  1%|          | 48/5000 [12:24<22:21:24, 16.25s/it]  1%|          | 49/5000 [12:41<22:38:57, 16.47s/it]  1%|          | 50/5000 [12:57<22:41:01, 16.50s/it]  1%|          | 51/5000 [13:14<22:45:04, 16.55s/it]  1%|          | 52/5000 [13:31<22:43:31, 16.53s/it]  1%|          | 53/5000 [13:47<22:46:25, 16.57s/it]  1%|          | 54/5000 [14:04<22:53:07, 16.66s/it]  1%|          | 55/5000 [14:21<23:02:36, 16.78s/it]  1%|          | 56/5000 [14:38<22:54:06, 16.68s/it]  1%|          | 57/5000 [14:54<22:46:15, 16.58s/it]  1%|          | 58/5000 [15:08<21:50:36, 15.91s/it]  1%|          | 59/5000 [15:23<21:15:52, 15.49s/it]  1%|          | 60/5000 [15:37<20:50:04, 15.18s/it]  1%|          | 61/5000 [15:52<20:32:23, 14.97s/it]  1%|          | 62/5000 [16:06<20:14:43, 14.76s/it]  1%|▏         | 63/5000 [16:20<20:01:43, 14.60s/it]  1%|▏         | 64/5000 [16:35<19:55:41, 14.53s/it]  1%|▏         | 65/5000 [16:49<19:49:25, 14.46s/it]  1%|▏         | 66/5000 [17:03<19:44:26, 14.40s/it]  1%|▏         | 67/5000 [17:17<19:40:26, 14.36s/it]  1%|▏         | 68/5000 [17:32<19:37:09, 14.32s/it]  1%|▏         | 69/5000 [17:46<19:36:59, 14.32s/it]  1%|▏         | 70/5000 [18:00<19:38:31, 14.34s/it]  1%|▏         | 71/5000 [18:15<19:37:13, 14.33s/it]  1%|▏         | 72/5000 [18:29<19:36:38, 14.33s/it]  1%|▏         | 73/5000 [18:42<19:06:00, 13.96s/it]  1%|▏         | 74/5000 [18:56<19:13:46, 14.05s/it]  2%|▏         | 75/5000 [19:11<19:20:01, 14.13s/it]  2%|▏         | 76/5000 [19:25<19:23:16, 14.17s/it]  2%|▏         | 77/5000 [19:39<19:25:14, 14.20s/it]  2%|▏         | 78/5000 [19:54<19:27:24, 14.23s/it]  2%|▏         | 79/5000 [20:08<19:28:14, 14.24s/it]  2%|▏         | 80/5000 [20:21<18:59:29, 13.90s/it]  2%|▏         | 81/5000 [20:34<18:41:41, 13.68s/it]  2%|▏         | 82/5000 [20:47<18:26:41, 13.50s/it]  2%|▏         | 83/5000 [21:01<18:46:26, 13.75s/it]  2%|▏         | 84/5000 [21:16<18:59:42, 13.91s/it]  2%|▏         | 85/5000 [21:30<19:09:03, 14.03s/it]  2%|▏         | 86/5000 [21:44<19:15:07, 14.10s/it]  2%|▏         | 87/5000 [21:59<19:19:18, 14.16s/it]  2%|▏         | 88/5000 [22:12<18:52:59, 13.84s/it]  2%|▏         | 89/5000 [22:25<18:34:02, 13.61s/it]  2%|▏         | 90/5000 [22:38<18:20:49, 13.45s/it]  2%|▏         | 91/5000 [22:51<18:14:09, 13.37s/it]  2%|▏         | 92/5000 [23:05<18:37:13, 13.66s/it]  2%|▏         | 93/5000 [23:20<18:52:08, 13.84s/it]  2%|▏         | 94/5000 [23:34<19:02:54, 13.98s/it]  2%|▏         | 95/5000 [23:48<19:10:48, 14.08s/it]  2%|▏         | 96/5000 [24:03<19:15:47, 14.14s/it]  2%|▏         | 97/5000 [24:17<19:18:48, 14.18s/it]  2%|▏         | 98/5000 [24:31<19:21:43, 14.22s/it]  2%|▏         | 99/5000 [24:45<19:23:00, 14.24s/it]  2%|▏         | 100/5000 [25:00<19:23:48, 14.25s/it]  2%|▏         | 101/5000 [25:14<19:25:43, 14.28s/it]  2%|▏         | 102/5000 [25:27<18:58:28, 13.95s/it]  2%|▏         | 103/5000 [25:42<19:06:54, 14.05s/it]  2%|▏         | 104/5000 [25:56<19:12:32, 14.12s/it]  2%|▏         | 105/5000 [26:10<19:16:19, 14.17s/it]  2%|▏         | 106/5000 [26:24<19:18:41, 14.21s/it]  2%|▏         | 107/5000 [26:39<19:20:29, 14.23s/it]  2%|▏         | 108/5000 [26:53<19:22:07, 14.25s/it]  2%|▏         | 109/5000 [27:06<18:53:11, 13.90s/it]  2%|▏         | 110/5000 [27:19<18:32:23, 13.65s/it]  2%|▏         | 111/5000 [27:32<18:18:11, 13.48s/it]  2%|▏         | 112/5000 [27:46<18:37:55, 13.72s/it]  2%|▏         | 113/5000 [28:01<18:55:00, 13.93s/it]  2%|▏         | 114/5000 [28:15<19:03:32, 14.04s/it]  2%|▏         | 115/5000 [28:30<19:10:31, 14.13s/it]  2%|▏         | 116/5000 [28:44<19:14:07, 14.18s/it]  2%|▏         | 117/5000 [28:58<19:16:22, 14.21s/it]  2%|▏         | 118/5000 [29:13<19:20:34, 14.26s/it]  2%|▏         | 119/5000 [29:27<19:22:43, 14.29s/it]  2%|▏         | 120/5000 [29:41<19:23:40, 14.31s/it]  2%|▏         | 121/5000 [29:56<19:23:57, 14.31s/it]  2%|▏         | 122/5000 [30:10<19:23:31, 14.31s/it]  2%|▏         | 123/5000 [30:24<19:22:57, 14.31s/it]  2%|▏         | 124/5000 [30:39<19:26:03, 14.35s/it]  2%|▎         | 125/5000 [30:53<19:30:26, 14.41s/it]  3%|▎         | 126/5000 [31:08<19:33:49, 14.45s/it]  3%|▎         | 127/5000 [31:21<19:04:47, 14.10s/it]  3%|▎         | 128/5000 [31:35<19:14:04, 14.21s/it]  3%|▎         | 129/5000 [31:50<19:20:41, 14.30s/it]  3%|▎         | 130/5000 [32:04<19:25:09, 14.36s/it]  3%|▎         | 131/5000 [32:19<19:28:24, 14.40s/it]  3%|▎         | 132/5000 [32:32<19:00:33, 14.06s/it]  3%|▎         | 133/5000 [32:47<19:10:37, 14.18s/it]  3%|▎         | 134/5000 [33:01<19:18:19, 14.28s/it]  3%|▎         | 135/5000 [33:16<19:19:40, 14.30s/it]  3%|▎         | 136/5000 [33:29<18:53:08, 13.98s/it]  3%|▎         | 137/5000 [33:42<18:33:34, 13.74s/it]  3%|▎         | 138/5000 [33:56<18:48:49, 13.93s/it]  3%|▎         | 139/5000 [34:09<18:29:42, 13.70s/it]  3%|▎         | 140/5000 [34:23<18:16:06, 13.53s/it]  3%|▎         | 141/5000 [34:37<18:36:30, 13.79s/it]  3%|▎         | 142/5000 [34:51<18:50:06, 13.96s/it]  3%|▎         | 143/5000 [35:06<18:59:18, 14.07s/it]  3%|▎         | 144/5000 [35:19<18:36:34, 13.80s/it]  3%|▎         | 145/5000 [35:32<18:20:26, 13.60s/it]  3%|▎         | 146/5000 [35:47<18:48:18, 13.95s/it]  3%|▎         | 147/5000 [36:00<18:42:55, 13.88s/it]  3%|▎         | 148/5000 [36:14<18:38:00, 13.83s/it]  3%|▎         | 149/5000 [36:28<18:30:52, 13.74s/it]  3%|▎         | 150/5000 [36:41<18:25:43, 13.68s/it]  3%|▎         | 150/5000 [36:55<19:53:47, 14.77s/it]
AUC:  0.6953930178379382 LOGlOSS:  1.0409473019435833 test_AUC:  0.6930916533408299 test_LOGlOSS:  1.0402475773953312
Time:  2235.9867437510984
{'model_opt': {'latent_dim': 16, 'feat_num': 41388, 'field_num': 88, 'mlp_dropout': 0.0, 'use_bn': False, 'mlp_dims': [1024, 512, 256], 'cross': 3}, 'dataset': 'kuairand', 'model': 'UDIPS-CTR', 'data_dir': 'data/kuairand/threshold_2', 'cuda': 3, 'source': None}
==================================================
|         UDIPS-CTR: Set the random seed         |
==================================================

==================================================
|           UDIPS-CTR: Estimate pscore           |
==================================================

==================================================
|              UDIPS-CTR: Training               |
==================================================

######### trainer ###########
beta1 0.37058109712812737 lr: 1e-05 l2: 0.001 bs: 256
  0%|          | 0/5000 [00:00<?, ?it/s]  0%|          | 1/5000 [00:09<12:38:29,  9.10s/it]  0%|          | 2/5000 [00:18<12:40:34,  9.13s/it]  0%|          | 3/5000 [00:27<12:42:36,  9.16s/it]  0%|          | 4/5000 [00:36<12:44:52,  9.19s/it]  0%|          | 5/5000 [00:45<12:45:36,  9.20s/it]  0%|          | 6/5000 [00:55<12:46:06,  9.20s/it]  0%|          | 7/5000 [01:04<12:46:34,  9.21s/it]  0%|          | 8/5000 [01:13<12:46:37,  9.21s/it]  0%|          | 9/5000 [01:22<12:45:43,  9.21s/it]  0%|          | 10/5000 [01:32<12:47:03,  9.22s/it]  0%|          | 11/5000 [01:41<12:47:41,  9.23s/it]  0%|          | 12/5000 [01:50<12:48:10,  9.24s/it]  0%|          | 13/5000 [01:58<12:17:25,  8.87s/it]  0%|          | 14/5000 [02:06<11:55:42,  8.61s/it]  0%|          | 15/5000 [02:14<11:41:02,  8.44s/it]  0%|          | 16/5000 [02:22<11:27:32,  8.28s/it]  0%|          | 16/5000 [02:30<13:01:04,  9.40s/it]
AUC:  0.6563123340726489  LOGlOSS:  0.6458066600987159 test_AUC:  0.6545311630362766 test_LOGlOSS:  0.6464536371146495
Time:  176.89914903207682
{'model_opt': {'latent_dim': 16, 'feat_num': 41388, 'field_num': 88, 'mlp_dropout': 0.0, 'use_bn': False, 'mlp_dims': [1024, 512, 256], 'cross': 3}, 'dataset': 'kuairand', 'model': 'bias_BASE-CTR', 'data_dir': 'data/kuairand/threshold_2', 'cuda': 3, 'source': 'bias'}
==================================================
|         BASE-CTR: Set the random seed          |
==================================================

==================================================
|               BASE-CTR: Training               |
==================================================

######### trainer ###########
lr: 3e-05 l2: 0.001 bs: 512
  0%|          | 0/5000 [00:00<?, ?it/s]  0%|          | 1/5000 [00:04<6:56:19,  5.00s/it]  0%|          | 2/5000 [00:09<6:54:55,  4.98s/it]  0%|          | 3/5000 [00:14<6:54:51,  4.98s/it]  0%|          | 4/5000 [00:19<6:54:54,  4.98s/it]  0%|          | 5/5000 [00:24<6:54:34,  4.98s/it]  0%|          | 6/5000 [00:29<6:54:18,  4.98s/it]  0%|          | 7/5000 [00:34<6:53:49,  4.97s/it]  0%|          | 8/5000 [00:38<6:23:40,  4.61s/it]  0%|          | 9/5000 [00:42<6:03:40,  4.37s/it]  0%|          | 10/5000 [00:46<5:51:06,  4.22s/it]  0%|          | 11/5000 [00:50<5:41:25,  4.11s/it]  0%|          | 11/5000 [00:54<6:49:09,  4.92s/it]
AUC:  0.6563925783520808 LOGlOSS:  0.6522634568277419 test_AUC:  0.6546339806672596 test_LOGlOSS:  0.652807247101487
Time:  76.26231997506693
{'model_opt': {'latent_dim': 16, 'feat_num': 41388, 'field_num': 88, 'mlp_dropout': 0.0, 'use_bn': False, 'mlp_dims': [1024, 512, 256], 'cross': 3}, 'dataset': 'kuairand', 'model': 'combine_BASE-CTR', 'data_dir': 'data/kuairand/threshold_2', 'cuda': 3, 'source': 'combine'}
==================================================
|         BASE-CTR: Set the random seed          |
==================================================

==================================================
|               BASE-CTR: Training               |
==================================================

######### trainer ###########
lr: 1e-05 l2: 0.001 bs: 256
  0%|          | 0/5000 [00:00<?, ?it/s]  0%|          | 1/5000 [00:12<16:42:43, 12.04s/it]  0%|          | 2/5000 [00:24<16:40:48, 12.01s/it]  0%|          | 3/5000 [00:36<16:40:22, 12.01s/it]  0%|          | 4/5000 [00:48<16:39:26, 12.00s/it]  0%|          | 5/5000 [00:59<16:35:06, 11.95s/it]  0%|          | 6/5000 [01:11<16:34:37, 11.95s/it]  0%|          | 7/5000 [01:23<16:33:30, 11.94s/it]  0%|          | 8/5000 [01:35<16:32:59, 11.93s/it]  0%|          | 9/5000 [01:47<16:31:03, 11.91s/it]  0%|          | 10/5000 [01:59<16:26:22, 11.86s/it]  0%|          | 11/5000 [02:10<16:17:59, 11.76s/it]  0%|          | 12/5000 [02:22<16:12:02, 11.69s/it]  0%|          | 13/5000 [02:33<16:07:17, 11.64s/it]  0%|          | 14/5000 [02:45<16:03:13, 11.59s/it]  0%|          | 15/5000 [02:56<16:03:41, 11.60s/it]  0%|          | 16/5000 [03:08<16:11:29, 11.70s/it]  0%|          | 17/5000 [03:20<16:14:36, 11.74s/it]  0%|          | 18/5000 [03:32<16:18:16, 11.78s/it]  0%|          | 19/5000 [03:44<16:19:37, 11.80s/it]  0%|          | 20/5000 [03:56<16:21:56, 11.83s/it]  0%|          | 21/5000 [04:08<16:23:16, 11.85s/it]  0%|          | 22/5000 [04:20<16:24:06, 11.86s/it]  0%|          | 23/5000 [04:32<16:23:55, 11.86s/it]  0%|          | 24/5000 [04:43<16:25:07, 11.88s/it]  0%|          | 25/5000 [04:55<16:25:20, 11.88s/it]  1%|          | 26/5000 [05:07<16:25:15, 11.88s/it]  1%|          | 27/5000 [05:19<16:20:52, 11.83s/it]  1%|          | 28/5000 [05:31<16:25:31, 11.89s/it]  1%|          | 29/5000 [05:43<16:28:34, 11.93s/it]  1%|          | 30/5000 [05:55<16:28:13, 11.93s/it]  1%|          | 31/5000 [06:07<16:27:22, 11.92s/it]  1%|          | 32/5000 [06:19<16:28:13, 11.94s/it]  1%|          | 33/5000 [06:31<16:26:50, 11.92s/it]  1%|          | 34/5000 [06:42<16:17:28, 11.81s/it]  1%|          | 35/5000 [06:54<16:22:16, 11.87s/it]  1%|          | 36/5000 [07:06<16:26:59, 11.93s/it]  1%|          | 37/5000 [07:18<16:30:56, 11.98s/it]  1%|          | 38/5000 [07:30<16:31:31, 11.99s/it]  1%|          | 39/5000 [07:42<16:30:16, 11.98s/it]  1%|          | 40/5000 [07:54<16:29:58, 11.98s/it]  1%|          | 41/5000 [08:06<16:27:53, 11.95s/it]  1%|          | 42/5000 [08:18<16:27:24, 11.95s/it]  1%|          | 43/5000 [08:30<16:28:59, 11.97s/it]  1%|          | 44/5000 [08:42<16:30:30, 11.99s/it]  1%|          | 45/5000 [08:54<16:30:50, 12.00s/it]  1%|          | 46/5000 [09:06<16:31:51, 12.01s/it]  1%|          | 47/5000 [09:18<16:31:43, 12.01s/it]  1%|          | 48/5000 [09:30<16:30:22, 12.00s/it]  1%|          | 49/5000 [09:42<16:29:09, 11.99s/it]  1%|          | 50/5000 [09:54<16:27:59, 11.98s/it]  1%|          | 51/5000 [10:06<16:19:18, 11.87s/it]  1%|          | 52/5000 [10:18<16:19:47, 11.88s/it]  1%|          | 53/5000 [10:30<16:24:32, 11.94s/it]  1%|          | 54/5000 [10:42<16:28:00, 11.99s/it]  1%|          | 55/5000 [10:54<16:29:58, 12.01s/it]  1%|          | 56/5000 [11:06<16:32:16, 12.04s/it]  1%|          | 57/5000 [11:18<16:32:45, 12.05s/it]  1%|          | 58/5000 [11:30<16:33:31, 12.06s/it]  1%|          | 59/5000 [11:42<16:33:46, 12.07s/it]  1%|          | 60/5000 [11:54<16:34:22, 12.08s/it]  1%|          | 61/5000 [12:06<16:33:22, 12.07s/it]  1%|          | 62/5000 [12:19<16:33:12, 12.07s/it]  1%|▏         | 63/5000 [12:31<16:33:04, 12.07s/it]  1%|▏         | 64/5000 [12:43<16:34:23, 12.09s/it]  1%|▏         | 65/5000 [12:55<16:34:29, 12.09s/it]  1%|▏         | 66/5000 [13:07<16:33:42, 12.08s/it]  1%|▏         | 67/5000 [13:19<16:33:42, 12.09s/it]  1%|▏         | 68/5000 [13:31<16:32:17, 12.07s/it]  1%|▏         | 69/5000 [13:43<16:30:48, 12.06s/it]  1%|▏         | 70/5000 [13:55<16:29:38, 12.04s/it]  1%|▏         | 71/5000 [14:07<16:30:09, 12.05s/it]  1%|▏         | 72/5000 [14:19<16:29:28, 12.05s/it]  1%|▏         | 73/5000 [14:31<16:29:24, 12.05s/it]  1%|▏         | 74/5000 [14:43<16:29:25, 12.05s/it]  2%|▏         | 75/5000 [14:55<16:29:21, 12.05s/it]  2%|▏         | 76/5000 [15:07<16:27:23, 12.03s/it]  2%|▏         | 77/5000 [15:18<15:51:36, 11.60s/it]  2%|▏         | 78/5000 [15:29<15:27:14, 11.30s/it]  2%|▏         | 79/5000 [15:39<15:10:14, 11.10s/it]  2%|▏         | 80/5000 [15:50<14:57:38, 10.95s/it]  2%|▏         | 80/5000 [16:00<16:25:00, 12.01s/it]
AUC:  0.7028176782384437 LOGlOSS:  0.45720286427934054 test_AUC:  0.7004745949650922 test_LOGlOSS:  0.46041610286693657
Time:  986.5335234439699
{'model_opt': {'latent_dim': 16, 'feat_num': 41388, 'field_num': 88, 'mlp_dropout': 0.0, 'use_bn': False, 'mlp_dims': [1024, 512, 256], 'cross': 3}, 'dataset': 'kuairand', 'model': 'unif_BASE-CTR', 'data_dir': 'data/kuairand/threshold_2', 'cuda': 3, 'source': 'unif'}
==================================================
|         BASE-CTR: Set the random seed          |
==================================================

==================================================
|               BASE-CTR: Training               |
==================================================

######### trainer ###########
lr: 3e-05 l2: 0.001 bs: 1024
  0%|          | 0/5000 [00:00<?, ?it/s]  0%|          | 1/5000 [00:02<2:51:28,  2.06s/it]  0%|          | 2/5000 [00:04<2:49:01,  2.03s/it]  0%|          | 3/5000 [00:06<2:47:31,  2.01s/it]  0%|          | 4/5000 [00:08<2:47:16,  2.01s/it]  0%|          | 5/5000 [00:10<2:47:39,  2.01s/it]  0%|          | 6/5000 [00:12<2:47:32,  2.01s/it]  0%|          | 7/5000 [00:14<2:47:24,  2.01s/it]  0%|          | 8/5000 [00:16<2:47:19,  2.01s/it]  0%|          | 9/5000 [00:18<2:47:27,  2.01s/it]  0%|          | 10/5000 [00:20<2:47:31,  2.01s/it]  0%|          | 11/5000 [00:22<2:47:50,  2.02s/it]  0%|          | 12/5000 [00:24<2:48:05,  2.02s/it]  0%|          | 13/5000 [00:26<2:48:33,  2.03s/it]  0%|          | 14/5000 [00:28<2:48:41,  2.03s/it]  0%|          | 15/5000 [00:29<2:20:23,  1.69s/it]  0%|          | 16/5000 [00:30<2:00:28,  1.45s/it]  0%|          | 17/5000 [00:30<1:46:34,  1.28s/it]  0%|          | 18/5000 [00:31<1:37:09,  1.17s/it]  0%|          | 18/5000 [00:32<2:31:10,  1.82s/it]
AUC:  0.6936484997841761 LOGlOSS:  0.440562143719752 test_AUC:  0.6925686304097034 test_LOGlOSS:  0.44287782913594537
Time:  54.34923081693705
