nohup: ignoring input
2024-07-25 09:05:54.662815: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2024-07-25 09:05:57.632722: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-07-25 09:05:57.632859: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-07-25 09:05:57.633535: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:20:00.0 name: Tesla V100-SXM2-32GB computeCapability: 7.0
coreClock: 1.53GHz coreCount: 80 deviceMemorySize: 31.74GiB deviceMemoryBandwidth: 836.37GiB/s
2024-07-25 09:05:57.633574: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2024-07-25 09:05:57.633629: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2024-07-25 09:05:57.633654: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2024-07-25 09:05:57.667389: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-07-25 09:05:57.667835: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-07-25 09:05:57.667976: W tensorflow/stream_executor/platform/default/dso_loader.cc:60] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /lib/x86_64-linux-gnu:/usr/lib/x86_64-linux-gnu::/usr/local/cuda-11.7/lib64
2024-07-25 09:05:57.668877: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2024-07-25 09:05:57.668949: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2024-07-25 09:05:57.668961: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1757] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2024-07-25 09:05:57.669363: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX512F
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-07-25 09:05:57.674573: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-07-25 09:05:57.674609: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-07-25 09:05:57.674618: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      
2024-07-25 09:05:57.733653: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-07-25 09:05:57.752652: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2500000000 Hz
{'model_opt': {'latent_dim': 16, 'feat_num': 647, 'field_num': 10, 'mlp_dropout': 0.0, 'use_bn': False, 'mlp_dims': [1024, 512, 256], 'cross': 3}, 'dataset': 'coat', 'model': 'TJR-CTR', 'data_dir': 'data/coat/tfrecord', 'cuda': 3, 'source': None}
==================================================
|          TJR-CTR: Set the random seed          |
==================================================

==================================================
|               TJR-CTR: Training                |
==================================================

######### trainer ###########
alpha1 0.08260550505502874 alpha2 0.3 lr: 0.0003 l2: 0.0003 bs: 16
  0%|          | 0/5000 [00:00<?, ?it/s]  0%|          | 1/5000 [00:06<8:41:55,  6.26s/it]  0%|          | 2/5000 [00:11<8:08:31,  5.86s/it]  0%|          | 3/5000 [00:17<7:57:28,  5.73s/it]  0%|          | 4/5000 [00:23<7:52:24,  5.67s/it]  0%|          | 5/5000 [00:28<7:49:17,  5.64s/it]  0%|          | 6/5000 [00:34<7:47:13,  5.61s/it]  0%|          | 7/5000 [00:39<7:46:04,  5.60s/it]  0%|          | 8/5000 [00:45<7:45:26,  5.59s/it]  0%|          | 9/5000 [00:50<7:44:44,  5.59s/it]  0%|          | 10/5000 [00:56<7:44:28,  5.58s/it]  0%|          | 11/5000 [01:01<7:43:08,  5.57s/it]  0%|          | 12/5000 [01:07<7:43:34,  5.58s/it]  0%|          | 13/5000 [01:13<7:43:07,  5.57s/it]  0%|          | 14/5000 [01:18<7:42:26,  5.56s/it]  0%|          | 15/5000 [01:24<7:52:19,  5.69s/it]  0%|          | 16/5000 [01:30<8:02:43,  5.81s/it]  0%|          | 17/5000 [01:36<7:56:29,  5.74s/it]  0%|          | 18/5000 [01:41<7:52:07,  5.69s/it]  0%|          | 19/5000 [01:47<7:45:48,  5.61s/it]  0%|          | 19/5000 [01:52<8:12:27,  5.93s/it]
AUC:  0.8036783854166667 LOGlOSS:  0.39434279892377744 test_AUC:  0.7497397618503567 test_LOGlOSS:  0.4722169833320385
Time:  115.2738605249906
{'model_opt': {'latent_dim': 16, 'feat_num': 647, 'field_num': 10, 'mlp_dropout': 0.0, 'use_bn': False, 'mlp_dims': [1024, 512, 256], 'cross': 3}, 'dataset': 'coat', 'model': 'Bridge-CTR', 'data_dir': 'data/coat/tfrecord', 'cuda': 3, 'source': None}
==================================================
|        Bridge-CTR: Set the random seed         |
==================================================

==================================================
|              Bridge-CTR: Training              |
==================================================

######### trainer ###########
alpha1 1 lr: 0.0003 l2: 0.0003 bs: 16
  0%|          | 0/5000 [00:00<?, ?it/s]  0%|          | 1/5000 [00:05<7:06:50,  5.12s/it]  0%|          | 2/5000 [00:10<6:56:47,  5.00s/it]  0%|          | 3/5000 [00:15<6:57:37,  5.01s/it]  0%|          | 4/5000 [00:20<6:58:07,  5.02s/it]  0%|          | 5/5000 [00:25<6:57:30,  5.02s/it]  0%|          | 5/5000 [00:30<8:20:15,  6.01s/it]
AUC:  0.8041341145833334 LOGlOSS:  0.36850367513244414 test_AUC:  0.7387386222156433 test_LOGlOSS:  0.42759961359930193
Time:  30.519607402966358
{'model_opt': {'latent_dim': 16, 'feat_num': 647, 'field_num': 10, 'mlp_dropout': 0.0, 'use_bn': True, 'mlp_dims': [1024, 512, 256], 'cross': 3}, 'dataset': 'coat', 'model': 'CausE-CTR', 'data_dir': 'data/coat/tfrecord', 'cuda': 3, 'source': None}
==================================================
|         CausE-CTR: Set the random seed         |
==================================================

==================================================
|              CausE-CTR: Training               |
==================================================

######### trainer ###########
alpha1 1 lr: 3e-05 l2: 0.001 bs: 16
  0%|          | 0/5000 [00:00<?, ?it/s]  0%|          | 1/5000 [00:02<3:02:27,  2.19s/it]  0%|          | 2/5000 [00:04<3:02:46,  2.19s/it]  0%|          | 3/5000 [00:06<3:06:16,  2.24s/it]  0%|          | 4/5000 [00:09<3:11:18,  2.30s/it]  0%|          | 5/5000 [00:11<3:13:13,  2.32s/it]  0%|          | 6/5000 [00:13<3:15:00,  2.34s/it]  0%|          | 7/5000 [00:16<3:12:06,  2.31s/it]  0%|          | 8/5000 [00:18<3:09:24,  2.28s/it]  0%|          | 9/5000 [00:20<3:07:39,  2.26s/it]  0%|          | 10/5000 [00:22<3:07:57,  2.26s/it]  0%|          | 11/5000 [00:24<3:06:54,  2.25s/it]  0%|          | 12/5000 [00:27<3:10:41,  2.29s/it]  0%|          | 13/5000 [00:29<3:11:56,  2.31s/it]  0%|          | 14/5000 [00:32<3:12:34,  2.32s/it]  0%|          | 15/5000 [00:34<3:13:26,  2.33s/it]  0%|          | 16/5000 [00:36<3:12:45,  2.32s/it]  0%|          | 17/5000 [00:39<3:13:13,  2.33s/it]  0%|          | 18/5000 [00:41<3:13:22,  2.33s/it]  0%|          | 19/5000 [00:43<3:13:28,  2.33s/it]  0%|          | 20/5000 [00:46<3:13:26,  2.33s/it]  0%|          | 21/5000 [00:48<3:19:55,  2.41s/it]  0%|          | 22/5000 [00:51<3:31:38,  2.55s/it]  0%|          | 23/5000 [00:54<3:50:40,  2.78s/it]  0%|          | 24/5000 [00:57<4:00:01,  2.89s/it]  0%|          | 25/5000 [01:00<3:50:08,  2.78s/it]  1%|          | 26/5000 [01:02<3:39:14,  2.64s/it]  1%|          | 27/5000 [01:05<3:31:48,  2.56s/it]  1%|          | 28/5000 [01:07<3:26:32,  2.49s/it]  1%|          | 29/5000 [01:09<3:22:22,  2.44s/it]  1%|          | 30/5000 [01:12<3:19:37,  2.41s/it]  1%|          | 31/5000 [01:14<3:19:45,  2.41s/it]  1%|          | 32/5000 [01:17<3:20:39,  2.42s/it]  1%|          | 33/5000 [01:19<3:21:15,  2.43s/it]  1%|          | 34/5000 [01:21<3:21:23,  2.43s/it]  1%|          | 35/5000 [01:24<3:21:40,  2.44s/it]  1%|          | 36/5000 [01:26<3:21:54,  2.44s/it]  1%|          | 37/5000 [01:29<3:21:34,  2.44s/it]  1%|          | 38/5000 [01:31<3:21:09,  2.43s/it]  1%|          | 39/5000 [01:34<3:26:06,  2.49s/it]  1%|          | 40/5000 [01:36<3:22:41,  2.45s/it]  1%|          | 41/5000 [01:38<3:19:21,  2.41s/it]  1%|          | 42/5000 [01:41<3:16:57,  2.38s/it]  1%|          | 43/5000 [01:43<3:16:29,  2.38s/it]  1%|          | 44/5000 [01:46<3:16:16,  2.38s/it]  1%|          | 45/5000 [01:48<3:15:15,  2.36s/it]  1%|          | 46/5000 [01:50<3:15:14,  2.36s/it]  1%|          | 47/5000 [01:52<3:12:19,  2.33s/it]  1%|          | 48/5000 [01:55<3:07:33,  2.27s/it]  1%|          | 49/5000 [01:57<3:07:33,  2.27s/it]  1%|          | 50/5000 [01:59<3:05:49,  2.25s/it]  1%|          | 51/5000 [02:01<3:03:11,  2.22s/it]  1%|          | 52/5000 [02:03<3:01:16,  2.20s/it]  1%|          | 53/5000 [02:06<3:00:27,  2.19s/it]  1%|          | 54/5000 [02:08<3:01:24,  2.20s/it]  1%|          | 54/5000 [02:10<3:19:27,  2.42s/it]
AUC:  0.8024739583333332 LOGlOSS:  0.38104415797766433 test_AUC:  0.7191516595601173 test_LOGlOSS:  0.47380383595534886
Time:  131.18306784390006
{'model_opt': {'latent_dim': 16, 'feat_num': 647, 'field_num': 10, 'mlp_dropout': 0.0, 'use_bn': True, 'mlp_dims': [1024, 512, 256], 'cross': 3}, 'dataset': 'coat', 'model': 'DR-CTR', 'data_dir': 'data/coat/tfrecord', 'cuda': 3, 'source': None}
==================================================
|          DR-CTR: Set the random seed           |
==================================================

==================================================
|            DR-CTR: Estimate pscore             |
==================================================

==================================================
|                DR-CTR: Training                |
==================================================

######### trainer ###########
beta1 0.0455601166186279 lr: 0.0003 l2: 0.001 bs: 64
  0%|          | 0/5000 [00:00<?, ?it/s]  0%|          | 1/5000 [00:01<2:45:17,  1.98s/it]  0%|          | 2/5000 [00:03<2:39:41,  1.92s/it]  0%|          | 3/5000 [00:05<2:29:43,  1.80s/it]  0%|          | 4/5000 [00:07<2:28:41,  1.79s/it]  0%|          | 5/5000 [00:08<2:25:06,  1.74s/it]  0%|          | 6/5000 [00:10<2:22:11,  1.71s/it]  0%|          | 7/5000 [00:12<2:25:48,  1.75s/it]  0%|          | 8/5000 [00:14<2:23:24,  1.72s/it]  0%|          | 9/5000 [00:15<2:22:16,  1.71s/it]  0%|          | 10/5000 [00:17<2:22:05,  1.71s/it]  0%|          | 11/5000 [00:19<2:23:28,  1.73s/it]  0%|          | 12/5000 [00:21<2:24:40,  1.74s/it]  0%|          | 13/5000 [00:22<2:25:19,  1.75s/it]  0%|          | 14/5000 [00:24<2:25:42,  1.75s/it]  0%|          | 15/5000 [00:26<2:26:01,  1.76s/it]  0%|          | 16/5000 [00:28<2:25:48,  1.76s/it]  0%|          | 17/5000 [00:29<2:25:54,  1.76s/it]  0%|          | 18/5000 [00:31<2:26:28,  1.76s/it]  0%|          | 19/5000 [00:33<2:25:55,  1.76s/it]  0%|          | 20/5000 [00:35<2:25:50,  1.76s/it]  0%|          | 21/5000 [00:36<2:25:23,  1.75s/it]  0%|          | 22/5000 [00:38<2:25:19,  1.75s/it]  0%|          | 22/5000 [00:40<2:32:06,  1.83s/it]
AUC:  0.7897786458333332 LOGlOSS:  0.3905881425500933 test_AUC:  0.7542954264672139 test_LOGlOSS:  0.43648917014191785
Time:  40.816501958994195
{'model_opt': {'latent_dim': 16, 'feat_num': 647, 'field_num': 10, 'mlp_dropout': 0.0, 'use_bn': False, 'mlp_dims': [1024, 512, 256], 'cross': 3}, 'dataset': 'coat', 'model': 'DRJL-CTR', 'data_dir': 'data/coat/tfrecord', 'cuda': 3, 'source': None}
==================================================
|         DRJL-CTR: Set the random seed          |
==================================================

==================================================
|           DRJL-CTR: Estimate pscore            |
==================================================

==================================================
|               DRJL-CTR: Training               |
==================================================

######### trainer ###########
beta1 0.8040393564790893 lr: 3e-05 l2: 0.001 bs: 64
  0%|          | 0/5000 [00:00<?, ?it/s]  0%|          | 1/5000 [00:02<2:57:08,  2.13s/it]  0%|          | 2/5000 [00:04<2:58:13,  2.14s/it]  0%|          | 3/5000 [00:06<2:57:44,  2.13s/it]  0%|          | 4/5000 [00:08<3:00:26,  2.17s/it]  0%|          | 5/5000 [00:10<3:01:07,  2.18s/it]  0%|          | 6/5000 [00:12<2:58:50,  2.15s/it]  0%|          | 7/5000 [00:15<2:59:29,  2.16s/it]  0%|          | 8/5000 [00:17<2:58:52,  2.15s/it]  0%|          | 9/5000 [00:19<2:57:54,  2.14s/it]  0%|          | 10/5000 [00:21<2:57:34,  2.14s/it]  0%|          | 11/5000 [00:23<2:57:14,  2.13s/it]  0%|          | 12/5000 [00:25<2:57:16,  2.13s/it]  0%|          | 13/5000 [00:27<2:59:41,  2.16s/it]  0%|          | 14/5000 [00:29<2:55:18,  2.11s/it]  0%|          | 15/5000 [00:32<2:56:07,  2.12s/it]  0%|          | 16/5000 [00:34<2:55:39,  2.11s/it]  0%|          | 17/5000 [00:36<2:55:06,  2.11s/it]  0%|          | 18/5000 [00:38<2:56:25,  2.12s/it]  0%|          | 19/5000 [00:40<3:02:00,  2.19s/it]  0%|          | 20/5000 [00:42<2:48:33,  2.03s/it]  0%|          | 21/5000 [00:43<2:31:20,  1.82s/it]  0%|          | 22/5000 [00:45<2:38:47,  1.91s/it]  0%|          | 23/5000 [00:48<2:47:07,  2.01s/it]  0%|          | 24/5000 [00:49<2:31:22,  1.83s/it]  0%|          | 25/5000 [00:50<2:19:24,  1.68s/it]  1%|          | 26/5000 [00:52<2:17:37,  1.66s/it]  1%|          | 27/5000 [00:54<2:30:27,  1.82s/it]  1%|          | 28/5000 [00:56<2:29:00,  1.80s/it]  1%|          | 29/5000 [00:57<2:17:47,  1.66s/it]  1%|          | 30/5000 [00:59<2:10:24,  1.57s/it]  1%|          | 31/5000 [01:00<2:04:39,  1.51s/it]  1%|          | 32/5000 [01:02<2:06:56,  1.53s/it]  1%|          | 33/5000 [01:03<2:07:08,  1.54s/it]  1%|          | 34/5000 [01:05<2:06:31,  1.53s/it]  1%|          | 35/5000 [01:06<2:11:20,  1.59s/it]  1%|          | 36/5000 [01:08<2:10:49,  1.58s/it]  1%|          | 37/5000 [01:09<2:06:12,  1.53s/it]  1%|          | 38/5000 [01:11<2:11:32,  1.59s/it]  1%|          | 39/5000 [01:13<2:25:51,  1.76s/it]  1%|          | 40/5000 [01:15<2:36:50,  1.90s/it]  1%|          | 41/5000 [01:18<2:45:40,  2.00s/it]  1%|          | 42/5000 [01:20<2:47:39,  2.03s/it]  1%|          | 43/5000 [01:22<2:50:22,  2.06s/it]  1%|          | 44/5000 [01:24<2:51:54,  2.08s/it]  1%|          | 45/5000 [01:26<2:54:01,  2.11s/it]  1%|          | 46/5000 [01:28<2:57:29,  2.15s/it]  1%|          | 47/5000 [01:31<3:00:10,  2.18s/it]  1%|          | 48/5000 [01:33<2:52:11,  2.09s/it]  1%|          | 49/5000 [01:35<2:50:57,  2.07s/it]  1%|          | 50/5000 [01:37<2:51:54,  2.08s/it]  1%|          | 51/5000 [01:39<2:52:21,  2.09s/it]  1%|          | 52/5000 [01:41<2:50:30,  2.07s/it]  1%|          | 53/5000 [01:43<2:51:26,  2.08s/it]  1%|          | 54/5000 [01:45<2:52:03,  2.09s/it]  1%|          | 55/5000 [01:47<2:50:14,  2.07s/it]  1%|          | 56/5000 [01:49<2:55:10,  2.13s/it]  1%|          | 57/5000 [01:52<2:56:11,  2.14s/it]  1%|          | 58/5000 [01:54<2:55:37,  2.13s/it]  1%|          | 59/5000 [01:56<2:54:55,  2.12s/it]  1%|          | 60/5000 [01:58<2:53:45,  2.11s/it]  1%|          | 61/5000 [02:00<2:51:13,  2.08s/it]  1%|          | 62/5000 [02:02<2:54:16,  2.12s/it]  1%|▏         | 63/5000 [02:04<2:57:17,  2.15s/it]  1%|▏         | 64/5000 [02:06<2:55:31,  2.13s/it]  1%|▏         | 65/5000 [02:08<2:54:46,  2.12s/it]  1%|▏         | 66/5000 [02:11<2:54:41,  2.12s/it]  1%|▏         | 67/5000 [02:13<2:54:46,  2.13s/it]  1%|▏         | 68/5000 [02:15<2:52:38,  2.10s/it]  1%|▏         | 69/5000 [02:17<2:56:02,  2.14s/it]  1%|▏         | 70/5000 [02:19<2:56:11,  2.14s/it]  1%|▏         | 71/5000 [02:21<2:55:09,  2.13s/it]  1%|▏         | 72/5000 [02:23<2:37:37,  1.92s/it]  1%|▏         | 73/5000 [02:25<2:40:53,  1.96s/it]  1%|▏         | 74/5000 [02:27<2:43:52,  2.00s/it]  2%|▏         | 75/5000 [02:29<2:46:29,  2.03s/it]  2%|▏         | 76/5000 [02:31<2:47:39,  2.04s/it]  2%|▏         | 77/5000 [02:33<2:49:58,  2.07s/it]  2%|▏         | 78/5000 [02:35<2:51:30,  2.09s/it]  2%|▏         | 79/5000 [02:37<2:49:10,  2.06s/it]  2%|▏         | 80/5000 [02:39<2:49:49,  2.07s/it]  2%|▏         | 81/5000 [02:41<2:51:03,  2.09s/it]  2%|▏         | 82/5000 [02:44<2:51:29,  2.09s/it]  2%|▏         | 83/5000 [02:45<2:42:30,  1.98s/it]  2%|▏         | 84/5000 [02:47<2:32:40,  1.86s/it]  2%|▏         | 84/5000 [02:49<2:44:56,  2.01s/it]
AUC:  0.7564127604166667 LOGlOSS:  0.43760352156227544 test_AUC:  0.7445254180696533 test_LOGlOSS:  0.46657574050946937
Time:  169.55770856910385
{'model_opt': {'latent_dim': 16, 'feat_num': 647, 'field_num': 10, 'mlp_dropout': 0.0, 'use_bn': False, 'mlp_dims': [1024, 512, 256], 'cross': 3}, 'dataset': 'coat', 'model': 'IDIPS-CTR', 'data_dir': 'data/coat/tfrecord', 'cuda': 3, 'source': None}
==================================================
|         IDIPS-CTR: Set the random seed         |
==================================================

==================================================
|           IDIPS-CTR: Estimate pscore           |
==================================================

==================================================
|              IDIPS-CTR: Training               |
==================================================

######### trainer ###########
beta1 0.12817622166198217 lr: 3e-05 l2: 0.001 bs: 16
  0%|          | 0/5000 [00:00<?, ?it/s]  0%|          | 1/5000 [00:02<3:06:31,  2.24s/it]  0%|          | 2/5000 [00:04<2:59:58,  2.16s/it]  0%|          | 3/5000 [00:06<2:59:15,  2.15s/it]  0%|          | 4/5000 [00:08<2:59:58,  2.16s/it]  0%|          | 5/5000 [00:10<2:57:18,  2.13s/it]  0%|          | 6/5000 [00:12<2:57:01,  2.13s/it]  0%|          | 7/5000 [00:14<2:51:37,  2.06s/it]  0%|          | 8/5000 [00:16<2:45:47,  1.99s/it]  0%|          | 9/5000 [00:18<2:48:59,  2.03s/it]  0%|          | 10/5000 [00:20<2:43:42,  1.97s/it]  0%|          | 11/5000 [00:22<2:38:45,  1.91s/it]  0%|          | 12/5000 [00:24<2:35:50,  1.87s/it]  0%|          | 13/5000 [00:25<2:31:33,  1.82s/it]  0%|          | 14/5000 [00:27<2:29:54,  1.80s/it]  0%|          | 15/5000 [00:29<2:33:06,  1.84s/it]  0%|          | 16/5000 [00:31<2:30:01,  1.81s/it]  0%|          | 17/5000 [00:32<2:28:03,  1.78s/it]  0%|          | 18/5000 [00:34<2:32:08,  1.83s/it]  0%|          | 19/5000 [00:36<2:34:59,  1.87s/it]  0%|          | 20/5000 [00:38<2:31:33,  1.83s/it]  0%|          | 21/5000 [00:40<2:33:52,  1.85s/it]  0%|          | 22/5000 [00:42<2:36:39,  1.89s/it]  0%|          | 23/5000 [00:44<2:36:27,  1.89s/it]  0%|          | 24/5000 [00:46<2:36:15,  1.88s/it]  0%|          | 25/5000 [00:48<2:44:07,  1.98s/it]  1%|          | 26/5000 [00:50<2:39:49,  1.93s/it]  1%|          | 27/5000 [00:52<2:47:37,  2.02s/it]  1%|          | 28/5000 [00:54<2:50:31,  2.06s/it]  1%|          | 29/5000 [00:57<2:57:38,  2.14s/it]  1%|          | 30/5000 [00:59<2:59:25,  2.17s/it]  1%|          | 31/5000 [01:01<2:49:48,  2.05s/it]  1%|          | 32/5000 [01:02<2:45:21,  2.00s/it]  1%|          | 33/5000 [01:04<2:40:23,  1.94s/it]  1%|          | 34/5000 [01:06<2:35:20,  1.88s/it]  1%|          | 35/5000 [01:08<2:32:48,  1.85s/it]  1%|          | 36/5000 [01:09<2:30:51,  1.82s/it]  1%|          | 37/5000 [01:11<2:28:56,  1.80s/it]  1%|          | 38/5000 [01:13<2:28:27,  1.80s/it]  1%|          | 39/5000 [01:15<2:33:05,  1.85s/it]  1%|          | 40/5000 [01:17<2:30:37,  1.82s/it]  1%|          | 41/5000 [01:18<2:28:51,  1.80s/it]  1%|          | 42/5000 [01:20<2:29:22,  1.81s/it]  1%|          | 43/5000 [01:22<2:30:06,  1.82s/it]  1%|          | 44/5000 [01:24<2:28:00,  1.79s/it]  1%|          | 45/5000 [01:26<2:27:24,  1.79s/it]  1%|          | 46/5000 [01:27<2:26:27,  1.77s/it]  1%|          | 47/5000 [01:30<2:38:08,  1.92s/it]  1%|          | 48/5000 [01:32<2:54:11,  2.11s/it]  1%|          | 49/5000 [01:35<3:02:11,  2.21s/it]  1%|          | 50/5000 [01:37<3:08:09,  2.28s/it]  1%|          | 51/5000 [01:39<3:00:05,  2.18s/it]  1%|          | 52/5000 [01:41<2:54:56,  2.12s/it]  1%|          | 53/5000 [01:43<2:47:22,  2.03s/it]  1%|          | 54/5000 [01:45<2:44:06,  1.99s/it]  1%|          | 55/5000 [01:47<2:46:43,  2.02s/it]  1%|          | 56/5000 [01:49<2:49:52,  2.06s/it]  1%|          | 57/5000 [01:51<2:51:05,  2.08s/it]  1%|          | 58/5000 [01:53<2:50:47,  2.07s/it]  1%|          | 59/5000 [01:55<2:43:24,  1.98s/it]  1%|          | 60/5000 [01:57<2:45:08,  2.01s/it]  1%|          | 61/5000 [01:59<2:39:13,  1.93s/it]  1%|          | 62/5000 [02:01<2:38:56,  1.93s/it]  1%|▏         | 63/5000 [02:03<2:43:23,  1.99s/it]  1%|▏         | 64/5000 [02:05<2:42:25,  1.97s/it]  1%|▏         | 65/5000 [02:06<2:36:37,  1.90s/it]  1%|▏         | 66/5000 [02:08<2:32:59,  1.86s/it]  1%|▏         | 67/5000 [02:10<2:31:53,  1.85s/it]  1%|▏         | 68/5000 [02:12<2:29:41,  1.82s/it]  1%|▏         | 69/5000 [02:14<2:28:27,  1.81s/it]  1%|▏         | 70/5000 [02:16<2:32:43,  1.86s/it]  1%|▏         | 71/5000 [02:17<2:31:15,  1.84s/it]  1%|▏         | 72/5000 [02:19<2:37:56,  1.92s/it]  1%|▏         | 73/5000 [02:22<2:41:12,  1.96s/it]  1%|▏         | 74/5000 [02:23<2:39:30,  1.94s/it]  2%|▏         | 75/5000 [02:25<2:35:07,  1.89s/it]  2%|▏         | 76/5000 [02:27<2:31:32,  1.85s/it]  2%|▏         | 77/5000 [02:29<2:33:06,  1.87s/it]  2%|▏         | 78/5000 [02:31<2:29:38,  1.82s/it]  2%|▏         | 78/5000 [02:32<2:40:46,  1.96s/it]
AUC:  0.7794596354166666 LOGlOSS:  0.3996070904875712 test_AUC:  0.752824296494725 test_LOGlOSS:  0.4400565945924615
Time:  153.25605397799518
{'model_opt': {'latent_dim': 16, 'feat_num': 647, 'field_num': 10, 'mlp_dropout': 0.0, 'use_bn': False, 'mlp_dims': [1024, 512, 256], 'cross': 3}, 'dataset': 'coat', 'model': 'IPS-CTR', 'data_dir': 'data/coat/tfrecord', 'cuda': 3, 'source': None}
==================================================
|          IPS-CTR: Set the random seed          |
==================================================

==================================================
|            IPS-CTR: Estimate pscore            |
==================================================

==================================================
|               IPS-CTR: Training                |
==================================================

######### trainer ###########
lr: 3e-05 l2: 0.0001 bs: 16
  0%|          | 0/5000 [00:00<?, ?it/s]  0%|          | 1/5000 [00:02<3:03:18,  2.20s/it]  0%|          | 2/5000 [00:04<2:59:10,  2.15s/it]  0%|          | 3/5000 [00:06<2:52:27,  2.07s/it]  0%|          | 4/5000 [00:08<2:53:58,  2.09s/it]  0%|          | 5/5000 [00:10<2:48:18,  2.02s/it]  0%|          | 6/5000 [00:12<2:51:46,  2.06s/it]  0%|          | 7/5000 [00:14<2:58:05,  2.14s/it]  0%|          | 8/5000 [00:16<2:55:22,  2.11s/it]  0%|          | 9/5000 [00:18<2:49:38,  2.04s/it]  0%|          | 10/5000 [00:20<2:48:58,  2.03s/it]  0%|          | 11/5000 [00:22<2:50:11,  2.05s/it]  0%|          | 12/5000 [00:24<2:48:40,  2.03s/it]  0%|          | 13/5000 [00:26<2:47:03,  2.01s/it]  0%|          | 14/5000 [00:28<2:43:53,  1.97s/it]  0%|          | 15/5000 [00:30<2:48:45,  2.03s/it]  0%|          | 16/5000 [00:33<2:56:21,  2.12s/it]  0%|          | 17/5000 [00:35<2:57:43,  2.14s/it]  0%|          | 18/5000 [00:37<3:02:34,  2.20s/it]  0%|          | 19/5000 [00:39<2:51:42,  2.07s/it]  0%|          | 20/5000 [00:41<2:47:55,  2.02s/it]  0%|          | 21/5000 [00:43<2:45:09,  1.99s/it]  0%|          | 22/5000 [00:45<2:42:00,  1.95s/it]  0%|          | 23/5000 [00:47<2:52:52,  2.08s/it]  0%|          | 24/5000 [00:49<3:01:51,  2.19s/it]  0%|          | 25/5000 [00:52<3:06:24,  2.25s/it]  1%|          | 26/5000 [00:54<3:09:07,  2.28s/it]  1%|          | 27/5000 [00:57<3:11:32,  2.31s/it]  1%|          | 28/5000 [00:59<3:13:11,  2.33s/it]  1%|          | 29/5000 [01:01<3:11:49,  2.32s/it]  1%|          | 30/5000 [01:03<3:05:48,  2.24s/it]  1%|          | 31/5000 [01:05<3:00:58,  2.19s/it]  1%|          | 32/5000 [01:07<2:58:02,  2.15s/it]  1%|          | 33/5000 [01:09<2:55:38,  2.12s/it]  1%|          | 34/5000 [01:12<2:54:22,  2.11s/it]  1%|          | 35/5000 [01:14<2:53:18,  2.09s/it]  1%|          | 36/5000 [01:16<2:59:55,  2.17s/it]  1%|          | 37/5000 [01:18<3:08:47,  2.28s/it]  1%|          | 38/5000 [01:21<3:12:07,  2.32s/it]  1%|          | 38/5000 [01:23<3:01:50,  2.20s/it]
AUC:  0.773046875 LOGlOSS:  0.4074933501769233 test_AUC:  0.7539639312080272 test_LOGlOSS:  0.4539559992646548
Time:  83.95153357600793
{'model_opt': {'latent_dim': 16, 'feat_num': 647, 'field_num': 10, 'mlp_dropout': 0.0, 'use_bn': False, 'mlp_dims': [1024, 512, 256], 'cross': 3}, 'dataset': 'coat', 'model': 'Refine-CTR', 'data_dir': 'data/coat/tfrecord', 'cuda': 3, 'source': None}
==================================================
|        Refine-CTR: Set the random seed         |
==================================================

==================================================
|              Refine-CTR: Training              |
==================================================

######### trainer ###########
beta1 0.5757267617242218 lr: 3e-05 l2: 0.0003 bs: 16
  0%|          | 0/5000 [00:00<?, ?it/s]  0%|          | 1/5000 [00:04<6:17:19,  4.53s/it]  0%|          | 2/5000 [00:09<6:15:34,  4.51s/it]  0%|          | 3/5000 [00:13<6:13:55,  4.49s/it]  0%|          | 4/5000 [00:17<6:13:10,  4.48s/it]  0%|          | 5/5000 [00:22<6:13:18,  4.48s/it]  0%|          | 6/5000 [00:26<6:13:13,  4.48s/it]  0%|          | 7/5000 [00:31<6:22:19,  4.59s/it]  0%|          | 8/5000 [00:36<6:21:07,  4.58s/it]  0%|          | 9/5000 [00:40<6:21:12,  4.58s/it]  0%|          | 10/5000 [00:45<6:17:38,  4.54s/it]  0%|          | 11/5000 [00:49<6:15:01,  4.51s/it]  0%|          | 12/5000 [00:54<6:13:25,  4.49s/it]  0%|          | 13/5000 [00:58<6:13:15,  4.49s/it]  0%|          | 14/5000 [01:03<6:11:18,  4.47s/it]  0%|          | 15/5000 [01:07<6:15:24,  4.52s/it]  0%|          | 16/5000 [01:13<6:39:32,  4.81s/it]  0%|          | 17/5000 [01:18<6:46:53,  4.90s/it]  0%|          | 18/5000 [01:22<6:37:07,  4.78s/it]  0%|          | 19/5000 [01:27<6:40:49,  4.83s/it]  0%|          | 20/5000 [01:32<6:31:18,  4.71s/it]  0%|          | 21/5000 [01:35<5:45:05,  4.16s/it]  0%|          | 22/5000 [01:37<5:11:56,  3.76s/it]  0%|          | 23/5000 [01:40<4:48:15,  3.48s/it]  0%|          | 24/5000 [01:43<4:28:10,  3.23s/it]  0%|          | 25/5000 [01:46<4:15:54,  3.09s/it]  1%|          | 26/5000 [01:49<4:31:01,  3.27s/it]  1%|          | 27/5000 [01:53<4:43:31,  3.42s/it]  1%|          | 27/5000 [01:56<5:57:05,  4.31s/it]
AUC:  0.8075195312500001 LOGlOSS:  0.8222046926019373 test_AUC:  0.7480061182911132 test_LOGlOSS:  0.8206306140229604
Time:  116.79740170307923
{'model_opt': {'latent_dim': 16, 'feat_num': 647, 'field_num': 10, 'mlp_dropout': 0.0, 'use_bn': True, 'mlp_dims': [1024, 512, 256], 'cross': 3}, 'dataset': 'coat', 'model': 'UDIPS-CTR', 'data_dir': 'data/coat/tfrecord', 'cuda': 3, 'source': None}
==================================================
|         UDIPS-CTR: Set the random seed         |
==================================================

==================================================
|           UDIPS-CTR: Estimate pscore           |
==================================================

==================================================
|              UDIPS-CTR: Training               |
==================================================

######### trainer ###########
beta1 0.4974358897975235 lr: 0.0001 l2: 0.001 bs: 16
  0%|          | 0/5000 [00:00<?, ?it/s]  0%|          | 1/5000 [00:02<3:21:26,  2.42s/it]  0%|          | 2/5000 [00:04<3:21:31,  2.42s/it]  0%|          | 3/5000 [00:07<3:23:25,  2.44s/it]  0%|          | 4/5000 [00:09<3:25:25,  2.47s/it]  0%|          | 5/5000 [00:12<3:28:02,  2.50s/it]  0%|          | 6/5000 [00:14<3:27:42,  2.50s/it]  0%|          | 7/5000 [00:17<3:24:21,  2.46s/it]  0%|          | 8/5000 [00:19<3:30:07,  2.53s/it]  0%|          | 9/5000 [00:22<3:23:54,  2.45s/it]  0%|          | 10/5000 [00:24<3:26:01,  2.48s/it]  0%|          | 11/5000 [00:27<3:27:48,  2.50s/it]  0%|          | 12/5000 [00:29<3:26:50,  2.49s/it]  0%|          | 13/5000 [00:32<3:28:32,  2.51s/it]  0%|          | 14/5000 [00:34<3:30:21,  2.53s/it]  0%|          | 15/5000 [00:37<3:33:24,  2.57s/it]  0%|          | 16/5000 [00:39<3:26:48,  2.49s/it]  0%|          | 17/5000 [00:42<3:23:07,  2.45s/it]  0%|          | 18/5000 [00:44<3:21:36,  2.43s/it]  0%|          | 19/5000 [00:47<3:25:20,  2.47s/it]  0%|          | 20/5000 [00:49<3:20:24,  2.41s/it]  0%|          | 21/5000 [00:52<3:27:51,  2.50s/it]  0%|          | 22/5000 [00:54<3:28:01,  2.51s/it]  0%|          | 23/5000 [00:57<3:27:31,  2.50s/it]  0%|          | 24/5000 [00:59<3:28:13,  2.51s/it]  0%|          | 25/5000 [01:02<3:29:32,  2.53s/it]  1%|          | 26/5000 [01:04<3:24:53,  2.47s/it]  1%|          | 27/5000 [01:07<3:27:35,  2.50s/it]  1%|          | 28/5000 [01:09<3:25:27,  2.48s/it]  1%|          | 29/5000 [01:12<3:30:27,  2.54s/it]  1%|          | 30/5000 [01:15<3:38:58,  2.64s/it]  1%|          | 31/5000 [01:18<3:45:33,  2.72s/it]  1%|          | 32/5000 [01:20<3:38:44,  2.64s/it]  1%|          | 33/5000 [01:22<3:33:40,  2.58s/it]  1%|          | 34/5000 [01:25<3:37:13,  2.62s/it]  1%|          | 35/5000 [01:28<3:34:53,  2.60s/it]  1%|          | 36/5000 [01:30<3:32:31,  2.57s/it]  1%|          | 37/5000 [01:33<3:32:26,  2.57s/it]  1%|          | 38/5000 [01:35<3:30:51,  2.55s/it]  1%|          | 39/5000 [01:38<3:26:39,  2.50s/it]  1%|          | 39/5000 [01:40<3:33:35,  2.58s/it]
AUC:  0.7811197916666667  LOGlOSS:  0.39426949657828425 test_AUC:  0.7533320782501265 test_LOGlOSS:  0.43335306651711886
Time:  101.19700372498482
{'model_opt': {'latent_dim': 16, 'feat_num': 647, 'field_num': 10, 'mlp_dropout': 0.0, 'use_bn': False, 'mlp_dims': [1024, 512, 256], 'cross': 3}, 'dataset': 'coat', 'model': 'bias_BASE-CTR', 'data_dir': 'data/coat/tfrecord', 'cuda': 3, 'source': 'bias'}
==================================================
|         BASE-CTR: Set the random seed          |
==================================================

==================================================
|               BASE-CTR: Training               |
==================================================

######### trainer ###########
lr: 0.0001 l2: 0.001 bs: 16
  0%|          | 0/5000 [00:00<?, ?it/s]  0%|          | 1/5000 [00:02<2:59:23,  2.15s/it]  0%|          | 2/5000 [00:04<2:50:40,  2.05s/it]  0%|          | 3/5000 [00:06<2:47:07,  2.01s/it]  0%|          | 4/5000 [00:08<2:46:12,  2.00s/it]  0%|          | 5/5000 [00:10<2:51:17,  2.06s/it]  0%|          | 6/5000 [00:12<2:56:22,  2.12s/it]  0%|          | 7/5000 [00:14<3:00:18,  2.17s/it]  0%|          | 8/5000 [00:16<2:57:22,  2.13s/it]  0%|          | 9/5000 [00:18<2:47:11,  2.01s/it]  0%|          | 10/5000 [00:20<2:41:06,  1.94s/it]  0%|          | 11/5000 [00:22<2:35:41,  1.87s/it]  0%|          | 12/5000 [00:23<2:32:29,  1.83s/it]  0%|          | 13/5000 [00:25<2:27:17,  1.77s/it]  0%|          | 14/5000 [00:26<2:20:49,  1.69s/it]  0%|          | 15/5000 [00:28<2:19:16,  1.68s/it]  0%|          | 16/5000 [00:30<2:26:42,  1.77s/it]  0%|          | 17/5000 [00:32<2:27:53,  1.78s/it]  0%|          | 18/5000 [00:34<2:31:06,  1.82s/it]  0%|          | 19/5000 [00:35<2:28:11,  1.79s/it]  0%|          | 20/5000 [00:37<2:22:40,  1.72s/it]  0%|          | 21/5000 [00:39<2:18:49,  1.67s/it]  0%|          | 22/5000 [00:40<2:14:55,  1.63s/it]  0%|          | 23/5000 [00:42<2:13:15,  1.61s/it]  0%|          | 24/5000 [00:44<2:22:41,  1.72s/it]  0%|          | 25/5000 [00:46<2:39:02,  1.92s/it]  1%|          | 26/5000 [00:49<2:54:35,  2.11s/it]  1%|          | 27/5000 [00:51<3:07:30,  2.26s/it]  1%|          | 28/5000 [00:53<2:55:28,  2.12s/it]  1%|          | 29/5000 [00:55<2:44:04,  1.98s/it]  1%|          | 30/5000 [00:56<2:34:54,  1.87s/it]  1%|          | 31/5000 [00:58<2:32:20,  1.84s/it]  1%|          | 32/5000 [01:00<2:28:55,  1.80s/it]  1%|          | 33/5000 [01:01<2:27:07,  1.78s/it]  1%|          | 34/5000 [01:03<2:20:57,  1.70s/it]  1%|          | 35/5000 [01:04<2:15:34,  1.64s/it]  1%|          | 36/5000 [01:06<2:16:07,  1.65s/it]  1%|          | 37/5000 [01:08<2:16:30,  1.65s/it]  1%|          | 38/5000 [01:10<2:19:04,  1.68s/it]  1%|          | 39/5000 [01:11<2:19:32,  1.69s/it]  1%|          | 40/5000 [01:13<2:13:48,  1.62s/it]  1%|          | 41/5000 [01:14<2:13:17,  1.61s/it]  1%|          | 42/5000 [01:16<2:15:25,  1.64s/it]  1%|          | 42/5000 [01:18<2:33:32,  1.86s/it]
AUC:  0.7794270833333333 LOGlOSS:  0.39581876674350186 test_AUC:  0.753737345575664 test_LOGlOSS:  0.43417037128681885
Time:  78.45949630008545
{'model_opt': {'latent_dim': 16, 'feat_num': 647, 'field_num': 10, 'mlp_dropout': 0.0, 'use_bn': False, 'mlp_dims': [1024, 512, 256], 'cross': 3}, 'dataset': 'coat', 'model': 'combine_BASE-CTR', 'data_dir': 'data/coat/tfrecord', 'cuda': 3, 'source': 'combine'}
==================================================
|         BASE-CTR: Set the random seed          |
==================================================

==================================================
|               BASE-CTR: Training               |
==================================================

######### trainer ###########
lr: 0.0003 l2: 0.001 bs: 64
  0%|          | 0/5000 [00:00<?, ?it/s]  0%|          | 1/5000 [00:00<41:44,  2.00it/s]  0%|          | 2/5000 [00:00<41:18,  2.02it/s]  0%|          | 3/5000 [00:01<40:06,  2.08it/s]  0%|          | 4/5000 [00:01<38:01,  2.19it/s]  0%|          | 5/5000 [00:02<39:01,  2.13it/s]  0%|          | 6/5000 [00:02<38:00,  2.19it/s]  0%|          | 7/5000 [00:03<37:26,  2.22it/s]  0%|          | 8/5000 [00:03<37:06,  2.24it/s]  0%|          | 9/5000 [00:04<38:08,  2.18it/s]  0%|          | 10/5000 [00:04<40:05,  2.07it/s]  0%|          | 11/5000 [00:05<42:14,  1.97it/s]  0%|          | 12/5000 [00:05<41:49,  1.99it/s]  0%|          | 13/5000 [00:06<39:12,  2.12it/s]  0%|          | 14/5000 [00:06<38:33,  2.15it/s]  0%|          | 15/5000 [00:07<39:41,  2.09it/s]  0%|          | 16/5000 [00:07<41:51,  1.98it/s]  0%|          | 17/5000 [00:08<40:36,  2.04it/s]  0%|          | 18/5000 [00:08<40:27,  2.05it/s]  0%|          | 19/5000 [00:09<41:44,  1.99it/s]  0%|          | 20/5000 [00:09<42:13,  1.97it/s]  0%|          | 21/5000 [00:10<42:14,  1.96it/s]  0%|          | 22/5000 [00:10<43:21,  1.91it/s]  0%|          | 23/5000 [00:11<43:55,  1.89it/s]  0%|          | 24/5000 [00:11<44:28,  1.86it/s]  0%|          | 25/5000 [00:12<43:59,  1.88it/s]  1%|          | 26/5000 [00:12<43:20,  1.91it/s]  1%|          | 27/5000 [00:13<44:11,  1.88it/s]  1%|          | 28/5000 [00:13<43:45,  1.89it/s]  1%|          | 29/5000 [00:14<40:45,  2.03it/s]  1%|          | 30/5000 [00:14<39:15,  2.11it/s]  1%|          | 31/5000 [00:15<37:39,  2.20it/s]  1%|          | 32/5000 [00:15<36:59,  2.24it/s]  1%|          | 33/5000 [00:16<36:18,  2.28it/s]  1%|          | 34/5000 [00:16<36:03,  2.30it/s]  1%|          | 35/5000 [00:16<35:19,  2.34it/s]  1%|          | 36/5000 [00:17<34:38,  2.39it/s]  1%|          | 36/5000 [00:17<40:35,  2.04it/s]
AUC:  0.7981119791666667 LOGlOSS:  0.3907259295709239 test_AUC:  0.761980176391885 test_LOGlOSS:  0.44213880042379355
Time:  18.133620531996712
{'model_opt': {'latent_dim': 16, 'feat_num': 647, 'field_num': 10, 'mlp_dropout': 0.0, 'use_bn': False, 'mlp_dims': [1024, 512, 256], 'cross': 3}, 'dataset': 'coat', 'model': 'unif_BASE-CTR', 'data_dir': 'data/coat/tfrecord', 'cuda': 3, 'source': 'unif'}
==================================================
|         BASE-CTR: Set the random seed          |
==================================================

==================================================
|               BASE-CTR: Training               |
==================================================

######### trainer ###########
lr: 0.001 l2: 1e-06 bs: 16
  0%|          | 0/5000 [00:00<?, ?it/s]  0%|          | 1/5000 [00:00<17:51,  4.67it/s]  0%|          | 2/5000 [00:00<17:29,  4.76it/s]  0%|          | 3/5000 [00:00<15:26,  5.40it/s]  0%|          | 4/5000 [00:00<14:48,  5.62it/s]  0%|          | 5/5000 [00:00<14:45,  5.64it/s]  0%|          | 6/5000 [00:01<15:52,  5.25it/s]  0%|          | 7/5000 [00:01<15:34,  5.34it/s]  0%|          | 8/5000 [00:01<15:19,  5.43it/s]  0%|          | 9/5000 [00:01<14:55,  5.58it/s]  0%|          | 10/5000 [00:01<15:56,  5.22it/s]  0%|          | 10/5000 [00:02<17:39,  4.71it/s]
AUC:  0.6565429687500001 LOGlOSS:  0.6178924923313831 test_AUC:  0.6166741157292105 test_LOGlOSS:  0.7088854001513444
Time:  2.3903217429760844
