nohup: ignoring input
2024-07-25 09:05:37.155372: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2024-07-25 09:05:40.135356: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-07-25 09:05:40.135490: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-07-25 09:05:40.136203: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:1f:00.0 name: Tesla V100-SXM2-32GB computeCapability: 7.0
coreClock: 1.53GHz coreCount: 80 deviceMemorySize: 31.74GiB deviceMemoryBandwidth: 836.37GiB/s
2024-07-25 09:05:40.136240: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2024-07-25 09:05:40.136308: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2024-07-25 09:05:40.136335: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2024-07-25 09:05:40.170332: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-07-25 09:05:40.170782: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-07-25 09:05:40.170935: W tensorflow/stream_executor/platform/default/dso_loader.cc:60] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /lib/x86_64-linux-gnu:/usr/lib/x86_64-linux-gnu::/usr/local/cuda-11.7/lib64
2024-07-25 09:05:40.171781: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2024-07-25 09:05:40.171849: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2024-07-25 09:05:40.171860: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1757] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2024-07-25 09:05:40.172217: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX512F
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-07-25 09:05:40.180355: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-07-25 09:05:40.180438: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-07-25 09:05:40.180462: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      
2024-07-25 09:05:40.248840: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-07-25 09:05:40.268650: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2500000000 Hz
{'model_opt': {'latent_dim': 16, 'feat_num': 647, 'field_num': 10, 'mlp_dropout': 0.0, 'use_bn': False, 'mlp_dims': [1024, 512, 256], 'cross': 3}, 'dataset': 'coat', 'model': 'TJR-CTR', 'data_dir': 'data/coat/tfrecord', 'cuda': 2, 'source': None}
==================================================
|          TJR-CTR: Set the random seed          |
==================================================

==================================================
|               TJR-CTR: Training                |
==================================================

######### trainer ###########
alpha1 0.052932677927978775 alpha2 0.2 lr: 0.001 l2: 0.0001 bs: 16
  0%|          | 0/5000 [00:00<?, ?it/s]  0%|          | 1/5000 [00:02<3:32:10,  2.55s/it]  0%|          | 2/5000 [00:05<3:32:40,  2.55s/it]  0%|          | 3/5000 [00:07<3:32:49,  2.56s/it]  0%|          | 4/5000 [00:10<3:32:19,  2.55s/it]  0%|          | 5/5000 [00:12<3:29:18,  2.51s/it]  0%|          | 6/5000 [00:14<3:23:52,  2.45s/it]  0%|          | 7/5000 [00:17<3:19:06,  2.39s/it]  0%|          | 8/5000 [00:19<3:18:45,  2.39s/it]  0%|          | 9/5000 [00:22<3:22:31,  2.43s/it]  0%|          | 10/5000 [00:24<3:24:47,  2.46s/it]  0%|          | 11/5000 [00:27<3:26:24,  2.48s/it]  0%|          | 12/5000 [00:29<3:27:35,  2.50s/it]  0%|          | 13/5000 [00:32<3:28:15,  2.51s/it]  0%|          | 14/5000 [00:34<3:28:27,  2.51s/it]  0%|          | 15/5000 [00:37<3:28:46,  2.51s/it]  0%|          | 16/5000 [00:39<3:28:59,  2.52s/it]  0%|          | 17/5000 [00:42<3:29:09,  2.52s/it]  0%|          | 18/5000 [00:44<3:29:13,  2.52s/it]  0%|          | 19/5000 [00:47<3:29:07,  2.52s/it]  0%|          | 20/5000 [00:49<3:29:26,  2.52s/it]  0%|          | 21/5000 [00:52<3:28:53,  2.52s/it]  0%|          | 22/5000 [00:54<3:29:02,  2.52s/it]  0%|          | 23/5000 [00:57<3:29:23,  2.52s/it]  0%|          | 24/5000 [01:00<3:29:12,  2.52s/it]  0%|          | 25/5000 [01:02<3:29:16,  2.52s/it]  1%|          | 26/5000 [01:05<3:29:06,  2.52s/it]  1%|          | 27/5000 [01:07<3:29:04,  2.52s/it]  1%|          | 28/5000 [01:10<3:28:50,  2.52s/it]  1%|          | 29/5000 [01:12<3:28:51,  2.52s/it]  1%|          | 30/5000 [01:15<3:28:44,  2.52s/it]  1%|          | 31/5000 [01:17<3:28:38,  2.52s/it]  1%|          | 32/5000 [01:20<3:28:26,  2.52s/it]  1%|          | 33/5000 [01:22<3:28:24,  2.52s/it]  1%|          | 34/5000 [01:25<3:28:38,  2.52s/it]  1%|          | 35/5000 [01:27<3:28:36,  2.52s/it]  1%|          | 36/5000 [01:30<3:27:26,  2.51s/it]  1%|          | 37/5000 [01:32<3:27:50,  2.51s/it]  1%|          | 38/5000 [01:35<3:27:46,  2.51s/it]  1%|          | 39/5000 [01:36<3:00:07,  2.18s/it]  1%|          | 40/5000 [01:37<2:31:06,  1.83s/it]  1%|          | 41/5000 [01:38<2:10:17,  1.58s/it]  1%|          | 42/5000 [01:39<1:55:34,  1.40s/it]  1%|          | 43/5000 [01:40<1:45:36,  1.28s/it]  1%|          | 44/5000 [01:41<1:38:30,  1.19s/it]  1%|          | 44/5000 [01:42<3:12:39,  2.33s/it]
AUC:  0.7840169270833334 LOGlOSS:  0.6030867470500877 test_AUC:  0.7389867646206416 test_LOGlOSS:  0.7790668624088914
Time:  105.1996844940586
{'model_opt': {'latent_dim': 16, 'feat_num': 647, 'field_num': 10, 'mlp_dropout': 0.0, 'use_bn': False, 'mlp_dims': [1024, 512, 256], 'cross': 3}, 'dataset': 'coat', 'model': 'Bridge-CTR', 'data_dir': 'data/coat/tfrecord', 'cuda': 2, 'source': None}
==================================================
|        Bridge-CTR: Set the random seed         |
==================================================

==================================================
|              Bridge-CTR: Training              |
==================================================

######### trainer ###########
alpha1 1 lr: 0.0003 l2: 0.0003 bs: 16
  0%|          | 0/5000 [00:00<?, ?it/s]  0%|          | 1/5000 [00:02<3:10:22,  2.28s/it]  0%|          | 2/5000 [00:04<3:06:32,  2.24s/it]  0%|          | 3/5000 [00:06<2:58:41,  2.15s/it]  0%|          | 4/5000 [00:08<2:55:23,  2.11s/it]  0%|          | 5/5000 [00:10<2:54:13,  2.09s/it]  0%|          | 6/5000 [00:12<2:53:49,  2.09s/it]  0%|          | 7/5000 [00:14<2:53:39,  2.09s/it]  0%|          | 8/5000 [00:16<2:53:40,  2.09s/it]  0%|          | 8/5000 [00:18<3:17:21,  2.37s/it]
AUC:  0.7950846354166666 LOGlOSS:  0.37802409460606873 test_AUC:  0.7501704182636643 test_LOGlOSS:  0.4204049395539407
Time:  19.3866566530196
{'model_opt': {'latent_dim': 16, 'feat_num': 647, 'field_num': 10, 'mlp_dropout': 0.0, 'use_bn': True, 'mlp_dims': [1024, 512, 256], 'cross': 3}, 'dataset': 'coat', 'model': 'CausE-CTR', 'data_dir': 'data/coat/tfrecord', 'cuda': 2, 'source': None}
==================================================
|         CausE-CTR: Set the random seed         |
==================================================

==================================================
|              CausE-CTR: Training               |
==================================================

######### trainer ###########
alpha1 0.01 lr: 0.001 l2: 0.0001 bs: 16
  0%|          | 0/5000 [00:00<?, ?it/s]  0%|          | 1/5000 [00:01<1:36:29,  1.16s/it]  0%|          | 2/5000 [00:02<1:39:03,  1.19s/it]  0%|          | 3/5000 [00:03<1:39:42,  1.20s/it]  0%|          | 4/5000 [00:04<1:39:25,  1.19s/it]  0%|          | 5/5000 [00:05<1:35:09,  1.14s/it]  0%|          | 6/5000 [00:06<1:32:05,  1.11s/it]  0%|          | 7/5000 [00:07<1:30:17,  1.08s/it]  0%|          | 8/5000 [00:08<1:29:34,  1.08s/it]  0%|          | 9/5000 [00:10<1:29:17,  1.07s/it]  0%|          | 10/5000 [00:11<1:29:32,  1.08s/it]  0%|          | 11/5000 [00:12<1:35:00,  1.14s/it]  0%|          | 12/5000 [00:13<1:35:27,  1.15s/it]  0%|          | 13/5000 [00:14<1:40:30,  1.21s/it]  0%|          | 14/5000 [00:16<1:38:44,  1.19s/it]  0%|          | 15/5000 [00:17<1:37:52,  1.18s/it]  0%|          | 16/5000 [00:18<1:36:47,  1.17s/it]  0%|          | 17/5000 [00:19<1:36:38,  1.16s/it]  0%|          | 18/5000 [00:20<1:34:21,  1.14s/it]  0%|          | 19/5000 [00:21<1:34:02,  1.13s/it]  0%|          | 20/5000 [00:22<1:35:38,  1.15s/it]  0%|          | 21/5000 [00:24<1:36:49,  1.17s/it]  0%|          | 22/5000 [00:25<1:37:40,  1.18s/it]  0%|          | 22/5000 [00:26<1:39:56,  1.20s/it]
AUC:  0.7921874999999999 LOGlOSS:  0.5371801791255898 test_AUC:  0.7316105160643464 test_LOGlOSS:  0.6688637283669443
Time:  26.9733172620181
{'model_opt': {'latent_dim': 16, 'feat_num': 647, 'field_num': 10, 'mlp_dropout': 0.0, 'use_bn': True, 'mlp_dims': [1024, 512, 256], 'cross': 3}, 'dataset': 'coat', 'model': 'DR-CTR', 'data_dir': 'data/coat/tfrecord', 'cuda': 2, 'source': None}
==================================================
|          DR-CTR: Set the random seed           |
==================================================

==================================================
|            DR-CTR: Estimate pscore             |
==================================================

==================================================
|                DR-CTR: Training                |
==================================================

######### trainer ###########
beta1 0.011541263226425374 lr: 0.001 l2: 3e-05 bs: 16
  0%|          | 0/5000 [00:00<?, ?it/s]  0%|          | 1/5000 [00:03<4:24:55,  3.18s/it]  0%|          | 2/5000 [00:06<4:26:10,  3.20s/it]  0%|          | 3/5000 [00:09<4:25:05,  3.18s/it]  0%|          | 4/5000 [00:12<4:10:39,  3.01s/it]  0%|          | 5/5000 [00:15<4:15:06,  3.06s/it]  0%|          | 6/5000 [00:18<4:14:59,  3.06s/it]  0%|          | 7/5000 [00:21<4:16:45,  3.09s/it]  0%|          | 8/5000 [00:24<4:17:47,  3.10s/it]  0%|          | 9/5000 [00:27<4:13:29,  3.05s/it]  0%|          | 9/5000 [00:30<4:43:44,  3.41s/it]
AUC:  0.7824544270833333 LOGlOSS:  0.3915025500350733 test_AUC:  0.7510604734537926 test_LOGlOSS:  0.4357488425698427
Time:  31.149551782989874
{'model_opt': {'latent_dim': 16, 'feat_num': 647, 'field_num': 10, 'mlp_dropout': 0.0, 'use_bn': False, 'mlp_dims': [1024, 512, 256], 'cross': 3}, 'dataset': 'coat', 'model': 'DRJL-CTR', 'data_dir': 'data/coat/tfrecord', 'cuda': 2, 'source': None}
==================================================
|         DRJL-CTR: Set the random seed          |
==================================================

==================================================
|           DRJL-CTR: Estimate pscore            |
==================================================

==================================================
|               DRJL-CTR: Training               |
==================================================

######### trainer ###########
beta1 0.8712290220703551 lr: 0.0001 l2: 0.0001 bs: 16
  0%|          | 0/5000 [00:00<?, ?it/s]  0%|          | 1/5000 [00:03<4:44:29,  3.41s/it]  0%|          | 2/5000 [00:07<4:57:19,  3.57s/it]  0%|          | 3/5000 [00:11<5:12:33,  3.75s/it]  0%|          | 4/5000 [00:14<5:09:55,  3.72s/it]  0%|          | 5/5000 [00:18<5:08:39,  3.71s/it]  0%|          | 6/5000 [00:22<5:07:25,  3.69s/it]  0%|          | 7/5000 [00:25<5:07:13,  3.69s/it]  0%|          | 8/5000 [00:29<4:59:58,  3.61s/it]  0%|          | 9/5000 [00:32<5:02:50,  3.64s/it]  0%|          | 10/5000 [00:36<5:05:19,  3.67s/it]  0%|          | 11/5000 [00:40<5:07:05,  3.69s/it]  0%|          | 12/5000 [00:44<5:07:40,  3.70s/it]  0%|          | 13/5000 [00:47<5:06:58,  3.69s/it]  0%|          | 14/5000 [00:51<5:06:08,  3.68s/it]  0%|          | 15/5000 [00:55<5:04:12,  3.66s/it]  0%|          | 16/5000 [00:58<5:10:31,  3.74s/it]  0%|          | 17/5000 [01:02<5:14:57,  3.79s/it]  0%|          | 18/5000 [01:06<5:18:12,  3.83s/it]  0%|          | 19/5000 [01:10<5:21:04,  3.87s/it]  0%|          | 20/5000 [01:14<5:21:15,  3.87s/it]  0%|          | 21/5000 [01:18<5:22:16,  3.88s/it]  0%|          | 22/5000 [01:22<5:21:37,  3.88s/it]  0%|          | 23/5000 [01:26<5:22:41,  3.89s/it]  0%|          | 24/5000 [01:30<5:23:04,  3.90s/it]  0%|          | 25/5000 [01:33<5:17:20,  3.83s/it]  1%|          | 26/5000 [01:37<5:03:14,  3.66s/it]  1%|          | 27/5000 [01:40<5:02:58,  3.66s/it]  1%|          | 28/5000 [01:44<5:02:37,  3.65s/it]  1%|          | 29/5000 [01:48<5:03:35,  3.66s/it]  1%|          | 30/5000 [01:51<5:03:31,  3.66s/it]  1%|          | 31/5000 [01:55<5:06:17,  3.70s/it]  1%|          | 32/5000 [01:59<5:06:07,  3.70s/it]  1%|          | 33/5000 [02:02<4:58:35,  3.61s/it]  1%|          | 34/5000 [02:06<4:59:49,  3.62s/it]  1%|          | 35/5000 [02:10<5:02:49,  3.66s/it]  1%|          | 36/5000 [02:13<5:08:23,  3.73s/it]  1%|          | 37/5000 [02:17<5:12:58,  3.78s/it]  1%|          | 38/5000 [02:21<5:16:14,  3.82s/it]  1%|          | 39/5000 [02:25<5:17:42,  3.84s/it]  1%|          | 40/5000 [02:29<5:19:07,  3.86s/it]  1%|          | 41/5000 [02:33<5:11:19,  3.77s/it]  1%|          | 42/5000 [02:36<5:04:39,  3.69s/it]  1%|          | 43/5000 [02:40<5:05:29,  3.70s/it]  1%|          | 44/5000 [02:43<4:56:34,  3.59s/it]  1%|          | 45/5000 [02:47<5:02:56,  3.67s/it]  1%|          | 46/5000 [02:51<5:08:23,  3.74s/it]  1%|          | 47/5000 [02:55<5:06:32,  3.71s/it]  1%|          | 48/5000 [02:58<5:02:11,  3.66s/it]  1%|          | 49/5000 [03:02<4:57:36,  3.61s/it]  1%|          | 50/5000 [03:05<4:56:17,  3.59s/it]  1%|          | 51/5000 [03:09<4:49:20,  3.51s/it]  1%|          | 52/5000 [03:12<4:52:01,  3.54s/it]  1%|          | 53/5000 [03:16<4:56:09,  3.59s/it]  1%|          | 54/5000 [03:19<4:51:50,  3.54s/it]  1%|          | 55/5000 [03:23<4:58:55,  3.63s/it]  1%|          | 56/5000 [03:27<5:01:28,  3.66s/it]  1%|          | 57/5000 [03:29<4:29:42,  3.27s/it]  1%|          | 58/5000 [03:31<3:49:09,  2.78s/it]  1%|          | 59/5000 [03:32<3:20:20,  2.43s/it]  1%|          | 60/5000 [03:34<3:02:50,  2.22s/it]  1%|          | 61/5000 [03:36<2:49:10,  2.06s/it]  1%|          | 62/5000 [03:38<2:40:46,  1.95s/it]  1%|▏         | 63/5000 [03:39<2:32:43,  1.86s/it]  1%|▏         | 64/5000 [03:41<2:29:36,  1.82s/it]  1%|▏         | 65/5000 [03:43<2:33:44,  1.87s/it]  1%|▏         | 66/5000 [03:47<3:20:36,  2.44s/it]  1%|▏         | 67/5000 [03:51<4:06:15,  3.00s/it]  1%|▏         | 68/5000 [03:55<4:31:52,  3.31s/it]  1%|▏         | 69/5000 [03:58<4:22:52,  3.20s/it]  1%|▏         | 70/5000 [04:00<3:57:20,  2.89s/it]  1%|▏         | 71/5000 [04:04<4:20:42,  3.17s/it]  1%|▏         | 72/5000 [04:08<4:34:54,  3.35s/it]  1%|▏         | 73/5000 [04:12<4:45:56,  3.48s/it]  1%|▏         | 74/5000 [04:14<4:31:05,  3.30s/it]  2%|▏         | 75/5000 [04:16<3:51:56,  2.83s/it]  2%|▏         | 76/5000 [04:19<3:56:57,  2.89s/it]  2%|▏         | 77/5000 [04:23<4:16:32,  3.13s/it]  2%|▏         | 78/5000 [04:26<4:28:44,  3.28s/it]  2%|▏         | 79/5000 [04:30<4:41:21,  3.43s/it]  2%|▏         | 79/5000 [04:34<4:44:41,  3.47s/it]
AUC:  0.7449869791666667 LOGlOSS:  0.4187227898686189 test_AUC:  0.7432487780902711 test_LOGlOSS:  0.44641898312410766
Time:  274.671607529046
{'model_opt': {'latent_dim': 16, 'feat_num': 647, 'field_num': 10, 'mlp_dropout': 0.0, 'use_bn': False, 'mlp_dims': [1024, 512, 256], 'cross': 3}, 'dataset': 'coat', 'model': 'IDIPS-CTR', 'data_dir': 'data/coat/tfrecord', 'cuda': 2, 'source': None}
==================================================
|         IDIPS-CTR: Set the random seed         |
==================================================

==================================================
|           IDIPS-CTR: Estimate pscore           |
==================================================

==================================================
|              IDIPS-CTR: Training               |
==================================================

######### trainer ###########
beta1 0.010204041791111222 lr: 3e-05 l2: 0.001 bs: 16
  0%|          | 0/5000 [00:00<?, ?it/s]  0%|          | 1/5000 [00:01<1:24:34,  1.02s/it]  0%|          | 2/5000 [00:02<1:23:09,  1.00it/s]  0%|          | 3/5000 [00:03<1:23:30,  1.00s/it]  0%|          | 4/5000 [00:04<1:25:39,  1.03s/it]  0%|          | 5/5000 [00:05<1:24:29,  1.01s/it]  0%|          | 6/5000 [00:06<1:25:41,  1.03s/it]  0%|          | 7/5000 [00:07<1:25:25,  1.03s/it]  0%|          | 8/5000 [00:08<1:25:16,  1.03s/it]  0%|          | 9/5000 [00:09<1:25:11,  1.02s/it]  0%|          | 10/5000 [00:10<1:25:30,  1.03s/it]  0%|          | 11/5000 [00:11<1:26:46,  1.04s/it]  0%|          | 12/5000 [00:12<1:27:36,  1.05s/it]  0%|          | 13/5000 [00:13<1:25:17,  1.03s/it]  0%|          | 14/5000 [00:14<1:24:09,  1.01s/it]  0%|          | 15/5000 [00:15<1:24:16,  1.01s/it]  0%|          | 16/5000 [00:16<1:23:58,  1.01s/it]  0%|          | 17/5000 [00:17<1:23:02,  1.00it/s]  0%|          | 18/5000 [00:18<1:23:22,  1.00s/it]  0%|          | 19/5000 [00:19<1:26:02,  1.04s/it]  0%|          | 20/5000 [00:20<1:27:51,  1.06s/it]  0%|          | 21/5000 [00:21<1:25:27,  1.03s/it]  0%|          | 22/5000 [00:22<1:25:28,  1.03s/it]  0%|          | 23/5000 [00:23<1:26:56,  1.05s/it]  0%|          | 24/5000 [00:24<1:25:02,  1.03s/it]  0%|          | 25/5000 [00:25<1:24:53,  1.02s/it]  1%|          | 26/5000 [00:26<1:25:06,  1.03s/it]  1%|          | 27/5000 [00:27<1:23:29,  1.01s/it]  1%|          | 28/5000 [00:28<1:24:34,  1.02s/it]  1%|          | 29/5000 [00:29<1:25:36,  1.03s/it]  1%|          | 30/5000 [00:30<1:26:16,  1.04s/it]  1%|          | 31/5000 [00:31<1:25:26,  1.03s/it]  1%|          | 32/5000 [00:32<1:26:21,  1.04s/it]  1%|          | 33/5000 [00:33<1:25:49,  1.04s/it]  1%|          | 34/5000 [00:34<1:25:14,  1.03s/it]  1%|          | 35/5000 [00:35<1:25:36,  1.03s/it]  1%|          | 36/5000 [00:37<1:27:34,  1.06s/it]  1%|          | 37/5000 [00:38<1:29:29,  1.08s/it]  1%|          | 38/5000 [00:39<1:28:22,  1.07s/it]  1%|          | 39/5000 [00:40<1:27:31,  1.06s/it]  1%|          | 40/5000 [00:41<1:28:56,  1.08s/it]  1%|          | 41/5000 [00:42<1:26:17,  1.04s/it]  1%|          | 42/5000 [00:43<1:24:33,  1.02s/it]  1%|          | 43/5000 [00:44<1:18:22,  1.05it/s]  1%|          | 44/5000 [00:44<1:12:07,  1.15it/s]  1%|          | 45/5000 [00:45<1:06:56,  1.23it/s]  1%|          | 46/5000 [00:46<1:05:41,  1.26it/s]  1%|          | 47/5000 [00:46<1:03:31,  1.30it/s]  1%|          | 48/5000 [00:47<1:03:06,  1.31it/s]  1%|          | 49/5000 [00:48<1:01:13,  1.35it/s]  1%|          | 50/5000 [00:49<59:47,  1.38it/s]    1%|          | 51/5000 [00:49<58:58,  1.40it/s]  1%|          | 52/5000 [00:50<58:34,  1.41it/s]  1%|          | 53/5000 [00:51<58:38,  1.41it/s]  1%|          | 54/5000 [00:51<58:34,  1.41it/s]  1%|          | 55/5000 [00:52<59:10,  1.39it/s]  1%|          | 56/5000 [00:53<59:22,  1.39it/s]  1%|          | 57/5000 [00:54<58:43,  1.40it/s]  1%|          | 58/5000 [00:54<58:42,  1.40it/s]  1%|          | 59/5000 [00:55<58:08,  1.42it/s]  1%|          | 60/5000 [00:56<58:50,  1.40it/s]  1%|          | 61/5000 [00:56<56:36,  1.45it/s]  1%|          | 62/5000 [00:57<56:43,  1.45it/s]  1%|▏         | 63/5000 [00:58<57:37,  1.43it/s]  1%|▏         | 64/5000 [00:58<56:36,  1.45it/s]  1%|▏         | 65/5000 [00:59<56:58,  1.44it/s]  1%|▏         | 66/5000 [01:00<55:16,  1.49it/s]  1%|▏         | 67/5000 [01:00<55:50,  1.47it/s]  1%|▏         | 68/5000 [01:01<57:08,  1.44it/s]  1%|▏         | 69/5000 [01:02<56:28,  1.46it/s]  1%|▏         | 70/5000 [01:03<57:57,  1.42it/s]  1%|▏         | 71/5000 [01:03<58:17,  1.41it/s]  1%|▏         | 72/5000 [01:04<1:01:22,  1.34it/s]  1%|▏         | 73/5000 [01:05<1:02:23,  1.32it/s]  1%|▏         | 74/5000 [01:06<1:05:25,  1.25it/s]  2%|▏         | 75/5000 [01:07<1:07:11,  1.22it/s]  2%|▏         | 76/5000 [01:07<1:06:31,  1.23it/s]  2%|▏         | 77/5000 [01:08<1:04:35,  1.27it/s]  2%|▏         | 78/5000 [01:09<1:04:34,  1.27it/s]  2%|▏         | 79/5000 [01:10<1:01:08,  1.34it/s]  2%|▏         | 80/5000 [01:10<1:01:22,  1.34it/s]  2%|▏         | 81/5000 [01:11<1:00:32,  1.35it/s]  2%|▏         | 82/5000 [01:12<1:03:32,  1.29it/s]  2%|▏         | 83/5000 [01:13<1:04:39,  1.27it/s]  2%|▏         | 84/5000 [01:14<1:06:34,  1.23it/s]  2%|▏         | 85/5000 [01:14<1:06:24,  1.23it/s]  2%|▏         | 86/5000 [01:15<1:07:45,  1.21it/s]  2%|▏         | 87/5000 [01:16<1:05:03,  1.26it/s]  2%|▏         | 88/5000 [01:17<1:02:02,  1.32it/s]  2%|▏         | 89/5000 [01:17<1:00:21,  1.36it/s]  2%|▏         | 90/5000 [01:18<58:18,  1.40it/s]    2%|▏         | 91/5000 [01:19<58:48,  1.39it/s]  2%|▏         | 92/5000 [01:19<58:02,  1.41it/s]  2%|▏         | 93/5000 [01:20<58:25,  1.40it/s]  2%|▏         | 94/5000 [01:21<58:00,  1.41it/s]  2%|▏         | 95/5000 [01:22<58:36,  1.39it/s]  2%|▏         | 96/5000 [01:22<57:46,  1.41it/s]  2%|▏         | 97/5000 [01:23<58:45,  1.39it/s]  2%|▏         | 98/5000 [01:24<58:25,  1.40it/s]  2%|▏         | 99/5000 [01:24<58:50,  1.39it/s]  2%|▏         | 100/5000 [01:25<59:10,  1.38it/s]  2%|▏         | 101/5000 [01:26<58:23,  1.40it/s]  2%|▏         | 102/5000 [01:27<58:38,  1.39it/s]  2%|▏         | 103/5000 [01:27<56:25,  1.45it/s]  2%|▏         | 104/5000 [01:28<56:10,  1.45it/s]  2%|▏         | 105/5000 [01:29<57:34,  1.42it/s]  2%|▏         | 106/5000 [01:30<1:00:07,  1.36it/s]  2%|▏         | 107/5000 [01:30<1:00:20,  1.35it/s]  2%|▏         | 108/5000 [01:31<57:40,  1.41it/s]    2%|▏         | 109/5000 [01:32<1:00:15,  1.35it/s]  2%|▏         | 110/5000 [01:33<1:01:42,  1.32it/s]  2%|▏         | 111/5000 [01:33<1:03:38,  1.28it/s]  2%|▏         | 112/5000 [01:34<1:01:24,  1.33it/s]  2%|▏         | 113/5000 [01:35<1:00:02,  1.36it/s]  2%|▏         | 114/5000 [01:35<59:21,  1.37it/s]    2%|▏         | 115/5000 [01:36<59:22,  1.37it/s]  2%|▏         | 116/5000 [01:37<58:31,  1.39it/s]  2%|▏         | 117/5000 [01:38<1:02:55,  1.29it/s]  2%|▏         | 118/5000 [01:39<1:05:31,  1.24it/s]  2%|▏         | 119/5000 [01:39<1:01:05,  1.33it/s]  2%|▏         | 120/5000 [01:40<58:46,  1.38it/s]    2%|▏         | 121/5000 [01:41<1:00:40,  1.34it/s]  2%|▏         | 122/5000 [01:41<58:36,  1.39it/s]    2%|▏         | 123/5000 [01:42<56:26,  1.44it/s]  2%|▏         | 124/5000 [01:43<55:37,  1.46it/s]  2%|▎         | 125/5000 [01:43<54:53,  1.48it/s]  3%|▎         | 126/5000 [01:44<53:53,  1.51it/s]  3%|▎         | 127/5000 [01:45<54:00,  1.50it/s]  3%|▎         | 128/5000 [01:45<53:58,  1.50it/s]  3%|▎         | 129/5000 [01:46<53:04,  1.53it/s]  3%|▎         | 130/5000 [01:47<54:56,  1.48it/s]  3%|▎         | 131/5000 [01:47<56:02,  1.45it/s]  3%|▎         | 132/5000 [01:48<54:36,  1.49it/s]  3%|▎         | 133/5000 [01:49<54:56,  1.48it/s]  3%|▎         | 134/5000 [01:49<55:08,  1.47it/s]  3%|▎         | 135/5000 [01:50<54:37,  1.48it/s]  3%|▎         | 136/5000 [01:51<54:24,  1.49it/s]  3%|▎         | 137/5000 [01:51<53:35,  1.51it/s]  3%|▎         | 138/5000 [01:52<54:48,  1.48it/s]  3%|▎         | 139/5000 [01:53<56:08,  1.44it/s]  3%|▎         | 140/5000 [01:53<55:54,  1.45it/s]  3%|▎         | 141/5000 [01:54<56:55,  1.42it/s]  3%|▎         | 142/5000 [01:55<56:55,  1.42it/s]  3%|▎         | 143/5000 [01:56<57:48,  1.40it/s]  3%|▎         | 144/5000 [01:56<1:00:31,  1.34it/s]  3%|▎         | 145/5000 [01:57<1:00:21,  1.34it/s]  3%|▎         | 146/5000 [01:58<58:41,  1.38it/s]    3%|▎         | 147/5000 [01:59<59:09,  1.37it/s]  3%|▎         | 148/5000 [01:59<57:42,  1.40it/s]  3%|▎         | 149/5000 [02:00<56:59,  1.42it/s]  3%|▎         | 150/5000 [02:01<58:52,  1.37it/s]  3%|▎         | 151/5000 [02:02<1:01:47,  1.31it/s]  3%|▎         | 152/5000 [02:02<1:03:40,  1.27it/s]  3%|▎         | 153/5000 [02:03<1:07:09,  1.20it/s]  3%|▎         | 154/5000 [02:04<1:07:54,  1.19it/s]  3%|▎         | 155/5000 [02:05<1:05:57,  1.22it/s]  3%|▎         | 156/5000 [02:06<1:03:37,  1.27it/s]  3%|▎         | 157/5000 [02:07<1:09:56,  1.15it/s]  3%|▎         | 158/5000 [02:07<1:05:09,  1.24it/s]  3%|▎         | 159/5000 [02:08<1:05:09,  1.24it/s]  3%|▎         | 160/5000 [02:09<1:06:48,  1.21it/s]  3%|▎         | 161/5000 [02:10<1:08:24,  1.18it/s]  3%|▎         | 162/5000 [02:11<1:04:23,  1.25it/s]  3%|▎         | 163/5000 [02:11<1:02:20,  1.29it/s]  3%|▎         | 164/5000 [02:12<1:00:37,  1.33it/s]  3%|▎         | 165/5000 [02:13<58:31,  1.38it/s]    3%|▎         | 166/5000 [02:14<58:12,  1.38it/s]  3%|▎         | 167/5000 [02:14<57:04,  1.41it/s]  3%|▎         | 168/5000 [02:15<57:09,  1.41it/s]  3%|▎         | 169/5000 [02:16<58:44,  1.37it/s]  3%|▎         | 170/5000 [02:17<1:05:15,  1.23it/s]  3%|▎         | 171/5000 [02:18<1:10:39,  1.14it/s]  3%|▎         | 172/5000 [02:19<1:15:15,  1.07it/s]  3%|▎         | 173/5000 [02:20<1:21:34,  1.01s/it]  3%|▎         | 174/5000 [02:21<1:22:56,  1.03s/it]  4%|▎         | 175/5000 [02:22<1:26:32,  1.08s/it]  4%|▎         | 176/5000 [02:23<1:27:22,  1.09s/it]  4%|▎         | 177/5000 [02:25<1:29:16,  1.11s/it]  4%|▎         | 178/5000 [02:25<1:24:41,  1.05s/it]  4%|▎         | 179/5000 [02:26<1:14:38,  1.08it/s]  4%|▎         | 180/5000 [02:27<1:10:23,  1.14it/s]  4%|▎         | 181/5000 [02:28<1:06:46,  1.20it/s]  4%|▎         | 182/5000 [02:28<1:03:55,  1.26it/s]  4%|▎         | 183/5000 [02:29<1:02:14,  1.29it/s]  4%|▎         | 184/5000 [02:30<59:52,  1.34it/s]    4%|▎         | 185/5000 [02:30<59:02,  1.36it/s]  4%|▎         | 186/5000 [02:31<58:00,  1.38it/s]  4%|▎         | 187/5000 [02:32<58:34,  1.37it/s]  4%|▍         | 188/5000 [02:33<56:52,  1.41it/s]  4%|▍         | 189/5000 [02:33<1:00:17,  1.33it/s]  4%|▍         | 190/5000 [02:34<1:00:11,  1.33it/s]  4%|▍         | 191/5000 [02:35<59:49,  1.34it/s]    4%|▍         | 192/5000 [02:36<58:34,  1.37it/s]  4%|▍         | 193/5000 [02:36<58:56,  1.36it/s]  4%|▍         | 194/5000 [02:37<58:44,  1.36it/s]  4%|▍         | 195/5000 [02:38<58:15,  1.37it/s]  4%|▍         | 196/5000 [02:38<58:20,  1.37it/s]  4%|▍         | 197/5000 [02:39<57:32,  1.39it/s]  4%|▍         | 198/5000 [02:40<1:01:26,  1.30it/s]  4%|▍         | 199/5000 [02:41<1:05:02,  1.23it/s]  4%|▍         | 200/5000 [02:42<1:02:42,  1.28it/s]  4%|▍         | 201/5000 [02:42<1:00:12,  1.33it/s]  4%|▍         | 202/5000 [02:43<59:23,  1.35it/s]    4%|▍         | 203/5000 [02:44<58:14,  1.37it/s]  4%|▍         | 204/5000 [02:44<56:31,  1.41it/s]  4%|▍         | 205/5000 [02:45<56:39,  1.41it/s]  4%|▍         | 206/5000 [02:46<55:23,  1.44it/s]  4%|▍         | 207/5000 [02:47<55:52,  1.43it/s]  4%|▍         | 208/5000 [02:47<56:02,  1.43it/s]  4%|▍         | 209/5000 [02:48<55:11,  1.45it/s]  4%|▍         | 210/5000 [02:49<55:13,  1.45it/s]  4%|▍         | 211/5000 [02:49<54:19,  1.47it/s]  4%|▍         | 212/5000 [02:50<54:45,  1.46it/s]  4%|▍         | 213/5000 [02:51<55:37,  1.43it/s]  4%|▍         | 214/5000 [02:51<55:03,  1.45it/s]  4%|▍         | 215/5000 [02:52<55:29,  1.44it/s]  4%|▍         | 216/5000 [02:53<53:17,  1.50it/s]  4%|▍         | 217/5000 [02:53<54:39,  1.46it/s]  4%|▍         | 218/5000 [02:54<55:41,  1.43it/s]  4%|▍         | 219/5000 [02:55<56:12,  1.42it/s]  4%|▍         | 220/5000 [02:56<57:07,  1.39it/s]  4%|▍         | 221/5000 [02:56<56:26,  1.41it/s]  4%|▍         | 222/5000 [02:57<56:34,  1.41it/s]  4%|▍         | 223/5000 [02:58<56:12,  1.42it/s]  4%|▍         | 224/5000 [02:58<56:55,  1.40it/s]  4%|▍         | 225/5000 [02:59<56:42,  1.40it/s]  5%|▍         | 226/5000 [03:00<57:11,  1.39it/s]  5%|▍         | 227/5000 [03:01<56:53,  1.40it/s]  5%|▍         | 228/5000 [03:01<57:14,  1.39it/s]  5%|▍         | 229/5000 [03:02<56:59,  1.40it/s]  5%|▍         | 230/5000 [03:03<55:43,  1.43it/s]  5%|▍         | 231/5000 [03:03<55:18,  1.44it/s]  5%|▍         | 232/5000 [03:04<54:34,  1.46it/s]  5%|▍         | 233/5000 [03:05<55:45,  1.42it/s]  5%|▍         | 234/5000 [03:05<56:20,  1.41it/s]  5%|▍         | 235/5000 [03:06<57:00,  1.39it/s]  5%|▍         | 236/5000 [03:07<55:25,  1.43it/s]  5%|▍         | 237/5000 [03:08<55:31,  1.43it/s]  5%|▍         | 238/5000 [03:08<54:36,  1.45it/s]  5%|▍         | 239/5000 [03:09<54:51,  1.45it/s]  5%|▍         | 240/5000 [03:10<55:02,  1.44it/s]  5%|▍         | 241/5000 [03:10<54:43,  1.45it/s]  5%|▍         | 242/5000 [03:11<55:37,  1.43it/s]  5%|▍         | 243/5000 [03:12<54:28,  1.46it/s]  5%|▍         | 244/5000 [03:12<54:55,  1.44it/s]  5%|▍         | 245/5000 [03:13<53:53,  1.47it/s]  5%|▍         | 246/5000 [03:14<52:41,  1.50it/s]  5%|▍         | 247/5000 [03:14<53:47,  1.47it/s]  5%|▍         | 248/5000 [03:15<53:48,  1.47it/s]  5%|▍         | 249/5000 [03:16<54:50,  1.44it/s]  5%|▌         | 250/5000 [03:17<55:48,  1.42it/s]  5%|▌         | 251/5000 [03:17<54:52,  1.44it/s]  5%|▌         | 252/5000 [03:18<55:46,  1.42it/s]  5%|▌         | 253/5000 [03:19<54:47,  1.44it/s]  5%|▌         | 254/5000 [03:19<56:27,  1.40it/s]  5%|▌         | 255/5000 [03:20<57:13,  1.38it/s]  5%|▌         | 256/5000 [03:21<57:36,  1.37it/s]  5%|▌         | 257/5000 [03:22<57:19,  1.38it/s]  5%|▌         | 258/5000 [03:22<55:52,  1.41it/s]  5%|▌         | 259/5000 [03:23<56:10,  1.41it/s]  5%|▌         | 260/5000 [03:24<54:31,  1.45it/s]  5%|▌         | 261/5000 [03:24<54:45,  1.44it/s]  5%|▌         | 262/5000 [03:25<57:19,  1.38it/s]  5%|▌         | 263/5000 [03:26<55:14,  1.43it/s]  5%|▌         | 264/5000 [03:26<55:32,  1.42it/s]  5%|▌         | 265/5000 [03:27<54:41,  1.44it/s]  5%|▌         | 266/5000 [03:28<55:13,  1.43it/s]  5%|▌         | 267/5000 [03:29<55:43,  1.42it/s]  5%|▌         | 268/5000 [03:29<57:34,  1.37it/s]  5%|▌         | 269/5000 [03:30<57:20,  1.38it/s]  5%|▌         | 270/5000 [03:31<57:42,  1.37it/s]  5%|▌         | 271/5000 [03:32<57:44,  1.37it/s]  5%|▌         | 272/5000 [03:32<1:00:07,  1.31it/s]  5%|▌         | 273/5000 [03:33<1:00:29,  1.30it/s]  5%|▌         | 274/5000 [03:34<58:42,  1.34it/s]    6%|▌         | 275/5000 [03:35<58:20,  1.35it/s]  6%|▌         | 276/5000 [03:35<57:48,  1.36it/s]  6%|▌         | 277/5000 [03:36<57:04,  1.38it/s]  6%|▌         | 278/5000 [03:37<56:33,  1.39it/s]  6%|▌         | 279/5000 [03:37<54:41,  1.44it/s]  6%|▌         | 280/5000 [03:38<54:49,  1.44it/s]  6%|▌         | 281/5000 [03:39<54:15,  1.45it/s]  6%|▌         | 282/5000 [03:39<53:34,  1.47it/s]  6%|▌         | 282/5000 [03:40<1:01:29,  1.28it/s]
AUC:  0.7723958333333333 LOGlOSS:  0.3890268472146558 test_AUC:  0.7571291839899287 test_LOGlOSS:  0.4222620476058486
Time:  220.98408465692773
{'model_opt': {'latent_dim': 16, 'feat_num': 647, 'field_num': 10, 'mlp_dropout': 0.0, 'use_bn': False, 'mlp_dims': [1024, 512, 256], 'cross': 3}, 'dataset': 'coat', 'model': 'IPS-CTR', 'data_dir': 'data/coat/tfrecord', 'cuda': 2, 'source': None}
==================================================
|          IPS-CTR: Set the random seed          |
==================================================

==================================================
|            IPS-CTR: Estimate pscore            |
==================================================

==================================================
|               IPS-CTR: Training                |
==================================================

######### trainer ###########
lr: 0.0003 l2: 0.001 bs: 16
  0%|          | 0/5000 [00:00<?, ?it/s]  0%|          | 1/5000 [00:00<1:14:28,  1.12it/s]  0%|          | 2/5000 [00:01<1:10:08,  1.19it/s]  0%|          | 3/5000 [00:02<1:14:00,  1.13it/s]  0%|          | 4/5000 [00:03<1:12:50,  1.14it/s]  0%|          | 5/5000 [00:04<1:11:07,  1.17it/s]  0%|          | 6/5000 [00:05<1:10:39,  1.18it/s]  0%|          | 7/5000 [00:06<1:11:26,  1.16it/s]  0%|          | 8/5000 [00:06<1:09:56,  1.19it/s]  0%|          | 9/5000 [00:07<1:10:31,  1.18it/s]  0%|          | 10/5000 [00:08<1:09:00,  1.21it/s]  0%|          | 11/5000 [00:09<1:12:21,  1.15it/s]  0%|          | 12/5000 [00:10<1:14:03,  1.12it/s]  0%|          | 13/5000 [00:11<1:16:25,  1.09it/s]  0%|          | 14/5000 [00:12<1:18:13,  1.06it/s]  0%|          | 15/5000 [00:13<1:19:47,  1.04it/s]  0%|          | 16/5000 [00:14<1:20:55,  1.03it/s]  0%|          | 17/5000 [00:15<1:23:54,  1.01s/it]  0%|          | 18/5000 [00:16<1:26:57,  1.05s/it]  0%|          | 19/5000 [00:17<1:29:56,  1.08s/it]  0%|          | 20/5000 [00:18<1:33:15,  1.12s/it]  0%|          | 21/5000 [00:19<1:30:07,  1.09s/it]  0%|          | 22/5000 [00:21<1:29:18,  1.08s/it]  0%|          | 23/5000 [00:22<1:28:43,  1.07s/it]  0%|          | 24/5000 [00:23<1:31:15,  1.10s/it]  0%|          | 25/5000 [00:24<1:27:01,  1.05s/it]  0%|          | 25/5000 [00:25<1:23:41,  1.01s/it]
AUC:  0.7684244791666667 LOGlOSS:  0.38550379053786615 test_AUC:  0.7562135001923344 test_LOGlOSS:  0.4234824616113215
Time:  25.669939463958144
{'model_opt': {'latent_dim': 16, 'feat_num': 647, 'field_num': 10, 'mlp_dropout': 0.0, 'use_bn': False, 'mlp_dims': [1024, 512, 256], 'cross': 3}, 'dataset': 'coat', 'model': 'Refine-CTR', 'data_dir': 'data/coat/tfrecord', 'cuda': 2, 'source': None}
==================================================
|        Refine-CTR: Set the random seed         |
==================================================

==================================================
|              Refine-CTR: Training              |
==================================================

######### trainer ###########
beta1 0.9996178935078028 lr: 0.0003 l2: 3e-05 bs: 16
  0%|          | 0/5000 [00:00<?, ?it/s]  0%|          | 1/5000 [00:02<2:58:26,  2.14s/it]  0%|          | 2/5000 [00:04<2:55:22,  2.11s/it]  0%|          | 3/5000 [00:06<2:52:00,  2.07s/it]  0%|          | 4/5000 [00:08<2:51:21,  2.06s/it]  0%|          | 5/5000 [00:10<2:50:51,  2.05s/it]  0%|          | 6/5000 [00:12<2:50:11,  2.04s/it]  0%|          | 6/5000 [00:14<3:19:27,  2.40s/it]
AUC:  0.7981770833333333 LOGlOSS:  0.7904121152772134 test_AUC:  0.7502053881392721 test_LOGlOSS:  0.8108397142174072
Time:  14.864517552079633
{'model_opt': {'latent_dim': 16, 'feat_num': 647, 'field_num': 10, 'mlp_dropout': 0.0, 'use_bn': True, 'mlp_dims': [1024, 512, 256], 'cross': 3}, 'dataset': 'coat', 'model': 'UDIPS-CTR', 'data_dir': 'data/coat/tfrecord', 'cuda': 2, 'source': None}
==================================================
|         UDIPS-CTR: Set the random seed         |
==================================================

==================================================
|           UDIPS-CTR: Estimate pscore           |
==================================================

==================================================
|              UDIPS-CTR: Training               |
==================================================

######### trainer ###########
beta1 0.49253114811924753 lr: 0.0001 l2: 0.001 bs: 16
  0%|          | 0/5000 [00:00<?, ?it/s]  0%|          | 1/5000 [00:01<1:38:09,  1.18s/it]  0%|          | 2/5000 [00:02<1:37:55,  1.18s/it]  0%|          | 3/5000 [00:03<1:40:13,  1.20s/it]  0%|          | 4/5000 [00:04<1:42:22,  1.23s/it]  0%|          | 5/5000 [00:06<1:41:46,  1.22s/it]  0%|          | 6/5000 [00:07<1:43:02,  1.24s/it]  0%|          | 7/5000 [00:08<1:42:08,  1.23s/it]  0%|          | 8/5000 [00:09<1:40:13,  1.20s/it]  0%|          | 9/5000 [00:10<1:37:20,  1.17s/it]  0%|          | 10/5000 [00:11<1:37:07,  1.17s/it]  0%|          | 11/5000 [00:13<1:36:28,  1.16s/it]  0%|          | 12/5000 [00:14<1:38:44,  1.19s/it]  0%|          | 13/5000 [00:15<1:39:09,  1.19s/it]  0%|          | 14/5000 [00:16<1:40:25,  1.21s/it]  0%|          | 15/5000 [00:18<1:40:41,  1.21s/it]  0%|          | 16/5000 [00:19<1:38:12,  1.18s/it]  0%|          | 17/5000 [00:20<1:38:43,  1.19s/it]  0%|          | 18/5000 [00:21<1:37:25,  1.17s/it]  0%|          | 19/5000 [00:22<1:38:20,  1.18s/it]  0%|          | 20/5000 [00:23<1:39:01,  1.19s/it]  0%|          | 21/5000 [00:25<1:38:48,  1.19s/it]  0%|          | 22/5000 [00:26<1:36:29,  1.16s/it]  0%|          | 23/5000 [00:27<1:36:32,  1.16s/it]  0%|          | 24/5000 [00:28<1:35:16,  1.15s/it]  0%|          | 25/5000 [00:29<1:36:06,  1.16s/it]  1%|          | 26/5000 [00:30<1:35:17,  1.15s/it]  1%|          | 27/5000 [00:31<1:35:56,  1.16s/it]  1%|          | 28/5000 [00:33<1:35:27,  1.15s/it]  1%|          | 29/5000 [00:34<1:36:04,  1.16s/it]  1%|          | 30/5000 [00:35<1:34:22,  1.14s/it]  1%|          | 31/5000 [00:36<1:34:29,  1.14s/it]  1%|          | 32/5000 [00:37<1:34:12,  1.14s/it]  1%|          | 33/5000 [00:38<1:33:31,  1.13s/it]  1%|          | 34/5000 [00:39<1:34:40,  1.14s/it]  1%|          | 35/5000 [00:41<1:34:21,  1.14s/it]  1%|          | 36/5000 [00:42<1:35:15,  1.15s/it]  1%|          | 37/5000 [00:43<1:35:09,  1.15s/it]  1%|          | 38/5000 [00:44<1:35:52,  1.16s/it]  1%|          | 39/5000 [00:45<1:35:16,  1.15s/it]  1%|          | 40/5000 [00:46<1:35:43,  1.16s/it]  1%|          | 41/5000 [00:47<1:35:05,  1.15s/it]  1%|          | 42/5000 [00:49<1:36:51,  1.17s/it]  1%|          | 43/5000 [00:50<1:38:01,  1.19s/it]  1%|          | 44/5000 [00:51<1:38:14,  1.19s/it]  1%|          | 45/5000 [00:52<1:36:46,  1.17s/it]  1%|          | 46/5000 [00:53<1:35:43,  1.16s/it]  1%|          | 47/5000 [00:54<1:29:22,  1.08s/it]  1%|          | 48/5000 [00:55<1:26:23,  1.05s/it]  1%|          | 49/5000 [00:56<1:22:59,  1.01s/it]  1%|          | 50/5000 [00:57<1:22:03,  1.01it/s]  1%|          | 51/5000 [00:58<1:20:10,  1.03it/s]  1%|          | 52/5000 [00:59<1:21:19,  1.01it/s]  1%|          | 53/5000 [01:00<1:28:30,  1.07s/it]  1%|          | 54/5000 [01:02<1:34:11,  1.14s/it]  1%|          | 55/5000 [01:03<1:34:08,  1.14s/it]  1%|          | 56/5000 [01:04<1:35:29,  1.16s/it]  1%|          | 57/5000 [01:05<1:38:12,  1.19s/it]  1%|          | 58/5000 [01:06<1:39:03,  1.20s/it]  1%|          | 59/5000 [01:08<1:38:48,  1.20s/it]  1%|          | 60/5000 [01:09<1:38:58,  1.20s/it]  1%|          | 61/5000 [01:10<1:37:06,  1.18s/it]  1%|          | 62/5000 [01:11<1:37:53,  1.19s/it]  1%|▏         | 63/5000 [01:12<1:38:41,  1.20s/it]  1%|▏         | 64/5000 [01:14<1:39:38,  1.21s/it]  1%|▏         | 65/5000 [01:15<1:39:39,  1.21s/it]  1%|▏         | 66/5000 [01:16<1:39:16,  1.21s/it]  1%|▏         | 67/5000 [01:17<1:38:55,  1.20s/it]  1%|▏         | 68/5000 [01:18<1:38:04,  1.19s/it]  1%|▏         | 69/5000 [01:20<1:38:58,  1.20s/it]  1%|▏         | 70/5000 [01:21<1:37:07,  1.18s/it]  1%|▏         | 71/5000 [01:22<1:37:32,  1.19s/it]  1%|▏         | 72/5000 [01:23<1:38:09,  1.20s/it]  1%|▏         | 73/5000 [01:24<1:39:24,  1.21s/it]  1%|▏         | 74/5000 [01:26<1:41:17,  1.23s/it]  2%|▏         | 75/5000 [01:27<1:42:27,  1.25s/it]  2%|▏         | 76/5000 [01:28<1:38:28,  1.20s/it]  2%|▏         | 77/5000 [01:29<1:32:50,  1.13s/it]  2%|▏         | 78/5000 [01:30<1:35:37,  1.17s/it]  2%|▏         | 79/5000 [01:31<1:34:26,  1.15s/it]  2%|▏         | 80/5000 [01:33<1:32:20,  1.13s/it]  2%|▏         | 81/5000 [01:34<1:33:02,  1.13s/it]  2%|▏         | 82/5000 [01:35<1:32:34,  1.13s/it]  2%|▏         | 83/5000 [01:36<1:34:14,  1.15s/it]  2%|▏         | 84/5000 [01:37<1:32:44,  1.13s/it]  2%|▏         | 85/5000 [01:38<1:33:25,  1.14s/it]  2%|▏         | 86/5000 [01:39<1:32:52,  1.13s/it]  2%|▏         | 87/5000 [01:41<1:34:46,  1.16s/it]  2%|▏         | 88/5000 [01:42<1:33:13,  1.14s/it]  2%|▏         | 89/5000 [01:43<1:33:56,  1.15s/it]  2%|▏         | 90/5000 [01:44<1:35:43,  1.17s/it]  2%|▏         | 91/5000 [01:45<1:39:30,  1.22s/it]  2%|▏         | 92/5000 [01:47<1:39:52,  1.22s/it]  2%|▏         | 93/5000 [01:48<1:41:08,  1.24s/it]  2%|▏         | 94/5000 [01:49<1:45:12,  1.29s/it]  2%|▏         | 95/5000 [01:51<1:48:12,  1.32s/it]  2%|▏         | 96/5000 [01:52<1:49:10,  1.34s/it]  2%|▏         | 97/5000 [01:53<1:46:52,  1.31s/it]  2%|▏         | 98/5000 [01:54<1:40:39,  1.23s/it]  2%|▏         | 99/5000 [01:55<1:33:43,  1.15s/it]  2%|▏         | 100/5000 [01:56<1:29:26,  1.10s/it]  2%|▏         | 101/5000 [01:57<1:29:03,  1.09s/it]  2%|▏         | 102/5000 [01:58<1:25:42,  1.05s/it]  2%|▏         | 103/5000 [01:59<1:24:17,  1.03s/it]  2%|▏         | 104/5000 [02:00<1:22:07,  1.01s/it]  2%|▏         | 105/5000 [02:01<1:22:20,  1.01s/it]  2%|▏         | 106/5000 [02:02<1:23:56,  1.03s/it]  2%|▏         | 106/5000 [02:03<1:35:17,  1.17s/it]
AUC:  0.7756184895833333  LOGlOSS:  0.3891051426951963 test_AUC:  0.755747394864027 test_LOGlOSS:  0.42516918040112983
Time:  124.27779294503853
{'model_opt': {'latent_dim': 16, 'feat_num': 647, 'field_num': 10, 'mlp_dropout': 0.0, 'use_bn': False, 'mlp_dims': [1024, 512, 256], 'cross': 3}, 'dataset': 'coat', 'model': 'bias_BASE-CTR', 'data_dir': 'data/coat/tfrecord', 'cuda': 2, 'source': 'bias'}
==================================================
|         BASE-CTR: Set the random seed          |
==================================================

==================================================
|               BASE-CTR: Training               |
==================================================

######### trainer ###########
lr: 0.0003 l2: 0.001 bs: 16
  0%|          | 0/5000 [00:00<?, ?it/s]  0%|          | 1/5000 [00:00<47:16,  1.76it/s]  0%|          | 2/5000 [00:01<46:42,  1.78it/s]  0%|          | 3/5000 [00:01<47:12,  1.76it/s]  0%|          | 4/5000 [00:02<46:18,  1.80it/s]  0%|          | 5/5000 [00:02<47:10,  1.76it/s]  0%|          | 6/5000 [00:03<49:05,  1.70it/s]  0%|          | 7/5000 [00:03<47:36,  1.75it/s]  0%|          | 8/5000 [00:04<48:04,  1.73it/s]  0%|          | 9/5000 [00:05<48:15,  1.72it/s]  0%|          | 10/5000 [00:05<46:42,  1.78it/s]  0%|          | 11/5000 [00:06<50:22,  1.65it/s]  0%|          | 12/5000 [00:07<53:46,  1.55it/s]  0%|          | 13/5000 [00:07<58:34,  1.42it/s]  0%|          | 14/5000 [00:08<1:04:16,  1.29it/s]  0%|          | 15/5000 [00:09<1:10:04,  1.19it/s]  0%|          | 16/5000 [00:10<1:13:03,  1.14it/s]  0%|          | 17/5000 [00:11<1:16:34,  1.08it/s]  0%|          | 18/5000 [00:12<1:16:19,  1.09it/s]  0%|          | 19/5000 [00:13<1:14:06,  1.12it/s]  0%|          | 20/5000 [00:14<1:12:07,  1.15it/s]  0%|          | 21/5000 [00:15<1:10:26,  1.18it/s]  0%|          | 22/5000 [00:16<1:10:13,  1.18it/s]  0%|          | 23/5000 [00:16<1:11:15,  1.16it/s]  0%|          | 24/5000 [00:17<1:04:13,  1.29it/s]  0%|          | 25/5000 [00:18<59:46,  1.39it/s]    1%|          | 26/5000 [00:18<55:21,  1.50it/s]  1%|          | 27/5000 [00:19<54:58,  1.51it/s]  1%|          | 28/5000 [00:19<54:24,  1.52it/s]  1%|          | 29/5000 [00:20<54:08,  1.53it/s]  1%|          | 30/5000 [00:21<53:11,  1.56it/s]  1%|          | 31/5000 [00:21<54:33,  1.52it/s]  1%|          | 32/5000 [00:22<53:42,  1.54it/s]  1%|          | 33/5000 [00:23<54:27,  1.52it/s]  1%|          | 34/5000 [00:23<55:06,  1.50it/s]  1%|          | 35/5000 [00:24<56:50,  1.46it/s]  1%|          | 36/5000 [00:25<57:18,  1.44it/s]  1%|          | 37/5000 [00:26<56:04,  1.47it/s]  1%|          | 38/5000 [00:26<54:49,  1.51it/s]  1%|          | 38/5000 [00:27<59:25,  1.39it/s]
AUC:  0.7719075520833334 LOGlOSS:  0.3927363706579189 test_AUC:  0.7574182842629333 test_LOGlOSS:  0.42481153992928833
Time:  27.668227556045167
{'model_opt': {'latent_dim': 16, 'feat_num': 647, 'field_num': 10, 'mlp_dropout': 0.0, 'use_bn': False, 'mlp_dims': [1024, 512, 256], 'cross': 3}, 'dataset': 'coat', 'model': 'combine_BASE-CTR', 'data_dir': 'data/coat/tfrecord', 'cuda': 2, 'source': 'combine'}
==================================================
|         BASE-CTR: Set the random seed          |
==================================================

==================================================
|               BASE-CTR: Training               |
==================================================

######### trainer ###########
lr: 0.001 l2: 0.0003 bs: 16
  0%|          | 0/5000 [00:00<?, ?it/s]  0%|          | 1/5000 [00:00<1:01:36,  1.35it/s]  0%|          | 2/5000 [00:01<1:02:01,  1.34it/s]  0%|          | 3/5000 [00:02<1:03:10,  1.32it/s]  0%|          | 4/5000 [00:03<1:04:26,  1.29it/s]  0%|          | 5/5000 [00:03<59:45,  1.39it/s]    0%|          | 6/5000 [00:04<57:23,  1.45it/s]  0%|          | 7/5000 [00:04<55:29,  1.50it/s]  0%|          | 8/5000 [00:05<55:26,  1.50it/s]  0%|          | 9/5000 [00:06<53:55,  1.54it/s]  0%|          | 10/5000 [00:06<51:43,  1.61it/s]  0%|          | 11/5000 [00:07<52:04,  1.60it/s]  0%|          | 11/5000 [00:08<1:01:10,  1.36it/s]
AUC:  0.7893880208333331 LOGlOSS:  0.37511643376428655 test_AUC:  0.7578000786582682 test_LOGlOSS:  0.421074230455371
Time:  8.66785067494493
{'model_opt': {'latent_dim': 16, 'feat_num': 647, 'field_num': 10, 'mlp_dropout': 0.0, 'use_bn': False, 'mlp_dims': [1024, 512, 256], 'cross': 3}, 'dataset': 'coat', 'model': 'unif_BASE-CTR', 'data_dir': 'data/coat/tfrecord', 'cuda': 2, 'source': 'unif'}
==================================================
|         BASE-CTR: Set the random seed          |
==================================================

==================================================
|               BASE-CTR: Training               |
==================================================

######### trainer ###########
lr: 0.001 l2: 1e-06 bs: 16
  0%|          | 0/5000 [00:00<?, ?it/s]  0%|          | 2/5000 [00:00<05:20, 15.59it/s]  0%|          | 4/5000 [00:00<05:27, 15.25it/s]  0%|          | 6/5000 [00:00<05:22, 15.47it/s]  0%|          | 8/5000 [00:00<05:36, 14.82it/s]  0%|          | 10/5000 [00:00<05:50, 14.23it/s]  0%|          | 12/5000 [00:00<05:41, 14.61it/s]  0%|          | 14/5000 [00:00<05:48, 14.31it/s]  0%|          | 16/5000 [00:01<05:47, 14.34it/s]  0%|          | 18/5000 [00:01<05:50, 14.21it/s]  0%|          | 20/5000 [00:01<05:37, 14.77it/s]  0%|          | 22/5000 [00:01<05:28, 15.15it/s]  0%|          | 25/5000 [00:01<04:46, 17.39it/s]  1%|          | 26/5000 [00:01<05:27, 15.20it/s]
AUC:  0.682763671875 LOGlOSS:  0.4506630971521448 test_AUC:  0.616556751078198 test_LOGlOSS:  0.5093283961800972
Time:  1.9428535950137302
