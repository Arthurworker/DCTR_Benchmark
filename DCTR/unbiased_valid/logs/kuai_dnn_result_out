nohup: ignoring input
2024-07-26 08:29:18.399929: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2024-07-26 08:29:21.412431: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-07-26 08:29:21.412568: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-07-26 08:29:21.413237: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:1e:00.0 name: Tesla V100-SXM2-32GB computeCapability: 7.0
coreClock: 1.53GHz coreCount: 80 deviceMemorySize: 31.74GiB deviceMemoryBandwidth: 836.37GiB/s
2024-07-26 08:29:21.413271: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2024-07-26 08:29:21.413324: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2024-07-26 08:29:21.413348: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2024-07-26 08:29:21.446849: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-07-26 08:29:21.447297: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-07-26 08:29:21.447437: W tensorflow/stream_executor/platform/default/dso_loader.cc:60] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /lib/x86_64-linux-gnu:/usr/lib/x86_64-linux-gnu::/usr/local/cuda-11.7/lib64
2024-07-26 08:29:21.448350: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2024-07-26 08:29:21.448418: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2024-07-26 08:29:21.448429: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1757] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2024-07-26 08:29:21.448773: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX512F
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-07-26 08:29:21.454910: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-07-26 08:29:21.454944: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-07-26 08:29:21.454953: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      
2024-07-26 08:29:21.516803: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-07-26 08:29:21.536659: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2500000000 Hz
{'model_opt': {'latent_dim': 16, 'feat_num': 41388, 'field_num': 88, 'mlp_dropout': 0.0, 'use_bn': False, 'mlp_dims': [1024, 512, 256], 'cross': 3}, 'dataset': 'kuairand', 'model': 'TJR-CTR', 'data_dir': 'data/kuairand/threshold_2', 'cuda': 1, 'source': None}
==================================================
|          TJR-CTR: Set the random seed          |
==================================================

==================================================
|               TJR-CTR: Training                |
==================================================

######### trainer ###########
alpha1 0.09344992730157253 alpha2 0.1 lr: 1e-05 l2: 0.0001 bs: 512
  0%|          | 0/5000 [00:00<?, ?it/s]  0%|          | 1/5000 [00:14<20:17:26, 14.61s/it]  0%|          | 2/5000 [00:28<19:26:01, 14.00s/it]  0%|          | 3/5000 [00:40<18:18:44, 13.19s/it]  0%|          | 4/5000 [00:54<18:41:14, 13.47s/it]  0%|          | 5/5000 [01:07<18:48:01, 13.55s/it]  0%|          | 6/5000 [01:22<19:27:46, 14.03s/it]  0%|          | 7/5000 [01:37<19:49:23, 14.29s/it]  0%|          | 8/5000 [01:51<19:30:55, 14.07s/it]  0%|          | 9/5000 [02:04<19:17:05, 13.91s/it]  0%|          | 10/5000 [02:18<19:08:06, 13.80s/it]  0%|          | 11/5000 [02:32<19:02:07, 13.74s/it]  0%|          | 12/5000 [02:44<18:23:38, 13.28s/it]  0%|          | 13/5000 [02:56<17:52:25, 12.90s/it]  0%|          | 14/5000 [03:08<17:30:46, 12.64s/it]  0%|          | 15/5000 [03:20<17:10:54, 12.41s/it]  0%|          | 15/5000 [03:33<19:41:11, 14.22s/it]
AUC:  0.7086245435056251 LOGlOSS:  0.4389797651740878 test_AUC:  0.7073859400030789 test_LOGlOSS:  0.4416064563137272
Time:  245.5400601211004
{'model_opt': {'latent_dim': 16, 'feat_num': 41388, 'field_num': 88, 'mlp_dropout': 0.0, 'use_bn': False, 'mlp_dims': [1024, 512, 256], 'cross': 3}, 'dataset': 'kuairand', 'model': 'Bridge-CTR', 'data_dir': 'data/kuairand/threshold_2', 'cuda': 1, 'source': None}
==================================================
|        Bridge-CTR: Set the random seed         |
==================================================

==================================================
|              Bridge-CTR: Training              |
==================================================

######### trainer ###########
alpha1 1 lr: 3e-05 l2: 0.001 bs: 256
  0%|          | 0/5000 [00:00<?, ?it/s]  0%|          | 1/5000 [00:18<25:34:35, 18.42s/it]  0%|          | 2/5000 [00:37<26:11:03, 18.86s/it]  0%|          | 3/5000 [00:55<25:50:47, 18.62s/it]  0%|          | 4/5000 [01:12<24:58:27, 18.00s/it]  0%|          | 5/5000 [01:29<23:59:57, 17.30s/it]  0%|          | 6/5000 [01:45<23:29:28, 16.93s/it]  0%|          | 7/5000 [02:02<23:25:56, 16.89s/it]  0%|          | 8/5000 [02:18<23:20:19, 16.83s/it]  0%|          | 9/5000 [02:35<23:12:58, 16.75s/it]  0%|          | 10/5000 [02:52<23:12:58, 16.75s/it]  0%|          | 11/5000 [03:08<23:04:00, 16.64s/it]  0%|          | 12/5000 [03:24<22:57:45, 16.57s/it]  0%|          | 13/5000 [03:39<22:14:30, 16.06s/it]  0%|          | 14/5000 [03:54<21:41:54, 15.67s/it]  0%|          | 15/5000 [04:09<21:15:35, 15.35s/it]  0%|          | 16/5000 [04:25<21:27:47, 15.50s/it]  0%|          | 17/5000 [04:41<21:40:10, 15.66s/it]  0%|          | 18/5000 [04:57<22:03:28, 15.94s/it]  0%|          | 19/5000 [05:13<22:09:21, 16.01s/it]  0%|          | 20/5000 [05:28<21:37:52, 15.64s/it]  0%|          | 21/5000 [05:44<21:56:15, 15.86s/it]  0%|          | 22/5000 [06:01<22:07:04, 16.00s/it]  0%|          | 23/5000 [06:17<22:23:18, 16.19s/it]  0%|          | 24/5000 [06:35<22:57:14, 16.61s/it]  0%|          | 25/5000 [06:51<22:35:41, 16.35s/it]  1%|          | 26/5000 [07:08<22:54:49, 16.58s/it]  1%|          | 27/5000 [07:24<22:51:20, 16.55s/it]  1%|          | 28/5000 [07:40<22:39:36, 16.41s/it]  1%|          | 29/5000 [07:56<22:31:06, 16.31s/it]  1%|          | 30/5000 [08:11<21:55:07, 15.88s/it]  1%|          | 31/5000 [08:26<21:31:01, 15.59s/it]  1%|          | 32/5000 [08:43<21:50:07, 15.82s/it]  1%|          | 33/5000 [08:57<21:26:12, 15.54s/it]  1%|          | 34/5000 [09:13<21:36:20, 15.66s/it]  1%|          | 35/5000 [09:28<21:16:33, 15.43s/it]  1%|          | 36/5000 [09:43<20:50:52, 15.12s/it]  1%|          | 37/5000 [09:58<21:04:22, 15.29s/it]  1%|          | 38/5000 [10:13<20:56:26, 15.19s/it]  1%|          | 39/5000 [10:30<21:21:25, 15.50s/it]  1%|          | 40/5000 [10:44<21:00:35, 15.25s/it]  1%|          | 41/5000 [10:59<20:46:08, 15.08s/it]  1%|          | 42/5000 [11:14<20:45:10, 15.07s/it]  1%|          | 43/5000 [11:29<20:40:59, 15.02s/it]  1%|          | 44/5000 [11:45<21:09:47, 15.37s/it]  1%|          | 45/5000 [12:01<21:27:32, 15.59s/it]  1%|          | 46/5000 [12:16<21:09:29, 15.38s/it]  1%|          | 47/5000 [12:31<20:54:31, 15.20s/it]  1%|          | 48/5000 [12:46<20:45:41, 15.09s/it]  1%|          | 49/5000 [13:00<20:36:48, 14.99s/it]  1%|          | 50/5000 [13:16<21:02:39, 15.30s/it]  1%|          | 51/5000 [13:33<21:27:21, 15.61s/it]  1%|          | 52/5000 [13:49<21:40:08, 15.77s/it]  1%|          | 53/5000 [14:04<21:14:21, 15.46s/it]  1%|          | 54/5000 [14:18<20:58:43, 15.27s/it]  1%|          | 55/5000 [14:33<20:48:44, 15.15s/it]  1%|          | 56/5000 [14:48<20:41:29, 15.07s/it]  1%|          | 57/5000 [15:04<21:08:49, 15.40s/it]  1%|          | 58/5000 [15:21<21:33:58, 15.71s/it]  1%|          | 59/5000 [15:37<21:39:09, 15.78s/it]  1%|          | 60/5000 [15:51<21:12:19, 15.45s/it]  1%|          | 61/5000 [16:06<20:54:06, 15.24s/it]  1%|          | 62/5000 [16:21<20:40:43, 15.08s/it]  1%|▏         | 63/5000 [16:36<20:30:10, 14.95s/it]  1%|▏         | 63/5000 [16:50<22:00:11, 16.04s/it]
AUC:  0.695339383490012 LOGlOSS:  0.4474980961347161 test_AUC:  0.6929738654648392 test_LOGlOSS:  0.44981315820447115
Time:  1033.9904501029523
{'model_opt': {'latent_dim': 16, 'feat_num': 41388, 'field_num': 88, 'mlp_dropout': 0.0, 'use_bn': False, 'mlp_dims': [1024, 512, 256], 'cross': 3}, 'dataset': 'kuairand', 'model': 'CausE-CTR', 'data_dir': 'data/kuairand/threshold_2', 'cuda': 1, 'source': None}
==================================================
|         CausE-CTR: Set the random seed         |
==================================================

==================================================
|              CausE-CTR: Training               |
==================================================

######### trainer ###########
alpha1 0.1 lr: 3e-05 l2: 0.001 bs: 1024
  0%|          | 0/5000 [00:00<?, ?it/s]  0%|          | 1/5000 [00:03<4:33:27,  3.28s/it]  0%|          | 2/5000 [00:06<4:33:33,  3.28s/it]  0%|          | 3/5000 [00:09<4:35:38,  3.31s/it]  0%|          | 4/5000 [00:12<4:27:07,  3.21s/it]  0%|          | 5/5000 [00:15<4:21:41,  3.14s/it]  0%|          | 6/5000 [00:19<4:26:05,  3.20s/it]  0%|          | 7/5000 [00:22<4:23:37,  3.17s/it]  0%|          | 8/5000 [00:25<4:19:56,  3.12s/it]  0%|          | 9/5000 [00:27<3:49:58,  2.76s/it]  0%|          | 10/5000 [00:29<3:30:29,  2.53s/it]  0%|          | 11/5000 [00:31<3:13:28,  2.33s/it]  0%|          | 12/5000 [00:33<3:01:35,  2.18s/it]  0%|          | 12/5000 [00:35<4:02:31,  2.92s/it]
AUC:  0.707629020600957 LOGlOSS:  0.596573755492536 test_AUC:  0.7044940444303647 test_LOGlOSS:  0.5982908703599163
Time:  57.31115729699377
{'model_opt': {'latent_dim': 16, 'feat_num': 41388, 'field_num': 88, 'mlp_dropout': 0.0, 'use_bn': False, 'mlp_dims': [1024, 512, 256], 'cross': 3}, 'dataset': 'kuairand', 'model': 'DR-CTR', 'data_dir': 'data/kuairand/threshold_2', 'cuda': 1, 'source': None}
==================================================
|          DR-CTR: Set the random seed           |
==================================================

==================================================
|            DR-CTR: Estimate pscore             |
==================================================

==================================================
|                DR-CTR: Training                |
==================================================

######### trainer ###########
beta1 0.05680176583916549 lr: 3e-05 l2: 0.0003 bs: 256
  0%|          | 0/5000 [00:00<?, ?it/s]  0%|          | 1/5000 [00:22<31:53:09, 22.96s/it]  0%|          | 2/5000 [00:45<31:55:39, 23.00s/it]  0%|          | 3/5000 [01:07<30:51:19, 22.23s/it]  0%|          | 4/5000 [01:28<30:13:17, 21.78s/it]  0%|          | 5/5000 [01:49<30:03:59, 21.67s/it]  0%|          | 6/5000 [02:11<29:52:29, 21.54s/it]  0%|          | 6/5000 [02:32<35:15:07, 25.41s/it]
AUC:  0.6747205059838196 LOGlOSS:  0.5351082034312915 test_AUC:  0.6725131535812803 test_LOGlOSS:  0.5374295050496821
Time:  177.7228270029882
{'model_opt': {'latent_dim': 16, 'feat_num': 41388, 'field_num': 88, 'mlp_dropout': 0.0, 'use_bn': False, 'mlp_dims': [1024, 512, 256], 'cross': 3}, 'dataset': 'kuairand', 'model': 'DRJL-CTR', 'data_dir': 'data/kuairand/threshold_2', 'cuda': 1, 'source': None}
==================================================
|         DRJL-CTR: Set the random seed          |
==================================================

==================================================
|           DRJL-CTR: Estimate pscore            |
==================================================

==================================================
|               DRJL-CTR: Training               |
==================================================

######### trainer ###########
beta1 0.19689148676578624 lr: 1e-05 l2: 0.0001 bs: 256
  0%|          | 0/5000 [00:00<?, ?it/s]  0%|          | 1/5000 [00:27<37:47:16, 27.21s/it]  0%|          | 2/5000 [00:54<37:49:55, 27.25s/it]  0%|          | 3/5000 [01:21<37:51:08, 27.27s/it]  0%|          | 4/5000 [01:48<37:35:38, 27.09s/it]  0%|          | 5/5000 [02:15<37:41:00, 27.16s/it]  0%|          | 6/5000 [02:42<37:39:19, 27.14s/it]  0%|          | 7/5000 [03:09<37:32:48, 27.07s/it]  0%|          | 8/5000 [03:37<37:41:40, 27.18s/it]  0%|          | 9/5000 [04:04<37:49:19, 27.28s/it]  0%|          | 10/5000 [04:32<37:54:32, 27.35s/it]  0%|          | 11/5000 [04:59<37:57:05, 27.39s/it]  0%|          | 12/5000 [05:27<37:58:40, 27.41s/it]  0%|          | 13/5000 [05:54<37:51:14, 27.33s/it]  0%|          | 14/5000 [06:21<37:56:03, 27.39s/it]  0%|          | 15/5000 [06:49<37:59:11, 27.43s/it]  0%|          | 16/5000 [07:17<38:01:36, 27.47s/it]  0%|          | 17/5000 [07:46<38:39:50, 27.93s/it]  0%|          | 18/5000 [08:14<38:56:06, 28.13s/it]  0%|          | 19/5000 [08:40<37:53:02, 27.38s/it]  0%|          | 19/5000 [09:06<39:46:19, 28.75s/it]
AUC:  0.647526256522235 LOGlOSS:  0.7056903486789132 test_AUC:  0.6457160957196392 test_LOGlOSS:  0.7061865152394278
Time:  571.6849786319071
{'model_opt': {'latent_dim': 16, 'feat_num': 41388, 'field_num': 88, 'mlp_dropout': 0.0, 'use_bn': False, 'mlp_dims': [1024, 512, 256], 'cross': 3}, 'dataset': 'kuairand', 'model': 'IDIPS-CTR', 'data_dir': 'data/kuairand/threshold_2', 'cuda': 1, 'source': None}
==================================================
|         IDIPS-CTR: Set the random seed         |
==================================================

==================================================
|           IDIPS-CTR: Estimate pscore           |
==================================================

==================================================
|              IDIPS-CTR: Training               |
==================================================

######### trainer ###########
beta1 0.010767541071132935 lr: 3e-05 l2: 0.0001 bs: 1024
  0%|          | 0/5000 [00:00<?, ?it/s]  0%|          | 1/5000 [00:03<4:39:56,  3.36s/it]  0%|          | 2/5000 [00:06<4:31:22,  3.26s/it]  0%|          | 3/5000 [00:10<4:40:18,  3.37s/it]  0%|          | 4/5000 [00:13<4:32:12,  3.27s/it]  0%|          | 5/5000 [00:16<4:28:07,  3.22s/it]  0%|          | 6/5000 [00:19<4:25:06,  3.19s/it]  0%|          | 7/5000 [00:21<3:52:40,  2.80s/it]  0%|          | 8/5000 [00:23<3:31:26,  2.54s/it]  0%|          | 9/5000 [00:25<3:17:31,  2.37s/it]  0%|          | 10/5000 [00:27<3:09:30,  2.28s/it]  0%|          | 10/5000 [00:29<4:05:11,  2.95s/it]
AUC:  0.6551061576352162 LOGlOSS:  0.6354673757611154 test_AUC:  0.6534177911014203 test_LOGlOSS:  0.6363148967471062
Time:  56.30580640700646
{'model_opt': {'latent_dim': 16, 'feat_num': 41388, 'field_num': 88, 'mlp_dropout': 0.0, 'use_bn': False, 'mlp_dims': [1024, 512, 256], 'cross': 3}, 'dataset': 'kuairand', 'model': 'IPS-CTR', 'data_dir': 'data/kuairand/threshold_2', 'cuda': 1, 'source': None}
==================================================
|          IPS-CTR: Set the random seed          |
==================================================

==================================================
|            IPS-CTR: Estimate pscore            |
==================================================

==================================================
|               IPS-CTR: Training                |
==================================================

######### trainer ###########
lr: 3e-05 l2: 0.0003 bs: 256
  0%|          | 0/5000 [00:00<?, ?it/s]  0%|          | 1/5000 [00:08<11:25:15,  8.22s/it]  0%|          | 2/5000 [00:16<11:35:09,  8.35s/it]  0%|          | 3/5000 [00:24<11:18:45,  8.15s/it]  0%|          | 4/5000 [00:32<11:23:44,  8.21s/it]  0%|          | 5/5000 [00:39<10:23:58,  7.50s/it]  0%|          | 6/5000 [00:43<9:09:09,  6.60s/it]   0%|          | 7/5000 [00:48<8:19:22,  6.00s/it]  0%|          | 8/5000 [00:53<7:49:49,  5.65s/it]  0%|          | 8/5000 [00:58<10:08:40,  7.32s/it]
AUC:  0.6542939935092539 LOGlOSS:  0.46244715136718334 test_AUC:  0.6525115779692237 test_LOGlOSS:  0.4644668687813023
Time:  82.96743401198182
{'model_opt': {'latent_dim': 16, 'feat_num': 41388, 'field_num': 88, 'mlp_dropout': 0.0, 'use_bn': False, 'mlp_dims': [1024, 512, 256], 'cross': 3}, 'dataset': 'kuairand', 'model': 'Refine-CTR', 'data_dir': 'data/kuairand/threshold_2', 'cuda': 1, 'source': None}
==================================================
|        Refine-CTR: Set the random seed         |
==================================================

==================================================
|              Refine-CTR: Training              |
==================================================

######### trainer ###########
beta1 0.9997821958020031 lr: 3e-05 l2: 0.0003 bs: 512
  0%|          | 0/5000 [00:00<?, ?it/s]  0%|          | 1/5000 [00:07<10:54:12,  7.85s/it]  0%|          | 2/5000 [00:15<10:46:53,  7.77s/it]  0%|          | 3/5000 [00:23<10:37:33,  7.66s/it]  0%|          | 4/5000 [00:30<10:25:30,  7.51s/it]  0%|          | 5/5000 [00:38<10:36:59,  7.65s/it]  0%|          | 6/5000 [00:46<10:42:42,  7.72s/it]  0%|          | 7/5000 [00:53<10:36:53,  7.65s/it]  0%|          | 8/5000 [01:01<10:40:34,  7.70s/it]  0%|          | 9/5000 [01:09<10:39:38,  7.69s/it]  0%|          | 10/5000 [01:16<10:33:17,  7.61s/it]  0%|          | 11/5000 [01:24<10:35:26,  7.64s/it]  0%|          | 12/5000 [01:31<10:29:54,  7.58s/it]  0%|          | 13/5000 [01:39<10:28:45,  7.56s/it]  0%|          | 14/5000 [01:46<10:30:03,  7.58s/it]  0%|          | 15/5000 [01:54<10:21:34,  7.48s/it]  0%|          | 16/5000 [02:01<10:21:10,  7.48s/it]  0%|          | 17/5000 [02:09<10:22:19,  7.49s/it]  0%|          | 18/5000 [02:17<10:35:58,  7.66s/it]  0%|          | 19/5000 [02:24<10:37:35,  7.68s/it]  0%|          | 20/5000 [02:32<10:36:32,  7.67s/it]  0%|          | 21/5000 [02:39<10:28:39,  7.58s/it]  0%|          | 22/5000 [02:47<10:21:20,  7.49s/it]  0%|          | 23/5000 [02:54<10:18:43,  7.46s/it]  0%|          | 24/5000 [03:02<10:25:17,  7.54s/it]  0%|          | 25/5000 [03:09<10:20:36,  7.48s/it]  1%|          | 26/5000 [03:16<10:16:04,  7.43s/it]  1%|          | 27/5000 [03:24<10:11:24,  7.38s/it]  1%|          | 28/5000 [03:31<10:09:25,  7.35s/it]  1%|          | 29/5000 [03:39<10:14:28,  7.42s/it]  1%|          | 30/5000 [03:46<10:18:05,  7.46s/it]  1%|          | 31/5000 [03:53<10:14:14,  7.42s/it]  1%|          | 32/5000 [04:01<10:10:26,  7.37s/it]  1%|          | 33/5000 [04:08<10:07:48,  7.34s/it]  1%|          | 34/5000 [04:15<10:05:44,  7.32s/it]  1%|          | 35/5000 [04:22<10:04:01,  7.30s/it]  1%|          | 36/5000 [04:30<10:09:59,  7.37s/it]  1%|          | 37/5000 [04:37<10:12:02,  7.40s/it]  1%|          | 38/5000 [04:45<10:13:57,  7.42s/it]  1%|          | 39/5000 [04:52<10:07:16,  7.34s/it]  1%|          | 40/5000 [04:59<10:03:19,  7.30s/it]  1%|          | 41/5000 [05:07<10:02:23,  7.29s/it]  1%|          | 42/5000 [05:14<10:01:55,  7.28s/it]  1%|          | 43/5000 [05:21<10:09:25,  7.38s/it]  1%|          | 44/5000 [05:29<10:07:47,  7.36s/it]  1%|          | 45/5000 [05:36<10:12:24,  7.42s/it]  1%|          | 46/5000 [05:44<10:14:54,  7.45s/it]  1%|          | 47/5000 [05:51<10:16:40,  7.47s/it]  1%|          | 48/5000 [05:59<10:13:11,  7.43s/it]  1%|          | 49/5000 [06:06<10:10:33,  7.40s/it]  1%|          | 50/5000 [06:13<10:08:12,  7.37s/it]  1%|          | 51/5000 [06:21<10:06:40,  7.36s/it]  1%|          | 52/5000 [06:28<10:05:24,  7.34s/it]  1%|          | 53/5000 [06:35<10:04:31,  7.33s/it]  1%|          | 54/5000 [06:43<10:03:50,  7.33s/it]  1%|          | 55/5000 [06:50<10:07:05,  7.37s/it]  1%|          | 56/5000 [06:58<10:09:14,  7.39s/it]  1%|          | 57/5000 [07:05<10:13:20,  7.44s/it]  1%|          | 58/5000 [07:12<10:12:08,  7.43s/it]  1%|          | 59/5000 [07:20<10:08:50,  7.39s/it]  1%|          | 60/5000 [07:27<10:08:05,  7.39s/it]  1%|          | 61/5000 [07:35<10:07:49,  7.38s/it]  1%|          | 62/5000 [07:42<10:06:24,  7.37s/it]  1%|▏         | 63/5000 [07:49<10:05:13,  7.36s/it]  1%|▏         | 64/5000 [07:57<10:04:30,  7.35s/it]  1%|▏         | 65/5000 [08:04<10:03:56,  7.34s/it]  1%|▏         | 66/5000 [08:11<10:03:46,  7.34s/it]  1%|▏         | 67/5000 [08:19<10:03:15,  7.34s/it]  1%|▏         | 68/5000 [08:26<10:04:04,  7.35s/it]  1%|▏         | 69/5000 [08:33<10:06:51,  7.38s/it]  1%|▏         | 70/5000 [08:41<10:09:21,  7.42s/it]  1%|▏         | 71/5000 [08:49<10:31:19,  7.69s/it]  1%|▏         | 72/5000 [08:57<10:36:07,  7.74s/it]  1%|▏         | 73/5000 [09:05<10:45:20,  7.86s/it]  1%|▏         | 74/5000 [09:13<10:37:24,  7.76s/it]  2%|▏         | 75/5000 [09:20<10:34:39,  7.73s/it]  2%|▏         | 76/5000 [09:28<10:35:26,  7.74s/it]  2%|▏         | 77/5000 [09:36<10:31:32,  7.70s/it]  2%|▏         | 78/5000 [09:42<9:59:21,  7.31s/it]   2%|▏         | 79/5000 [09:48<9:31:16,  6.97s/it]  2%|▏         | 80/5000 [09:56<9:56:34,  7.28s/it]  2%|▏         | 81/5000 [10:04<10:14:50,  7.50s/it]  2%|▏         | 82/5000 [10:12<10:17:01,  7.53s/it]  2%|▏         | 83/5000 [10:19<10:11:08,  7.46s/it]  2%|▏         | 84/5000 [10:27<10:17:28,  7.54s/it]  2%|▏         | 85/5000 [10:34<10:13:27,  7.49s/it]  2%|▏         | 86/5000 [10:42<10:08:58,  7.44s/it]  2%|▏         | 87/5000 [10:48<9:37:36,  7.05s/it]   2%|▏         | 88/5000 [10:54<9:26:13,  6.92s/it]  2%|▏         | 89/5000 [11:02<9:39:09,  7.08s/it]  2%|▏         | 90/5000 [11:08<9:16:36,  6.80s/it]  2%|▏         | 91/5000 [11:15<9:28:35,  6.95s/it]  2%|▏         | 92/5000 [11:23<9:44:51,  7.15s/it]  2%|▏         | 93/5000 [11:30<9:54:38,  7.27s/it]  2%|▏         | 94/5000 [11:38<9:54:50,  7.27s/it]  2%|▏         | 95/5000 [11:44<9:27:12,  6.94s/it]  2%|▏         | 96/5000 [11:50<9:07:34,  6.70s/it]  2%|▏         | 97/5000 [11:56<8:55:48,  6.56s/it]  2%|▏         | 98/5000 [12:03<8:50:27,  6.49s/it]  2%|▏         | 98/5000 [12:09<10:08:01,  7.44s/it]
AUC:  0.6969330273130289 LOGlOSS:  1.0650219727585892 test_AUC:  0.6946421289317188 test_LOGlOSS:  1.06425713593978
Time:  750.2090188859729
{'model_opt': {'latent_dim': 16, 'feat_num': 41388, 'field_num': 88, 'mlp_dropout': 0.0, 'use_bn': False, 'mlp_dims': [1024, 512, 256], 'cross': 3}, 'dataset': 'kuairand', 'model': 'UDIPS-CTR', 'data_dir': 'data/kuairand/threshold_2', 'cuda': 1, 'source': None}
==================================================
|         UDIPS-CTR: Set the random seed         |
==================================================

==================================================
|           UDIPS-CTR: Estimate pscore           |
==================================================

==================================================
|              UDIPS-CTR: Training               |
==================================================

######### trainer ###########
beta1 0.33912409291818957 lr: 3e-05 l2: 0.0001 bs: 1024
  0%|          | 0/5000 [00:00<?, ?it/s]  0%|          | 1/5000 [00:03<4:37:41,  3.33s/it]  0%|          | 2/5000 [00:06<4:34:36,  3.30s/it]  0%|          | 3/5000 [00:10<4:38:48,  3.35s/it]  0%|          | 4/5000 [00:13<4:35:28,  3.31s/it]  0%|          | 5/5000 [00:16<4:32:32,  3.27s/it]  0%|          | 6/5000 [00:19<4:32:17,  3.27s/it]  0%|          | 7/5000 [00:21<4:01:07,  2.90s/it]  0%|          | 8/5000 [00:23<3:38:38,  2.63s/it]  0%|          | 9/5000 [00:25<3:23:44,  2.45s/it]  0%|          | 10/5000 [00:27<3:10:42,  2.29s/it]  0%|          | 10/5000 [00:30<4:10:51,  3.02s/it]
AUC:  0.6553702379044719  LOGlOSS:  0.6393095205465723 test_AUC:  0.6536154849762108 test_LOGlOSS:  0.6401780020338352
Time:  56.331742005073465
{'model_opt': {'latent_dim': 16, 'feat_num': 41388, 'field_num': 88, 'mlp_dropout': 0.0, 'use_bn': False, 'mlp_dims': [1024, 512, 256], 'cross': 3}, 'dataset': 'kuairand', 'model': 'bias_BASE-CTR', 'data_dir': 'data/kuairand/threshold_2', 'cuda': 1, 'source': 'bias'}
==================================================
|         BASE-CTR: Set the random seed          |
==================================================

==================================================
|               BASE-CTR: Training               |
==================================================

######### trainer ###########
lr: 1e-05 l2: 0.0001 bs: 256
  0%|          | 0/5000 [00:00<?, ?it/s]  0%|          | 1/5000 [00:07<11:01:09,  7.94s/it]  0%|          | 2/5000 [00:15<10:45:35,  7.75s/it]  0%|          | 3/5000 [00:23<10:48:07,  7.78s/it]  0%|          | 4/5000 [00:31<10:51:56,  7.83s/it]  0%|          | 5/5000 [00:39<10:49:15,  7.80s/it]  0%|          | 6/5000 [00:46<10:48:17,  7.79s/it]  0%|          | 7/5000 [00:54<10:51:17,  7.83s/it]  0%|          | 8/5000 [01:03<11:06:54,  8.02s/it]  0%|          | 9/5000 [01:09<10:30:33,  7.58s/it]  0%|          | 10/5000 [01:16<10:05:46,  7.28s/it]  0%|          | 11/5000 [01:22<9:48:52,  7.08s/it]   0%|          | 12/5000 [01:30<10:06:36,  7.30s/it]  0%|          | 12/5000 [01:37<11:16:42,  8.14s/it]
AUC:  0.6555414713390313 LOGlOSS:  0.6553198568438198 test_AUC:  0.6536361944340839 test_LOGlOSS:  0.6561402350315706
Time:  116.98403093998786
{'model_opt': {'latent_dim': 16, 'feat_num': 41388, 'field_num': 88, 'mlp_dropout': 0.0, 'use_bn': False, 'mlp_dims': [1024, 512, 256], 'cross': 3}, 'dataset': 'kuairand', 'model': 'combine_BASE-CTR', 'data_dir': 'data/kuairand/threshold_2', 'cuda': 1, 'source': 'combine'}
==================================================
|         BASE-CTR: Set the random seed          |
==================================================

==================================================
|               BASE-CTR: Training               |
==================================================

######### trainer ###########
lr: 1e-05 l2: 0.001 bs: 256
  0%|          | 0/5000 [00:00<?, ?it/s]  0%|          | 1/5000 [00:10<14:42:41, 10.59s/it]  0%|          | 2/5000 [00:21<14:41:02, 10.58s/it]  0%|          | 3/5000 [00:31<14:39:54, 10.57s/it]  0%|          | 4/5000 [00:42<14:40:52, 10.58s/it]  0%|          | 5/5000 [00:52<14:41:42, 10.59s/it]  0%|          | 6/5000 [01:03<14:41:28, 10.59s/it]  0%|          | 7/5000 [01:14<14:39:59, 10.57s/it]  0%|          | 8/5000 [01:25<14:58:04, 10.79s/it]  0%|          | 9/5000 [01:38<16:06:30, 11.62s/it]  0%|          | 10/5000 [01:51<16:43:26, 12.07s/it]  0%|          | 11/5000 [02:04<17:00:41, 12.28s/it]  0%|          | 12/5000 [02:17<17:18:56, 12.50s/it]  0%|          | 13/5000 [02:30<17:24:55, 12.57s/it]  0%|          | 14/5000 [02:43<17:29:48, 12.63s/it]  0%|          | 15/5000 [02:55<17:31:44, 12.66s/it]  0%|          | 16/5000 [03:08<17:33:36, 12.68s/it]  0%|          | 17/5000 [03:19<16:58:31, 12.26s/it]  0%|          | 18/5000 [03:30<16:18:54, 11.79s/it]  0%|          | 19/5000 [03:41<16:02:55, 11.60s/it]  0%|          | 20/5000 [03:52<15:50:38, 11.45s/it]  0%|          | 21/5000 [04:03<15:34:50, 11.27s/it]  0%|          | 22/5000 [04:14<15:27:48, 11.18s/it]  0%|          | 23/5000 [04:25<15:22:26, 11.12s/it]  0%|          | 24/5000 [04:36<15:18:51, 11.08s/it]  0%|          | 25/5000 [04:47<15:16:43, 11.06s/it]  1%|          | 26/5000 [04:58<15:15:41, 11.05s/it]  1%|          | 27/5000 [05:09<15:10:02, 10.98s/it]  1%|          | 28/5000 [05:20<15:10:51, 10.99s/it]  1%|          | 29/5000 [05:31<15:14:37, 11.04s/it]  1%|          | 30/5000 [05:42<15:14:11, 11.04s/it]  1%|          | 31/5000 [05:53<15:13:54, 11.04s/it]  1%|          | 32/5000 [06:04<15:01:50, 10.89s/it]  1%|          | 33/5000 [06:14<14:53:15, 10.79s/it]  1%|          | 34/5000 [06:25<14:49:21, 10.75s/it]  1%|          | 35/5000 [06:35<14:41:12, 10.65s/it]  1%|          | 36/5000 [06:46<14:38:22, 10.62s/it]  1%|          | 37/5000 [06:56<14:38:04, 10.62s/it]  1%|          | 38/5000 [07:07<14:32:21, 10.55s/it]  1%|          | 39/5000 [07:17<14:31:25, 10.54s/it]  1%|          | 40/5000 [07:28<14:30:56, 10.54s/it]  1%|          | 41/5000 [07:39<14:32:45, 10.56s/it]  1%|          | 42/5000 [07:49<14:30:38, 10.54s/it]  1%|          | 43/5000 [08:00<14:29:58, 10.53s/it]  1%|          | 44/5000 [08:10<14:32:35, 10.56s/it]  1%|          | 45/5000 [08:21<14:31:17, 10.55s/it]  1%|          | 46/5000 [08:31<14:28:48, 10.52s/it]  1%|          | 47/5000 [08:42<14:30:07, 10.54s/it]  1%|          | 48/5000 [08:52<14:30:16, 10.54s/it]  1%|          | 49/5000 [09:03<14:29:45, 10.54s/it]  1%|          | 50/5000 [09:13<14:30:47, 10.56s/it]  1%|          | 51/5000 [09:24<14:30:36, 10.55s/it]  1%|          | 52/5000 [09:35<14:30:47, 10.56s/it]  1%|          | 53/5000 [09:45<14:30:58, 10.56s/it]  1%|          | 54/5000 [09:56<14:31:20, 10.57s/it]  1%|          | 55/5000 [10:06<14:32:25, 10.59s/it]  1%|          | 56/5000 [10:17<14:33:38, 10.60s/it]  1%|          | 57/5000 [10:28<14:32:50, 10.59s/it]  1%|          | 58/5000 [10:38<14:32:06, 10.59s/it]  1%|          | 59/5000 [10:49<14:31:23, 10.58s/it]  1%|          | 60/5000 [10:59<14:26:03, 10.52s/it]  1%|          | 61/5000 [11:09<14:16:51, 10.41s/it]  1%|          | 62/5000 [11:20<14:14:46, 10.39s/it]  1%|▏         | 63/5000 [11:30<14:18:00, 10.43s/it]  1%|▏         | 64/5000 [11:40<14:16:05, 10.41s/it]  1%|▏         | 65/5000 [11:51<14:10:23, 10.34s/it]  1%|▏         | 66/5000 [12:01<14:16:40, 10.42s/it]  1%|▏         | 67/5000 [12:12<14:19:57, 10.46s/it]  1%|▏         | 68/5000 [12:22<14:22:37, 10.49s/it]  1%|▏         | 69/5000 [12:33<14:24:01, 10.51s/it]  1%|▏         | 70/5000 [12:43<14:23:36, 10.51s/it]  1%|▏         | 71/5000 [12:54<14:25:14, 10.53s/it]  1%|▏         | 72/5000 [13:05<14:25:58, 10.54s/it]  1%|▏         | 73/5000 [13:15<14:25:17, 10.54s/it]  1%|▏         | 74/5000 [13:26<14:25:55, 10.55s/it]  2%|▏         | 75/5000 [13:36<14:26:14, 10.55s/it]  2%|▏         | 76/5000 [13:47<14:26:53, 10.56s/it]  2%|▏         | 77/5000 [13:57<14:26:59, 10.57s/it]  2%|▏         | 78/5000 [14:08<14:26:28, 10.56s/it]  2%|▏         | 79/5000 [14:18<14:25:53, 10.56s/it]  2%|▏         | 80/5000 [14:29<14:25:13, 10.55s/it]  2%|▏         | 81/5000 [14:39<14:23:20, 10.53s/it]  2%|▏         | 82/5000 [14:49<13:51:08, 10.14s/it]  2%|▏         | 83/5000 [14:59<14:01:26, 10.27s/it]  2%|▏         | 84/5000 [15:09<13:36:15,  9.96s/it]  2%|▏         | 85/5000 [15:19<13:49:18, 10.12s/it]  2%|▏         | 86/5000 [15:30<13:58:48, 10.24s/it]  2%|▏         | 87/5000 [15:40<14:06:34, 10.34s/it]  2%|▏         | 88/5000 [15:51<14:10:19, 10.39s/it]  2%|▏         | 89/5000 [16:01<14:12:25, 10.41s/it]  2%|▏         | 90/5000 [16:12<14:16:06, 10.46s/it]  2%|▏         | 91/5000 [16:22<14:14:05, 10.44s/it]  2%|▏         | 92/5000 [16:33<14:18:49, 10.50s/it]  2%|▏         | 93/5000 [16:42<13:56:39, 10.23s/it]  2%|▏         | 94/5000 [16:53<13:58:21, 10.25s/it]  2%|▏         | 95/5000 [17:02<13:27:49,  9.88s/it]  2%|▏         | 96/5000 [17:11<13:06:30,  9.62s/it]  2%|▏         | 97/5000 [17:17<11:57:26,  8.78s/it]  2%|▏         | 98/5000 [17:23<10:44:21,  7.89s/it]  2%|▏         | 98/5000 [17:29<14:34:53, 10.71s/it]
AUC:  0.7024070129808478 LOGlOSS:  0.4637065709207771 test_AUC:  0.7000840487361314 test_LOGlOSS:  0.46682747623645404
Time:  1077.3873782170704
{'model_opt': {'latent_dim': 16, 'feat_num': 41388, 'field_num': 88, 'mlp_dropout': 0.0, 'use_bn': False, 'mlp_dims': [1024, 512, 256], 'cross': 3}, 'dataset': 'kuairand', 'model': 'unif_BASE-CTR', 'data_dir': 'data/kuairand/threshold_2', 'cuda': 1, 'source': 'unif'}
==================================================
|         BASE-CTR: Set the random seed          |
==================================================

==================================================
|               BASE-CTR: Training               |
==================================================

######### trainer ###########
lr: 1e-05 l2: 0.001 bs: 512
  0%|          | 0/5000 [00:00<?, ?it/s]  0%|          | 1/5000 [00:02<3:51:28,  2.78s/it]  0%|          | 2/5000 [00:05<3:40:23,  2.65s/it]  0%|          | 3/5000 [00:07<3:37:09,  2.61s/it]  0%|          | 4/5000 [00:10<3:35:59,  2.59s/it]  0%|          | 5/5000 [00:13<3:40:44,  2.65s/it]  0%|          | 6/5000 [00:15<3:42:17,  2.67s/it]  0%|          | 7/5000 [00:18<3:39:25,  2.64s/it]  0%|          | 8/5000 [00:21<3:37:37,  2.62s/it]  0%|          | 9/5000 [00:23<3:36:29,  2.60s/it]  0%|          | 10/5000 [00:26<3:35:35,  2.59s/it]  0%|          | 11/5000 [00:28<3:35:23,  2.59s/it]  0%|          | 12/5000 [00:31<3:39:45,  2.64s/it]  0%|          | 13/5000 [00:34<3:37:28,  2.62s/it]  0%|          | 14/5000 [00:36<3:36:32,  2.61s/it]  0%|          | 15/5000 [00:39<3:35:45,  2.60s/it]  0%|          | 16/5000 [00:41<3:35:00,  2.59s/it]  0%|          | 17/5000 [00:44<3:34:18,  2.58s/it]  0%|          | 18/5000 [00:46<3:34:35,  2.58s/it]  0%|          | 19/5000 [00:49<3:35:30,  2.60s/it]  0%|          | 20/5000 [00:52<3:39:22,  2.64s/it]  0%|          | 21/5000 [00:54<3:37:59,  2.63s/it]  0%|          | 22/5000 [00:57<3:37:01,  2.62s/it]  0%|          | 23/5000 [01:00<3:36:39,  2.61s/it]  0%|          | 24/5000 [01:02<3:36:13,  2.61s/it]  0%|          | 25/5000 [01:05<3:35:28,  2.60s/it]  1%|          | 26/5000 [01:07<3:35:29,  2.60s/it]  1%|          | 27/5000 [01:10<3:35:33,  2.60s/it]  1%|          | 28/5000 [01:13<3:36:08,  2.61s/it]  1%|          | 29/5000 [01:15<3:40:20,  2.66s/it]  1%|          | 30/5000 [01:17<3:10:38,  2.30s/it]  1%|          | 31/5000 [01:18<2:49:46,  2.05s/it]  1%|          | 32/5000 [01:20<2:35:30,  1.88s/it]  1%|          | 33/5000 [01:21<2:25:12,  1.75s/it]  1%|          | 33/5000 [01:23<3:28:57,  2.52s/it]
AUC:  0.694020575143321 LOGlOSS:  0.43883372869854465 test_AUC:  0.6926914132671386 test_LOGlOSS:  0.4411441864522878
Time:  107.5960247090552
