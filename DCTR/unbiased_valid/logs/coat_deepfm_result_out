nohup: ignoring input
2024-07-25 12:13:19.765542: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2024-07-25 12:13:22.864194: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-07-25 12:13:22.864337: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-07-25 12:13:22.865018: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:20:00.0 name: Tesla V100-SXM2-32GB computeCapability: 7.0
coreClock: 1.53GHz coreCount: 80 deviceMemorySize: 31.74GiB deviceMemoryBandwidth: 836.37GiB/s
2024-07-25 12:13:22.865057: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2024-07-25 12:13:22.865109: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2024-07-25 12:13:22.865135: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2024-07-25 12:13:22.898617: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-07-25 12:13:22.899088: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-07-25 12:13:22.899239: W tensorflow/stream_executor/platform/default/dso_loader.cc:60] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /lib/x86_64-linux-gnu:/usr/lib/x86_64-linux-gnu::/usr/local/cuda-11.7/lib64
2024-07-25 12:13:22.900111: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2024-07-25 12:13:22.900186: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2024-07-25 12:13:22.900197: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1757] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2024-07-25 12:13:22.900565: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX512F
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-07-25 12:13:22.906477: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-07-25 12:13:22.906514: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-07-25 12:13:22.906522: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      
2024-07-25 12:13:22.977020: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-07-25 12:13:22.996652: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2500000000 Hz
{'model_opt': {'latent_dim': 16, 'feat_num': 647, 'field_num': 10, 'mlp_dropout': 0.0, 'use_bn': False, 'mlp_dims': [1024, 512, 256], 'cross': 3}, 'dataset': 'coat', 'model': 'TJR-CTR', 'data_dir': 'data/coat/tfrecord', 'cuda': 3, 'source': None}
==================================================
|          TJR-CTR: Set the random seed          |
==================================================

==================================================
|               TJR-CTR: Training                |
==================================================

######### trainer ###########
alpha1 0.0004230422096869425 alpha2 0.6 lr: 0.0003 l2: 1e-06 bs: 32
  0%|          | 0/5000 [00:00<?, ?it/s]  0%|          | 1/5000 [00:04<5:50:51,  4.21s/it]  0%|          | 2/5000 [00:07<5:14:11,  3.77s/it]  0%|          | 3/5000 [00:11<5:09:20,  3.71s/it]  0%|          | 4/5000 [00:14<5:01:01,  3.62s/it]  0%|          | 5/5000 [00:17<4:45:21,  3.43s/it]  0%|          | 6/5000 [00:20<4:14:39,  3.06s/it]  0%|          | 7/5000 [00:22<3:55:05,  2.83s/it]  0%|          | 8/5000 [00:24<3:42:21,  2.67s/it]  0%|          | 9/5000 [00:27<3:34:12,  2.58s/it]  0%|          | 10/5000 [00:29<3:29:34,  2.52s/it]  0%|          | 11/5000 [00:32<3:25:06,  2.47s/it]  0%|          | 12/5000 [00:34<3:25:01,  2.47s/it]  0%|          | 13/5000 [00:36<3:21:00,  2.42s/it]  0%|          | 14/5000 [00:39<3:19:02,  2.40s/it]  0%|          | 15/5000 [00:41<3:17:13,  2.37s/it]  0%|          | 16/5000 [00:43<3:15:39,  2.36s/it]  0%|          | 17/5000 [00:46<3:14:38,  2.34s/it]  0%|          | 17/5000 [00:48<3:56:10,  2.84s/it]
AUC:  0.8169596354166667 LOGlOSS:  0.3915588380715709 test_AUC:  0.7515519678698699 test_LOGlOSS:  0.48569263164052917
Time:  50.961005990975536
{'model_opt': {'latent_dim': 16, 'feat_num': 647, 'field_num': 10, 'mlp_dropout': 0.0, 'use_bn': False, 'mlp_dims': [1024, 512, 256], 'cross': 3}, 'dataset': 'coat', 'model': 'Bridge-CTR', 'data_dir': 'data/coat/tfrecord', 'cuda': 3, 'source': None}
==================================================
|        Bridge-CTR: Set the random seed         |
==================================================

==================================================
|              Bridge-CTR: Training              |
==================================================

######### trainer ###########
alpha1 1 lr: 0.001 l2: 3e-06 bs: 16
  0%|          | 0/5000 [00:00<?, ?it/s]  0%|          | 1/5000 [00:05<7:17:16,  5.25s/it]  0%|          | 2/5000 [00:11<7:53:18,  5.68s/it]  0%|          | 3/5000 [00:15<6:55:46,  4.99s/it]  0%|          | 4/5000 [00:19<6:34:20,  4.74s/it]  0%|          | 5/5000 [00:24<6:48:59,  4.91s/it]  0%|          | 5/5000 [00:30<8:20:32,  6.01s/it]
AUC:  0.814453125 LOGlOSS:  0.36131392741535134 test_AUC:  0.732945598849539 test_LOGlOSS:  0.44719683623286716
Time:  30.51077426003758
{'model_opt': {'latent_dim': 16, 'feat_num': 647, 'field_num': 10, 'mlp_dropout': 0.0, 'use_bn': True, 'mlp_dims': [1024, 512, 256], 'cross': 3}, 'dataset': 'coat', 'model': 'CausE-CTR', 'data_dir': 'data/coat/tfrecord', 'cuda': 3, 'source': None}
==================================================
|         CausE-CTR: Set the random seed         |
==================================================

==================================================
|              CausE-CTR: Training               |
==================================================

######### trainer ###########
alpha1 1 lr: 0.001 l2: 0.0001 bs: 32
  0%|          | 0/5000 [00:00<?, ?it/s]  0%|          | 1/5000 [00:01<2:10:45,  1.57s/it]  0%|          | 2/5000 [00:03<2:18:50,  1.67s/it]  0%|          | 3/5000 [00:04<2:12:28,  1.59s/it]  0%|          | 4/5000 [00:06<2:12:50,  1.60s/it]  0%|          | 5/5000 [00:07<2:10:22,  1.57s/it]  0%|          | 6/5000 [00:09<2:09:08,  1.55s/it]  0%|          | 7/5000 [00:11<2:10:41,  1.57s/it]  0%|          | 8/5000 [00:12<2:07:55,  1.54s/it]  0%|          | 9/5000 [00:14<2:08:40,  1.55s/it]  0%|          | 10/5000 [00:15<2:05:32,  1.51s/it]  0%|          | 11/5000 [00:16<1:57:37,  1.41s/it]  0%|          | 12/5000 [00:17<1:48:07,  1.30s/it]  0%|          | 13/5000 [00:18<1:40:32,  1.21s/it]  0%|          | 14/5000 [00:19<1:37:28,  1.17s/it]  0%|          | 15/5000 [00:20<1:34:32,  1.14s/it]  0%|          | 16/5000 [00:22<1:34:07,  1.13s/it]  0%|          | 17/5000 [00:23<1:45:26,  1.27s/it]  0%|          | 18/5000 [00:25<1:50:36,  1.33s/it]  0%|          | 19/5000 [00:26<1:53:50,  1.37s/it]  0%|          | 20/5000 [00:28<2:00:49,  1.46s/it]  0%|          | 21/5000 [00:29<1:55:05,  1.39s/it]  0%|          | 21/5000 [00:30<2:00:44,  1.46s/it]
AUC:  0.8164713541666667 LOGlOSS:  0.5083298696450463 test_AUC:  0.7174534649158735 test_LOGlOSS:  0.7676555784245381
Time:  31.03200274996925
{'model_opt': {'latent_dim': 16, 'feat_num': 647, 'field_num': 10, 'mlp_dropout': 0.0, 'use_bn': True, 'mlp_dims': [1024, 512, 256], 'cross': 3}, 'dataset': 'coat', 'model': 'DR-CTR', 'data_dir': 'data/coat/tfrecord', 'cuda': 3, 'source': None}
==================================================
|          DR-CTR: Set the random seed           |
==================================================

==================================================
|            DR-CTR: Estimate pscore             |
==================================================

==================================================
|                DR-CTR: Training                |
==================================================

######### trainer ###########
beta1 0.025287141259195567 lr: 0.0003 l2: 0.001 bs: 16
  0%|          | 0/5000 [00:00<?, ?it/s]  0%|          | 1/5000 [00:08<11:23:17,  8.20s/it]  0%|          | 2/5000 [00:15<10:17:31,  7.41s/it]  0%|          | 3/5000 [00:22<10:01:04,  7.22s/it]  0%|          | 4/5000 [00:29<9:56:09,  7.16s/it]   0%|          | 5/5000 [00:36<9:48:06,  7.06s/it]  0%|          | 6/5000 [00:42<9:41:47,  6.99s/it]  0%|          | 7/5000 [00:49<9:38:52,  6.96s/it]  0%|          | 8/5000 [00:56<9:36:38,  6.93s/it]  0%|          | 9/5000 [01:03<9:35:15,  6.92s/it]  0%|          | 10/5000 [01:10<9:44:46,  7.03s/it]  0%|          | 11/5000 [01:19<10:24:30,  7.51s/it]  0%|          | 11/5000 [01:26<10:53:09,  7.86s/it]
AUC:  0.78583984375 LOGlOSS:  0.37931895037388086 test_AUC:  0.7538259678631634 test_LOGlOSS:  0.4235322906950748
Time:  86.94100455299485
{'model_opt': {'latent_dim': 16, 'feat_num': 647, 'field_num': 10, 'mlp_dropout': 0.0, 'use_bn': False, 'mlp_dims': [1024, 512, 256], 'cross': 3}, 'dataset': 'coat', 'model': 'DRJL-CTR', 'data_dir': 'data/coat/tfrecord', 'cuda': 3, 'source': None}
==================================================
|         DRJL-CTR: Set the random seed          |
==================================================

==================================================
|           DRJL-CTR: Estimate pscore            |
==================================================

==================================================
|               DRJL-CTR: Training               |
==================================================

######### trainer ###########
beta1 0.6843801823004276 lr: 3e-05 l2: 0.001 bs: 64
  0%|          | 0/5000 [00:00<?, ?it/s]  0%|          | 1/5000 [00:02<2:48:36,  2.02s/it]  0%|          | 2/5000 [00:04<2:51:28,  2.06s/it]  0%|          | 3/5000 [00:06<2:46:32,  2.00s/it]  0%|          | 4/5000 [00:08<2:48:10,  2.02s/it]  0%|          | 5/5000 [00:10<2:48:55,  2.03s/it]  0%|          | 6/5000 [00:12<2:49:57,  2.04s/it]  0%|          | 7/5000 [00:14<2:50:41,  2.05s/it]  0%|          | 8/5000 [00:16<2:50:27,  2.05s/it]  0%|          | 9/5000 [00:18<2:46:00,  2.00s/it]  0%|          | 10/5000 [00:20<2:43:38,  1.97s/it]  0%|          | 11/5000 [00:21<2:39:52,  1.92s/it]  0%|          | 12/5000 [00:23<2:39:22,  1.92s/it]  0%|          | 13/5000 [00:25<2:37:33,  1.90s/it]  0%|          | 14/5000 [00:27<2:34:44,  1.86s/it]  0%|          | 15/5000 [00:29<2:29:58,  1.81s/it]  0%|          | 16/5000 [00:30<2:29:04,  1.79s/it]  0%|          | 17/5000 [00:32<2:36:03,  1.88s/it]  0%|          | 18/5000 [00:35<2:42:16,  1.95s/it]  0%|          | 19/5000 [00:37<2:44:33,  1.98s/it]  0%|          | 20/5000 [00:39<2:54:33,  2.10s/it]  0%|          | 21/5000 [00:42<3:09:29,  2.28s/it]  0%|          | 22/5000 [00:44<3:19:33,  2.41s/it]  0%|          | 23/5000 [00:47<3:27:03,  2.50s/it]  0%|          | 24/5000 [00:49<3:10:25,  2.30s/it]  0%|          | 25/5000 [00:51<2:57:19,  2.14s/it]  1%|          | 26/5000 [00:53<2:51:18,  2.07s/it]  1%|          | 27/5000 [00:55<2:51:11,  2.07s/it]  1%|          | 28/5000 [00:57<2:47:42,  2.02s/it]  1%|          | 29/5000 [00:58<2:43:54,  1.98s/it]  1%|          | 30/5000 [01:01<2:46:35,  2.01s/it]  1%|          | 31/5000 [01:03<2:48:12,  2.03s/it]  1%|          | 32/5000 [01:05<2:48:58,  2.04s/it]  1%|          | 33/5000 [01:07<2:50:12,  2.06s/it]  1%|          | 34/5000 [01:09<2:50:46,  2.06s/it]  1%|          | 35/5000 [01:11<2:51:13,  2.07s/it]  1%|          | 36/5000 [01:13<2:50:51,  2.07s/it]  1%|          | 37/5000 [01:15<2:51:19,  2.07s/it]  1%|          | 38/5000 [01:17<2:51:54,  2.08s/it]  1%|          | 39/5000 [01:19<2:49:16,  2.05s/it]  1%|          | 40/5000 [01:21<2:42:49,  1.97s/it]  1%|          | 41/5000 [01:23<2:39:29,  1.93s/it]  1%|          | 42/5000 [01:25<2:35:15,  1.88s/it]  1%|          | 43/5000 [01:26<2:33:57,  1.86s/it]  1%|          | 44/5000 [01:28<2:32:53,  1.85s/it]  1%|          | 45/5000 [01:30<2:37:12,  1.90s/it]  1%|          | 46/5000 [01:32<2:39:33,  1.93s/it]  1%|          | 47/5000 [01:34<2:36:10,  1.89s/it]  1%|          | 48/5000 [01:37<2:56:15,  2.14s/it]  1%|          | 49/5000 [01:40<3:11:22,  2.32s/it]  1%|          | 50/5000 [01:42<3:18:41,  2.41s/it]  1%|          | 51/5000 [01:44<3:13:57,  2.35s/it]  1%|          | 52/5000 [01:46<2:58:02,  2.16s/it]  1%|          | 53/5000 [01:48<2:48:04,  2.04s/it]  1%|          | 54/5000 [01:50<2:41:25,  1.96s/it]  1%|          | 55/5000 [01:51<2:36:54,  1.90s/it]  1%|          | 56/5000 [01:53<2:34:59,  1.88s/it]  1%|          | 57/5000 [01:55<2:33:08,  1.86s/it]  1%|          | 58/5000 [01:57<2:30:48,  1.83s/it]  1%|          | 59/5000 [01:59<2:30:17,  1.82s/it]  1%|          | 60/5000 [02:00<2:28:45,  1.81s/it]  1%|          | 61/5000 [02:02<2:28:58,  1.81s/it]  1%|          | 62/5000 [02:04<2:28:45,  1.81s/it]  1%|▏         | 63/5000 [02:06<2:28:23,  1.80s/it]  1%|▏         | 64/5000 [02:08<2:28:16,  1.80s/it]  1%|▏         | 65/5000 [02:09<2:28:14,  1.80s/it]  1%|▏         | 66/5000 [02:11<2:27:06,  1.79s/it]  1%|▏         | 67/5000 [02:13<2:27:20,  1.79s/it]  1%|▏         | 68/5000 [02:15<2:27:14,  1.79s/it]  1%|▏         | 69/5000 [02:16<2:27:26,  1.79s/it]  1%|▏         | 70/5000 [02:18<2:27:50,  1.80s/it]  1%|▏         | 71/5000 [02:20<2:26:46,  1.79s/it]  1%|▏         | 72/5000 [02:22<2:41:53,  1.97s/it]  1%|▏         | 73/5000 [02:25<3:00:42,  2.20s/it]  1%|▏         | 74/5000 [02:28<3:15:40,  2.38s/it]  2%|▏         | 75/5000 [02:30<3:14:44,  2.37s/it]  2%|▏         | 76/5000 [02:32<2:59:38,  2.19s/it]  2%|▏         | 77/5000 [02:34<2:50:05,  2.07s/it]  2%|▏         | 78/5000 [02:36<2:42:48,  1.98s/it]  2%|▏         | 79/5000 [02:37<2:38:13,  1.93s/it]  2%|▏         | 80/5000 [02:39<2:35:29,  1.90s/it]  2%|▏         | 81/5000 [02:41<2:31:51,  1.85s/it]  2%|▏         | 82/5000 [02:43<2:31:14,  1.85s/it]  2%|▏         | 83/5000 [02:45<2:30:16,  1.83s/it]  2%|▏         | 84/5000 [02:46<2:28:37,  1.81s/it]  2%|▏         | 85/5000 [02:48<2:28:09,  1.81s/it]  2%|▏         | 86/5000 [02:50<2:27:03,  1.80s/it]  2%|▏         | 87/5000 [02:52<2:27:17,  1.80s/it]  2%|▏         | 88/5000 [02:54<2:27:49,  1.81s/it]  2%|▏         | 89/5000 [02:55<2:27:00,  1.80s/it]  2%|▏         | 90/5000 [02:57<2:27:14,  1.80s/it]  2%|▏         | 91/5000 [02:59<2:27:25,  1.80s/it]  2%|▏         | 92/5000 [03:01<2:26:56,  1.80s/it]  2%|▏         | 93/5000 [03:03<2:27:38,  1.81s/it]  2%|▏         | 94/5000 [03:04<2:27:28,  1.80s/it]  2%|▏         | 95/5000 [03:06<2:27:11,  1.80s/it]  2%|▏         | 96/5000 [03:08<2:27:39,  1.81s/it]  2%|▏         | 97/5000 [03:10<2:29:24,  1.83s/it]  2%|▏         | 98/5000 [03:12<2:31:38,  1.86s/it]  2%|▏         | 99/5000 [03:14<2:36:16,  1.91s/it]  2%|▏         | 100/5000 [03:16<2:36:01,  1.91s/it]  2%|▏         | 101/5000 [03:18<2:53:45,  2.13s/it]  2%|▏         | 101/5000 [03:21<2:42:56,  2.00s/it]
AUC:  0.7571614583333334 LOGlOSS:  0.43743476237411727 test_AUC:  0.7453143959480932 test_LOGlOSS:  0.47301934314271143
Time:  201.96298248891253
{'model_opt': {'latent_dim': 16, 'feat_num': 647, 'field_num': 10, 'mlp_dropout': 0.0, 'use_bn': False, 'mlp_dims': [1024, 512, 256], 'cross': 3}, 'dataset': 'coat', 'model': 'IDIPS-CTR', 'data_dir': 'data/coat/tfrecord', 'cuda': 3, 'source': None}
==================================================
|         IDIPS-CTR: Set the random seed         |
==================================================

==================================================
|           IDIPS-CTR: Estimate pscore           |
==================================================

==================================================
|              IDIPS-CTR: Training               |
==================================================

######### trainer ###########
beta1 0.12056471831314505 lr: 0.0001 l2: 0.001 bs: 16
  0%|          | 0/5000 [00:00<?, ?it/s]  0%|          | 1/5000 [00:03<4:23:34,  3.16s/it]  0%|          | 2/5000 [00:05<3:58:11,  2.86s/it]  0%|          | 3/5000 [00:08<4:00:36,  2.89s/it]  0%|          | 4/5000 [00:11<3:57:14,  2.85s/it]  0%|          | 5/5000 [00:14<3:48:32,  2.75s/it]  0%|          | 6/5000 [00:16<3:44:04,  2.69s/it]  0%|          | 7/5000 [00:19<3:40:55,  2.65s/it]  0%|          | 8/5000 [00:21<3:40:36,  2.65s/it]  0%|          | 9/5000 [00:24<3:41:08,  2.66s/it]  0%|          | 10/5000 [00:27<3:39:25,  2.64s/it]  0%|          | 11/5000 [00:29<3:37:14,  2.61s/it]  0%|          | 12/5000 [00:32<3:36:36,  2.61s/it]  0%|          | 13/5000 [00:34<3:37:37,  2.62s/it]  0%|          | 14/5000 [00:37<3:36:58,  2.61s/it]  0%|          | 15/5000 [00:40<3:48:44,  2.75s/it]  0%|          | 16/5000 [00:43<3:59:26,  2.88s/it]  0%|          | 17/5000 [00:46<3:57:23,  2.86s/it]  0%|          | 18/5000 [00:49<3:48:42,  2.75s/it]  0%|          | 19/5000 [00:51<3:44:23,  2.70s/it]  0%|          | 20/5000 [00:54<3:42:05,  2.68s/it]  0%|          | 21/5000 [00:56<3:37:04,  2.62s/it]  0%|          | 22/5000 [00:59<3:32:21,  2.56s/it]  0%|          | 23/5000 [01:01<3:33:11,  2.57s/it]  0%|          | 24/5000 [01:04<3:34:33,  2.59s/it]  0%|          | 25/5000 [01:07<3:36:12,  2.61s/it]  1%|          | 26/5000 [01:09<3:36:02,  2.61s/it]  1%|          | 27/5000 [01:12<3:35:46,  2.60s/it]  1%|          | 28/5000 [01:14<3:35:11,  2.60s/it]  1%|          | 29/5000 [01:17<3:35:50,  2.61s/it]  1%|          | 30/5000 [01:20<3:36:21,  2.61s/it]  1%|          | 31/5000 [01:22<3:36:20,  2.61s/it]  1%|          | 32/5000 [01:25<3:43:38,  2.70s/it]  1%|          | 33/5000 [01:28<3:45:32,  2.72s/it]  1%|          | 34/5000 [01:31<3:51:31,  2.80s/it]  1%|          | 35/5000 [01:34<3:48:43,  2.76s/it]  1%|          | 36/5000 [01:36<3:41:01,  2.67s/it]  1%|          | 37/5000 [01:39<3:35:49,  2.61s/it]  1%|          | 38/5000 [01:41<3:33:39,  2.58s/it]  1%|          | 39/5000 [01:44<3:32:00,  2.56s/it]  1%|          | 40/5000 [01:46<3:29:06,  2.53s/it]  1%|          | 41/5000 [01:49<3:32:58,  2.58s/it]  1%|          | 42/5000 [01:51<3:31:56,  2.56s/it]  1%|          | 43/5000 [01:54<3:30:29,  2.55s/it]  1%|          | 44/5000 [01:56<3:27:21,  2.51s/it]  1%|          | 45/5000 [01:59<3:24:41,  2.48s/it]  1%|          | 46/5000 [02:01<3:32:35,  2.57s/it]  1%|          | 47/5000 [02:04<3:38:18,  2.64s/it]  1%|          | 47/5000 [02:07<3:43:59,  2.71s/it]
AUC:  0.7857421875 LOGlOSS:  0.41614040933283625 test_AUC:  0.7586350443183295 test_LOGlOSS:  0.4638373824655202
Time:  128.06529635598417
{'model_opt': {'latent_dim': 16, 'feat_num': 647, 'field_num': 10, 'mlp_dropout': 0.0, 'use_bn': False, 'mlp_dims': [1024, 512, 256], 'cross': 3}, 'dataset': 'coat', 'model': 'IPS-CTR', 'data_dir': 'data/coat/tfrecord', 'cuda': 3, 'source': None}
==================================================
|          IPS-CTR: Set the random seed          |
==================================================

==================================================
|            IPS-CTR: Estimate pscore            |
==================================================

==================================================
|               IPS-CTR: Training                |
==================================================

######### trainer ###########
lr: 0.0001 l2: 3e-05 bs: 16
  0%|          | 0/5000 [00:00<?, ?it/s]  0%|          | 1/5000 [00:02<4:08:21,  2.98s/it]  0%|          | 2/5000 [00:06<4:23:11,  3.16s/it]  0%|          | 3/5000 [00:09<4:32:09,  3.27s/it]  0%|          | 4/5000 [00:12<4:31:19,  3.26s/it]  0%|          | 5/5000 [00:16<4:28:06,  3.22s/it]  0%|          | 6/5000 [00:19<4:24:46,  3.18s/it]  0%|          | 7/5000 [00:22<4:25:23,  3.19s/it]  0%|          | 8/5000 [00:25<4:26:22,  3.20s/it]  0%|          | 9/5000 [00:28<4:25:13,  3.19s/it]  0%|          | 10/5000 [00:31<4:25:24,  3.19s/it]  0%|          | 11/5000 [00:34<4:10:09,  3.01s/it]  0%|          | 12/5000 [00:36<3:53:01,  2.80s/it]  0%|          | 13/5000 [00:39<3:39:56,  2.65s/it]  0%|          | 14/5000 [00:41<3:31:56,  2.55s/it]  0%|          | 15/5000 [00:44<3:48:45,  2.75s/it]  0%|          | 16/5000 [00:47<3:58:25,  2.87s/it]  0%|          | 16/5000 [00:51<4:25:04,  3.19s/it]
AUC:  0.7730143229166667 LOGlOSS:  0.4067236709995204 test_AUC:  0.7533335153683022 test_LOGlOSS:  0.4532388477069608
Time:  51.54834982694592
{'model_opt': {'latent_dim': 16, 'feat_num': 647, 'field_num': 10, 'mlp_dropout': 0.0, 'use_bn': False, 'mlp_dims': [1024, 512, 256], 'cross': 3}, 'dataset': 'coat', 'model': 'Refine-CTR', 'data_dir': 'data/coat/tfrecord', 'cuda': 3, 'source': None}
==================================================
|        Refine-CTR: Set the random seed         |
==================================================

==================================================
|              Refine-CTR: Training              |
==================================================

######### trainer ###########
beta1 0.9540831351014708 lr: 0.0003 l2: 0.0003 bs: 32
  0%|          | 0/5000 [00:00<?, ?it/s]  0%|          | 1/5000 [00:01<2:40:14,  1.92s/it]  0%|          | 2/5000 [00:03<2:30:21,  1.81s/it]  0%|          | 3/5000 [00:05<2:28:42,  1.79s/it]  0%|          | 4/5000 [00:07<2:29:38,  1.80s/it]  0%|          | 5/5000 [00:09<2:34:11,  1.85s/it]  0%|          | 6/5000 [00:11<2:34:23,  1.85s/it]  0%|          | 7/5000 [00:12<2:34:25,  1.86s/it]  0%|          | 8/5000 [00:14<2:32:38,  1.83s/it]  0%|          | 9/5000 [00:16<2:26:53,  1.77s/it]  0%|          | 10/5000 [00:18<2:28:50,  1.79s/it]  0%|          | 11/5000 [00:19<2:26:46,  1.77s/it]  0%|          | 12/5000 [00:21<2:26:10,  1.76s/it]  0%|          | 13/5000 [00:23<2:32:40,  1.84s/it]  0%|          | 13/5000 [00:25<2:42:34,  1.96s/it]
AUC:  0.8118164062500001 LOGlOSS:  0.8534531894471798 test_AUC:  0.7459486441029534 test_LOGlOSS:  0.859693670759974
Time:  25.929427583003417
{'model_opt': {'latent_dim': 16, 'feat_num': 647, 'field_num': 10, 'mlp_dropout': 0.0, 'use_bn': True, 'mlp_dims': [1024, 512, 256], 'cross': 3}, 'dataset': 'coat', 'model': 'UDIPS-CTR', 'data_dir': 'data/coat/tfrecord', 'cuda': 3, 'source': None}
==================================================
|         UDIPS-CTR: Set the random seed         |
==================================================

==================================================
|           UDIPS-CTR: Estimate pscore           |
==================================================

==================================================
|              UDIPS-CTR: Training               |
==================================================

######### trainer ###########
beta1 0.562271601627695 lr: 0.0003 l2: 0.001 bs: 32
  0%|          | 0/5000 [00:00<?, ?it/s]  0%|          | 1/5000 [00:01<2:31:33,  1.82s/it]  0%|          | 2/5000 [00:03<2:43:16,  1.96s/it]  0%|          | 3/5000 [00:05<2:44:43,  1.98s/it]  0%|          | 4/5000 [00:07<2:44:25,  1.97s/it]  0%|          | 5/5000 [00:09<2:44:15,  1.97s/it]  0%|          | 6/5000 [00:11<2:43:23,  1.96s/it]  0%|          | 7/5000 [00:13<2:41:23,  1.94s/it]  0%|          | 8/5000 [00:15<2:43:12,  1.96s/it]  0%|          | 9/5000 [00:17<2:40:44,  1.93s/it]  0%|          | 10/5000 [00:19<2:39:47,  1.92s/it]  0%|          | 11/5000 [00:21<2:40:57,  1.94s/it]  0%|          | 12/5000 [00:23<2:40:14,  1.93s/it]  0%|          | 13/5000 [00:25<2:40:36,  1.93s/it]  0%|          | 14/5000 [00:27<2:43:00,  1.96s/it]  0%|          | 15/5000 [00:29<2:42:07,  1.95s/it]  0%|          | 16/5000 [00:31<2:42:05,  1.95s/it]  0%|          | 17/5000 [00:33<2:45:49,  2.00s/it]  0%|          | 18/5000 [00:35<2:44:41,  1.98s/it]  0%|          | 19/5000 [00:37<2:44:49,  1.99s/it]  0%|          | 20/5000 [00:39<2:46:19,  2.00s/it]  0%|          | 21/5000 [00:41<2:45:20,  1.99s/it]  0%|          | 22/5000 [00:43<2:43:24,  1.97s/it]  0%|          | 23/5000 [00:45<2:45:40,  2.00s/it]  0%|          | 24/5000 [00:47<2:45:42,  2.00s/it]  0%|          | 25/5000 [00:49<2:46:03,  2.00s/it]  1%|          | 26/5000 [00:51<2:44:58,  1.99s/it]  1%|          | 27/5000 [00:52<2:40:57,  1.94s/it]  1%|          | 28/5000 [00:54<2:37:30,  1.90s/it]  1%|          | 29/5000 [00:56<2:34:12,  1.86s/it]  1%|          | 29/5000 [00:58<2:46:42,  2.01s/it]
AUC:  0.789453125  LOGlOSS:  0.40053511025835126 test_AUC:  0.7525785492866864 test_LOGlOSS:  0.4583341579751808
Time:  58.72753265395295
{'model_opt': {'latent_dim': 16, 'feat_num': 647, 'field_num': 10, 'mlp_dropout': 0.0, 'use_bn': False, 'mlp_dims': [1024, 512, 256], 'cross': 3}, 'dataset': 'coat', 'model': 'bias_BASE-CTR', 'data_dir': 'data/coat/tfrecord', 'cuda': 3, 'source': 'bias'}
==================================================
|         BASE-CTR: Set the random seed          |
==================================================

==================================================
|               BASE-CTR: Training               |
==================================================

######### trainer ###########
lr: 0.0003 l2: 0.001 bs: 32
  0%|          | 0/5000 [00:00<?, ?it/s]  0%|          | 1/5000 [00:01<2:04:14,  1.49s/it]  0%|          | 2/5000 [00:02<2:04:23,  1.49s/it]  0%|          | 3/5000 [00:04<2:04:57,  1.50s/it]  0%|          | 4/5000 [00:06<2:05:13,  1.50s/it]  0%|          | 5/5000 [00:07<2:05:05,  1.50s/it]  0%|          | 6/5000 [00:09<2:05:25,  1.51s/it]  0%|          | 7/5000 [00:10<2:05:55,  1.51s/it]  0%|          | 8/5000 [00:12<2:05:33,  1.51s/it]  0%|          | 9/5000 [00:13<2:05:46,  1.51s/it]  0%|          | 10/5000 [00:15<2:05:48,  1.51s/it]  0%|          | 11/5000 [00:16<2:05:34,  1.51s/it]  0%|          | 12/5000 [00:18<2:05:24,  1.51s/it]  0%|          | 13/5000 [00:19<2:05:08,  1.51s/it]  0%|          | 14/5000 [00:21<2:04:57,  1.50s/it]  0%|          | 15/5000 [00:22<2:04:58,  1.50s/it]  0%|          | 16/5000 [00:24<2:05:17,  1.51s/it]  0%|          | 17/5000 [00:25<2:05:20,  1.51s/it]  0%|          | 18/5000 [00:26<2:01:17,  1.46s/it]  0%|          | 19/5000 [00:28<1:57:47,  1.42s/it]  0%|          | 20/5000 [00:29<1:56:40,  1.41s/it]  0%|          | 21/5000 [00:31<1:56:50,  1.41s/it]  0%|          | 22/5000 [00:32<1:53:05,  1.36s/it]  0%|          | 23/5000 [00:34<2:00:36,  1.45s/it]  0%|          | 24/5000 [00:35<1:57:53,  1.42s/it]  0%|          | 25/5000 [00:36<1:53:06,  1.36s/it]  1%|          | 26/5000 [00:37<1:52:30,  1.36s/it]  1%|          | 27/5000 [00:39<1:50:03,  1.33s/it]  1%|          | 28/5000 [00:40<1:46:50,  1.29s/it]  1%|          | 29/5000 [00:41<1:43:59,  1.26s/it]  1%|          | 29/5000 [00:42<2:02:11,  1.47s/it]
AUC:  0.789453125 LOGlOSS:  0.40053511025835126 test_AUC:  0.7525785492866864 test_LOGlOSS:  0.4583341579751808
Time:  43.26366323896218
{'model_opt': {'latent_dim': 16, 'feat_num': 647, 'field_num': 10, 'mlp_dropout': 0.0, 'use_bn': False, 'mlp_dims': [1024, 512, 256], 'cross': 3}, 'dataset': 'coat', 'model': 'combine_BASE-CTR', 'data_dir': 'data/coat/tfrecord', 'cuda': 3, 'source': 'combine'}
==================================================
|         BASE-CTR: Set the random seed          |
==================================================

==================================================
|               BASE-CTR: Training               |
==================================================

######### trainer ###########
lr: 0.0003 l2: 0.001 bs: 64
  0%|          | 0/5000 [00:00<?, ?it/s]  0%|          | 1/5000 [00:00<1:02:23,  1.34it/s]  0%|          | 2/5000 [00:01<1:01:24,  1.36it/s]  0%|          | 3/5000 [00:02<57:46,  1.44it/s]    0%|          | 4/5000 [00:02<56:39,  1.47it/s]  0%|          | 5/5000 [00:03<55:40,  1.50it/s]  0%|          | 6/5000 [00:04<55:13,  1.51it/s]  0%|          | 7/5000 [00:04<55:03,  1.51it/s]  0%|          | 8/5000 [00:05<54:46,  1.52it/s]  0%|          | 9/5000 [00:06<54:27,  1.53it/s]  0%|          | 10/5000 [00:06<54:51,  1.52it/s]  0%|          | 11/5000 [00:07<57:32,  1.44it/s]  0%|          | 12/5000 [00:08<58:53,  1.41it/s]  0%|          | 13/5000 [00:08<59:55,  1.39it/s]  0%|          | 14/5000 [00:09<57:59,  1.43it/s]  0%|          | 15/5000 [00:10<56:57,  1.46it/s]  0%|          | 16/5000 [00:10<56:01,  1.48it/s]  0%|          | 17/5000 [00:11<55:36,  1.49it/s]  0%|          | 18/5000 [00:12<54:54,  1.51it/s]  0%|          | 19/5000 [00:12<54:14,  1.53it/s]  0%|          | 20/5000 [00:13<54:01,  1.54it/s]  0%|          | 21/5000 [00:14<53:51,  1.54it/s]  0%|          | 21/5000 [00:14<58:23,  1.42it/s]
AUC:  0.79765625 LOGlOSS:  0.3834127769461975 test_AUC:  0.7586628286030588 test_LOGlOSS:  0.43407053560349523
Time:  15.322075707023032
{'model_opt': {'latent_dim': 16, 'feat_num': 647, 'field_num': 10, 'mlp_dropout': 0.0, 'use_bn': False, 'mlp_dims': [1024, 512, 256], 'cross': 3}, 'dataset': 'coat', 'model': 'unif_BASE-CTR', 'data_dir': 'data/coat/tfrecord', 'cuda': 3, 'source': 'unif'}
==================================================
|         BASE-CTR: Set the random seed          |
==================================================

==================================================
|               BASE-CTR: Training               |
==================================================

######### trainer ###########
lr: 0.001 l2: 0.0003 bs: 16
  0%|          | 0/5000 [00:00<?, ?it/s]  0%|          | 1/5000 [00:00<23:54,  3.48it/s]  0%|          | 2/5000 [00:00<23:56,  3.48it/s]  0%|          | 3/5000 [00:00<22:44,  3.66it/s]  0%|          | 4/5000 [00:01<21:38,  3.85it/s]  0%|          | 5/5000 [00:01<21:01,  3.96it/s]  0%|          | 6/5000 [00:01<22:16,  3.74it/s]  0%|          | 7/5000 [00:01<20:59,  3.97it/s]  0%|          | 8/5000 [00:02<22:11,  3.75it/s]  0%|          | 9/5000 [00:02<20:33,  4.05it/s]  0%|          | 10/5000 [00:02<19:42,  4.22it/s]  0%|          | 11/5000 [00:02<20:07,  4.13it/s]  0%|          | 12/5000 [00:03<19:10,  4.33it/s]  0%|          | 13/5000 [00:03<19:48,  4.20it/s]  0%|          | 14/5000 [00:03<20:10,  4.12it/s]  0%|          | 15/5000 [00:03<20:46,  4.00it/s]  0%|          | 16/5000 [00:04<22:26,  3.70it/s]  0%|          | 17/5000 [00:04<22:47,  3.64it/s]  0%|          | 18/5000 [00:04<23:57,  3.47it/s]  0%|          | 19/5000 [00:04<22:55,  3.62it/s]  0%|          | 20/5000 [00:05<22:28,  3.69it/s]  0%|          | 21/5000 [00:05<22:37,  3.67it/s]  0%|          | 22/5000 [00:05<22:54,  3.62it/s]  0%|          | 23/5000 [00:06<22:03,  3.76it/s]  0%|          | 24/5000 [00:06<20:54,  3.97it/s]  0%|          | 25/5000 [00:06<20:15,  4.09it/s]  1%|          | 26/5000 [00:06<21:08,  3.92it/s]  1%|          | 26/5000 [00:06<22:15,  3.73it/s]
AUC:  0.687939453125 LOGlOSS:  0.7493246592152469 test_AUC:  0.6116609684931003 test_LOGlOSS:  0.9435454030330458
Time:  7.251689605996944
